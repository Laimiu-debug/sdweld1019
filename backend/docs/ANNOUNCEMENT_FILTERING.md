# å…¬å‘Šç­›é€‰åŠŸèƒ½æ–‡æ¡£

## åŠŸèƒ½æ¦‚è¿°

ç³»ç»Ÿç°åœ¨æ”¯æŒåŒºåˆ†**æ‰‹åŠ¨åˆ›å»ºçš„å…¬å‘Š**å’Œ**ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å…¬å‘Š**ï¼Œå¹¶æä¾›ç­›é€‰åŠŸèƒ½ã€‚

## æ•°æ®åº“å˜æ›´

### æ–°å¢å­—æ®µ

åœ¨`system_announcements`è¡¨ä¸­æ·»åŠ äº†æ–°å­—æ®µï¼š

```sql
is_auto_generated BOOLEAN DEFAULT FALSE
```

- `TRUE`: ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å…¬å‘Šï¼ˆå¦‚ä¼šå‘˜åˆ°æœŸæé†’ã€é…é¢è­¦å‘Šç­‰ï¼‰
- `FALSE`: ç®¡ç†å‘˜æ‰‹åŠ¨åˆ›å»ºçš„å…¬å‘Š

## APIå˜æ›´

### GET /api/v1/admin/system/announcements

**æ–°å¢æŸ¥è¯¢å‚æ•°ï¼š**

- `is_auto_generated` (å¯é€‰): å¸ƒå°”å€¼
  - `true`: åªè¿”å›ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å…¬å‘Š
  - `false`: åªè¿”å›æ‰‹åŠ¨åˆ›å»ºçš„å…¬å‘Š
  - ä¸ä¼ : è¿”å›æ‰€æœ‰å…¬å‘Š

**ç¤ºä¾‹è¯·æ±‚ï¼š**

```bash
# è·å–æ‰€æœ‰æ‰‹åŠ¨åˆ›å»ºçš„å…¬å‘Š
GET /api/v1/admin/system/announcements?is_auto_generated=false

# è·å–æ‰€æœ‰è‡ªåŠ¨ç”Ÿæˆçš„å…¬å‘Š
GET /api/v1/admin/system/announcements?is_auto_generated=true

# è·å–æ‰€æœ‰å…¬å‘Š
GET /api/v1/admin/system/announcements
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "success": true,
  "data": {
    "items": [
      {
        "id": 1,
        "title": "ç³»ç»Ÿç»´æŠ¤é€šçŸ¥",
        "content": "...",
        "is_auto_generated": false,
        "is_published": true,
        ...
      },
      {
        "id": 2,
        "title": "ğŸ”” ä¼šå‘˜å³å°†åˆ°æœŸæé†’",
        "content": "...",
        "is_auto_generated": true,
        "is_published": true,
        ...
      }
    ],
    "total": 2,
    "page": 1,
    "page_size": 20
  }
}
```

## å‰ç«¯UIå˜æ›´

### å…¬å‘Šç®¡ç†é¡µé¢

**æ–°å¢ç­›é€‰é€‰é¡¹ï¼š**

åœ¨å…¬å‘Šåˆ—è¡¨é¡µé¢æ·»åŠ äº†"å…¬å‘Šæ¥æº"ç­›é€‰ä¸‹æ‹‰æ¡†ï¼š

- **æ‰‹åŠ¨åˆ›å»º**: åªæ˜¾ç¤ºç®¡ç†å‘˜æ‰‹åŠ¨åˆ›å»ºçš„å…¬å‘Š
- **è‡ªåŠ¨ç”Ÿæˆ**: åªæ˜¾ç¤ºç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å…¬å‘Š
- **å…¨éƒ¨**: æ˜¾ç¤ºæ‰€æœ‰å…¬å‘Šï¼ˆé»˜è®¤ï¼‰

**æ–°å¢è¡¨æ ¼åˆ—ï¼š**

åœ¨å…¬å‘Šåˆ—è¡¨è¡¨æ ¼ä¸­æ·»åŠ äº†"æ¥æº"åˆ—ï¼š

- ğŸŸ¢ **æ‰‹åŠ¨åˆ›å»º**: ç»¿è‰²æ ‡ç­¾
- ğŸ”µ **ç³»ç»Ÿè‡ªåŠ¨**: è“è‰²æ ‡ç­¾

## è‡ªåŠ¨ç”Ÿæˆå…¬å‘Šçš„ç±»å‹

ç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹ç±»å‹çš„å…¬å‘Šï¼š

### 1. ä¼šå‘˜åˆ°æœŸæé†’

- **è§¦å‘æ—¶æœº**: è®¢é˜…åˆ°æœŸå‰7å¤©ã€3å¤©ã€1å¤©
- **ç›®æ ‡å—ä¼—**: å³å°†åˆ°æœŸçš„ç”¨æˆ·
- **æ ‡è®°**: `is_auto_generated=true`

### 2. ä¼šå‘˜è¿‡æœŸé€šçŸ¥

- **è§¦å‘æ—¶æœº**: è®¢é˜…è¿‡æœŸå
- **ç›®æ ‡å—ä¼—**: è¿‡æœŸç”¨æˆ·
- **æ ‡è®°**: `is_auto_generated=true`

### 3. é…é¢ä½¿ç”¨è­¦å‘Š

- **è§¦å‘æ—¶æœº**: é…é¢ä½¿ç”¨è¾¾åˆ°80%ã€90%ã€100%
- **ç›®æ ‡å—ä¼—**: é…é¢å³å°†ç”¨å®Œçš„ç”¨æˆ·
- **æ ‡è®°**: `is_auto_generated=true`

### 4. å¼‚å¸¸ç™»å½•é€šçŸ¥

- **è§¦å‘æ—¶æœº**: æ£€æµ‹åˆ°å¼‚å¸¸ç™»å½•è¡Œä¸º
- **ç›®æ ‡å—ä¼—**: ç›¸å…³ç”¨æˆ·
- **æ ‡è®°**: `is_auto_generated=true`

### 5. å¯†ç ä¿®æ”¹é€šçŸ¥

- **è§¦å‘æ—¶æœº**: ç”¨æˆ·ä¿®æ”¹å¯†ç å
- **ç›®æ ‡å—ä¼—**: ç›¸å…³ç”¨æˆ·
- **æ ‡è®°**: `is_auto_generated=true`

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: æŸ¥çœ‹æ‰€æœ‰æ‰‹åŠ¨åˆ›å»ºçš„å…¬å‘Š

ç®¡ç†å‘˜æƒ³è¦æŸ¥çœ‹å’Œç®¡ç†è‡ªå·±åˆ›å»ºçš„å…¬å‘Šï¼Œä¸åŒ…æ‹¬ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„é€šçŸ¥ã€‚

**æ“ä½œæ­¥éª¤ï¼š**
1. è¿›å…¥"å…¬å‘Šç®¡ç†"é¡µé¢
2. åœ¨"å…¬å‘Šæ¥æº"ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©"æ‰‹åŠ¨åˆ›å»º"
3. åˆ—è¡¨å°†åªæ˜¾ç¤ºæ‰‹åŠ¨åˆ›å»ºçš„å…¬å‘Š

### åœºæ™¯2: æŸ¥çœ‹ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„é€šçŸ¥

ç®¡ç†å‘˜æƒ³è¦æŸ¥çœ‹ç³»ç»Ÿè‡ªåŠ¨å‘é€çš„é€šçŸ¥ï¼Œäº†è§£ç”¨æˆ·æ”¶åˆ°äº†å“ªäº›è‡ªåŠ¨æé†’ã€‚

**æ“ä½œæ­¥éª¤ï¼š**
1. è¿›å…¥"å…¬å‘Šç®¡ç†"é¡µé¢
2. åœ¨"å…¬å‘Šæ¥æº"ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©"è‡ªåŠ¨ç”Ÿæˆ"
3. åˆ—è¡¨å°†åªæ˜¾ç¤ºç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å…¬å‘Š

### åœºæ™¯3: æŸ¥çœ‹æ‰€æœ‰å…¬å‘Š

ç®¡ç†å‘˜æƒ³è¦æŸ¥çœ‹æ‰€æœ‰å…¬å‘Šï¼ŒåŒ…æ‹¬æ‰‹åŠ¨åˆ›å»ºå’Œè‡ªåŠ¨ç”Ÿæˆçš„ã€‚

**æ“ä½œæ­¥éª¤ï¼š**
1. è¿›å…¥"å…¬å‘Šç®¡ç†"é¡µé¢
2. ç¡®ä¿"å…¬å‘Šæ¥æº"ä¸‹æ‹‰æ¡†ä¸ºç©ºæˆ–é€‰æ‹©"å…¨éƒ¨"
3. åˆ—è¡¨å°†æ˜¾ç¤ºæ‰€æœ‰å…¬å‘Š

## æŠ€æœ¯å®ç°

### åç«¯

**æ–‡ä»¶**: `backend/app/api/v1/endpoints/system_admin.py`

```python
@router.get("/announcements")
async def get_announcements_admin(
    is_auto_generated: Optional[bool] = Query(None, description="æ˜¯å¦ä¸ºè‡ªåŠ¨ç”Ÿæˆ"),
    ...
):
    query = db.query(SystemAnnouncement)
    
    if is_auto_generated is not None:
        query = query.filter(SystemAnnouncement.is_auto_generated == is_auto_generated)
    
    ...
```

### å‰ç«¯

**æ–‡ä»¶**: `admin-portal/src/pages/AnnouncementManagement.tsx`

```typescript
// ç­›é€‰çŠ¶æ€
const [filterAutoGenerated, setFilterAutoGenerated] = useState<boolean | undefined>(undefined);

// åŠ è½½å…¬å‘Šæ—¶ä¼ é€’ç­›é€‰å‚æ•°
const data = await getAnnouncements({
  page,
  page_size: pageSize,
  is_auto_generated: filterAutoGenerated,
});

// UIç­›é€‰ä¸‹æ‹‰æ¡†
<Select
  placeholder="å…¬å‘Šæ¥æº"
  style={{ width: 140 }}
  allowClear
  value={filterAutoGenerated}
  onChange={setFilterAutoGenerated}
>
  <Select.Option value={false}>æ‰‹åŠ¨åˆ›å»º</Select.Option>
  <Select.Option value={true}>è‡ªåŠ¨ç”Ÿæˆ</Select.Option>
</Select>
```

## æ³¨æ„äº‹é¡¹

1. **å†å²æ•°æ®**: åœ¨æ·»åŠ `is_auto_generated`å­—æ®µä¹‹å‰åˆ›å»ºçš„å…¬å‘Šï¼Œè¯¥å­—æ®µé»˜è®¤ä¸º`FALSE`ï¼ˆæ‰‹åŠ¨åˆ›å»ºï¼‰
2. **æƒé™æ§åˆ¶**: ç›®å‰æ‰€æœ‰ç®¡ç†å‘˜éƒ½å¯ä»¥æŸ¥çœ‹å’Œç­›é€‰å…¬å‘Šï¼Œæœªæ¥å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ æ›´ç»†ç²’åº¦çš„æƒé™æ§åˆ¶
3. **åˆ é™¤é™åˆ¶**: ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å…¬å‘Šå¯ä»¥è¢«åˆ é™¤ï¼Œä½†å»ºè®®è°¨æ…æ“ä½œ
4. **ç¼–è¾‘é™åˆ¶**: ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å…¬å‘Šå¯ä»¥è¢«ç¼–è¾‘ï¼Œä½†ç¼–è¾‘åä»ä¿æŒ`is_auto_generated=true`æ ‡è®°

## æœªæ¥æ”¹è¿›

1. **åˆ†é¡µä¼˜åŒ–**: ä¸ºæ‰‹åŠ¨åˆ›å»ºå’Œè‡ªåŠ¨ç”Ÿæˆçš„å…¬å‘Šæä¾›ç‹¬ç«‹çš„åˆ†é¡µ
2. **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡åˆ é™¤è‡ªåŠ¨ç”Ÿæˆçš„è¿‡æœŸå…¬å‘Š
3. **ç»Ÿè®¡ä¿¡æ¯**: åœ¨é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºæ‰‹åŠ¨åˆ›å»ºå’Œè‡ªåŠ¨ç”Ÿæˆå…¬å‘Šçš„æ•°é‡ç»Ÿè®¡
4. **é€šçŸ¥å»é‡**: é¿å…å‘åŒä¸€ç”¨æˆ·é‡å¤å‘é€ç›¸åŒç±»å‹çš„é€šçŸ¥

