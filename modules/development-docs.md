# ç„Šæ¥å·¥è‰ºç®¡ç†ç³»ç»Ÿå¼€å‘æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

ç„Šæ¥å·¥è‰ºç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªéƒ¨ç½²åœ¨äº‘æœåŠ¡å™¨ä¸Šçš„ä¸“ä¸šç®¡ç†ç½‘ç«™ï¼Œæ—¨åœ¨ä¸ºç„Šæ¥åˆ¶é€ ä¼ä¸šæä¾›å…¨æµç¨‹çš„æ•°å­—åŒ–ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚

## ç³»ç»Ÿæ¶æ„

- **éƒ¨ç½²æ–¹å¼**: äº‘æœåŠ¡å™¨éƒ¨ç½²
- **ç³»ç»Ÿç±»å‹**: Webåº”ç”¨
- **ç›®æ ‡ç”¨æˆ·**: ä¸ªäººç„Šæ¥å·¥ç¨‹å¸ˆã€ç„Šæ¥åˆ¶é€ ä¼ä¸šã€å·¥è‰ºå·¥ç¨‹å¸ˆã€è´¨é‡ç®¡ç†äººå‘˜
- **å•†ä¸šæ¨¡å¼**: SaaSè®¢é˜…åˆ¶

## ä¼šå‘˜ä½“ç³»è®¾è®¡

### ç”¨æˆ·æ³¨å†Œæµç¨‹
1. æ¸¸å®¢ä½“éªŒæ¨¡å¼ï¼ˆæ— éœ€æ³¨å†Œï¼‰
2. ä¸ªäººç”¨æˆ·å…è´¹æ³¨å†Œ
3. å‡çº§ä»˜è´¹ä¼šå‘˜ï¼ˆä¸ªäººç‰ˆ/ä¼ä¸šç‰ˆï¼‰

### ä¼šå‘˜ç­‰çº§è¯¦ç»†è®¾è®¡

#### é€šç”¨åŠŸèƒ½ï¼ˆæ‰€æœ‰ä¼šå‘˜ç­‰çº§å‡å¯ä½¿ç”¨ï¼‰
- **ä»ªè¡¨ç›˜**: ç³»ç»Ÿæ¦‚è§ˆå’Œæ•°æ®å±•ç¤º
- **ä¸ªäººä¸­å¿ƒ**: ç”¨æˆ·ä¸ªäººä¿¡æ¯ç®¡ç†ã€ç³»ç»Ÿè®¾ç½®é…ç½®

#### æ¸¸å®¢ä½“éªŒæ¨¡å¼ï¼ˆå…è´¹ï¼‰
- **åŠŸèƒ½æƒé™**: WPSå’ŒPQRåªè¯»æŸ¥çœ‹åŠŸèƒ½ï¼ˆä»…å¯æŸ¥çœ‹ç¤ºä¾‹æ•°æ®ï¼Œä¸å¯åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ï¼‰
- **å­˜å‚¨æœåŠ¡**: ä¸æä¾›ï¼Œä»…ä¸´æ—¶å±•ç¤º
- **æ•°æ®ä¿å­˜**: æ— 
- **ä½“éªŒæ—¶é•¿**: ä¸´æ—¶ä¼šè¯
- **å®‰å…¨é™åˆ¶**: ä»…å¯æŸ¥çœ‹ç³»ç»Ÿé¢„è®¾çš„ç¤ºä¾‹æ•°æ®ï¼Œæ— æ³•è¿›è¡Œä»»ä½•å†™æ“ä½œ

#### ä¸ªäººä¼šå‘˜

**ä¸ªäººå…è´¹ç‰ˆ**
- **æœˆè´¹**: å…è´¹
- **åŠŸèƒ½æƒé™**: WPSã€PQRå¢åˆ æ”¹æŸ¥åŠŸèƒ½
- **æ•°é‡é™åˆ¶**:
  - WPS: æœ€å¤š10ä¸ª
  - PQR: æœ€å¤š10ä¸ª
  - pPQR: ä¸å¯ç”¨
- **å­˜å‚¨ç©ºé—´**: åŸºç¡€å­˜å‚¨

**ä¸ªäººä¸“ä¸šç‰ˆ**
- **æœˆè´¹**: Â¥19
- **åŠŸèƒ½æƒé™**: WPSã€PQRã€pPQRã€ç„Šæç®¡ç†ã€ç„Šå·¥ç®¡ç†
- **æ•°é‡é™åˆ¶**:
  - WPS: æœ€å¤š30ä¸ª
  - PQR: æœ€å¤š30ä¸ª
  - pPQR: æœ€å¤š30ä¸ª
  - ç„Šæ: åŸºç¡€ç®¡ç†
  - ç„Šå·¥: åŸºç¡€ç®¡ç†

**ä¸ªäººé«˜çº§ç‰ˆ**
- **æœˆè´¹**: Â¥49
- **åŠŸèƒ½æƒé™**: WPSã€PQRã€pPQRã€ç„Šæç®¡ç†ã€ç„Šå·¥ç®¡ç†ã€ç”Ÿäº§ç®¡ç†ã€è®¾å¤‡ç®¡ç†ã€è´¨é‡ç®¡ç†
- **æ•°é‡é™åˆ¶**:
  - WPS: æœ€å¤š50ä¸ª
  - PQR: æœ€å¤š50ä¸ª
  - pPQR: æœ€å¤š50ä¸ª
  - å…¶ä»–æ¨¡å—: å®Œæ•´åŠŸèƒ½

**ä¸ªäººæ——èˆ°ç‰ˆ**
- **æœˆè´¹**: Â¥99
- **åŠŸèƒ½æƒé™**: å…¨éƒ¨ä¸ªäººåŠŸèƒ½æ¨¡å—ï¼ˆWPSã€PQRã€pPQRã€ç„Šæã€ç„Šå·¥ã€ç”Ÿäº§ã€è®¾å¤‡ã€è´¨é‡ã€æŠ¥è¡¨ç»Ÿè®¡ï¼‰
- **æ•°é‡é™åˆ¶**:
  - WPS: æœ€å¤š100ä¸ª
  - PQR: æœ€å¤š100ä¸ª
  - pPQR: æœ€å¤š100ä¸ª
  - æ‰€æœ‰æ¨¡å—: å®Œæ•´åŠŸèƒ½
- **æ³¨æ„**: ä¸åŒ…å«ä¼ä¸šå‘˜å·¥ç®¡ç†åŠŸèƒ½ï¼ˆè¯¥åŠŸèƒ½ä»…ä¼ä¸šä¼šå‘˜å¯ç”¨ï¼‰

#### ä¼ä¸šä¼šå‘˜

**ä¼ä¸šç‰ˆ**
- **æœˆè´¹**: Â¥199
- **ç®¡ç†å‘˜æƒé™**: æ‹¥æœ‰ä¸ªäººæ——èˆ°ç‰ˆæ‰€æœ‰åŠŸèƒ½
- **æ•°é‡é™åˆ¶**:
  - WPS: æœ€å¤š200ä¸ª
  - PQR: æœ€å¤š200ä¸ª
  - pPQR: æœ€å¤š200ä¸ª
- **ç»„ç»‡æ¶æ„**:
  - å¯åˆ›å»ºå·¥å‚: 1ä¸ª
  - å¯é‚€è¯·å‘˜å·¥: æœ€å¤š10äºº
- **å‘˜å·¥æƒé™**: è¢«é‚€è¯·å‘˜å·¥æ‹¥æœ‰ä¸ªäººä¸“ä¸šç‰ˆæƒé™

**ä¼ä¸šç‰ˆPRO**
- **æœˆè´¹**: Â¥399
- **ç®¡ç†å‘˜æƒé™**: æ‹¥æœ‰ä¸ªäººæ——èˆ°ç‰ˆæ‰€æœ‰åŠŸèƒ½
- **æ•°é‡é™åˆ¶**:
  - WPS: æœ€å¤š400ä¸ª
  - PQR: æœ€å¤š400ä¸ª
  - pPQR: æœ€å¤š400ä¸ª
- **ç»„ç»‡æ¶æ„**:
  - å¯åˆ›å»ºå·¥å‚: 3ä¸ª
  - å¯é‚€è¯·å‘˜å·¥: æœ€å¤š20äºº
- **å‘˜å·¥æƒé™**: è¢«é‚€è¯·å‘˜å·¥æ‹¥æœ‰ä¸ªäººä¸“ä¸šç‰ˆæƒé™

**ä¼ä¸šç‰ˆPRO MAX**
- **æœˆè´¹**: Â¥899
- **ç®¡ç†å‘˜æƒé™**: æ‹¥æœ‰ä¸ªäººæ——èˆ°ç‰ˆæ‰€æœ‰åŠŸèƒ½
- **æ•°é‡é™åˆ¶**:
  - WPS: æœ€å¤š500ä¸ª
  - PQR: æœ€å¤š500ä¸ª
  - pPQR: æœ€å¤š500ä¸ª
- **ç»„ç»‡æ¶æ„**:
  - å¯åˆ›å»ºå·¥å‚: 5ä¸ª
  - å¯é‚€è¯·å‘˜å·¥: æœ€å¤š50äºº
- **å‘˜å·¥æƒé™**: è¢«é‚€è¯·å‘˜å·¥æ‹¥æœ‰ä¸ªäººä¸“ä¸šç‰ˆæƒé™

### æ ¸å¿ƒæƒé™ç®¡ç†æœºåˆ¶

#### æ•°æ®éš”ç¦»æœºåˆ¶
- **ç”¨æˆ·çº§åˆ«æ•°æ®éš”ç¦»**: æ¯ä¸ªç”¨æˆ·çš„æ•°æ®å®Œå…¨ç‹¬ç«‹
- **ä¼ä¸šçº§åˆ«æ•°æ®éš”ç¦»**: ä¸åŒä¼ä¸šä¹‹é—´æ•°æ®å®Œå…¨éš”ç¦»
- **å·¥å‚çº§åˆ«æ•°æ®éš”ç¦»**: åŒä¸€ä¼ä¸šå†…ä¸åŒå·¥å‚ä¹‹é—´æ•°æ®å¯é€‰æ‹©æ€§éš”ç¦»

#### ä¼ä¸šç®¡ç†å‘˜æƒé™
- **è·¨å·¥å‚æ•°æ®æƒé™æ§åˆ¶**: å¯è®¾ç½®å·¥å‚é—´çš„æ•°æ®å…±äº«è§„åˆ™
- **å‘˜å·¥æ–‡ä»¶æƒé™ç®¡ç†**: å¯æ§åˆ¶å‘˜å·¥å¯¹ä¼ä¸šæ–‡ä»¶çš„å¢åˆ æ”¹æŸ¥æƒé™
- **å‘˜å·¥è´¦å·ç®¡ç†**: é‚€è¯·ã€ç¦ç”¨ã€ç§»é™¤å‘˜å·¥
- **ç»„ç»‡æ¶æ„è®¾ç½®**: è®¾ç½®å·¥å‚å’Œéƒ¨é—¨çš„å±‚çº§ç»“æ„

#### å‘˜å·¥æƒé™ç»§æ‰¿æœºåˆ¶
- ä¼ä¸šå‘˜å·¥é»˜è®¤ç»§æ‰¿ä¸ªäººä¸“ä¸šç‰ˆåŠŸèƒ½æƒé™
- ä¼ä¸šç®¡ç†å‘˜å¯é¢å¤–åˆ†é…æˆ–é™åˆ¶å‘˜å·¥çš„æ–‡ä»¶æ“ä½œæƒé™
- å‘˜å·¥ä¸èƒ½è®¿é—®ä¼ä¸šç®¡ç†å‘˜çš„åå°ç®¡ç†åŠŸèƒ½

### è®¡è´¹æ¨¡å¼
- **è®¢é˜…æ–¹å¼**: æŒ‰æœˆè®¢é˜…
- **æ”¯ä»˜å‘¨æœŸ**: æœˆä»˜ã€å­£ä»˜ã€å¹´ä»˜ï¼ˆå¹´ä»˜äº«å—æŠ˜æ‰£ï¼‰
- **å‡çº§/é™çº§**: éšæ—¶å¯è°ƒæ•´ä¼šå‘˜ç­‰çº§
- **ä¼ä¸šå‘˜å·¥**: ä¸é¢å¤–æ”¶è´¹ï¼ŒåŒ…å«åœ¨ä¼ä¸šä¼šå‘˜è´¹ç”¨ä¸­

## åŠŸèƒ½æ¨¡å—

### 1. ä»ªè¡¨ç›˜ (Dashboard)
- ç³»ç»Ÿæ¦‚è§ˆå’Œæ•°æ®å±•ç¤º
- å…³é”®æŒ‡æ ‡ç›‘æ§
- å®æ—¶çŠ¶æ€å±•ç¤º

### 2. WPSç®¡ç† (Welding Procedure Specification)
- ç„Šæ¥å·¥è‰ºè§„ç¨‹ç®¡ç†
- å·¥è‰ºå‚æ•°ç»´æŠ¤
- ç‰ˆæœ¬æ§åˆ¶ç®¡ç†

### 3. PQRç®¡ç† (Procedure Qualification Record)
- å·¥è‰ºè¯„å®šè®°å½•ç®¡ç†
- è¯„å®šæŠ¥å‘Šç»´æŠ¤
- åˆè§„æ€§ç®¡ç†

### 4. pPQRç®¡ç† (preliminary Procedure Qualification Record)
- é¢„å¤‡å·¥è‰ºè¯„å®šè®°å½•ç®¡ç†
- ä¸´æ—¶è¯„å®šæ–¹æ¡ˆç»´æŠ¤
- è¯„å®¡æµç¨‹ç®¡ç†

### 5. ç„Šå·¥ç®¡ç† (Welder Management)
- ç„Šæ¥äººå‘˜èµ„è´¨ç®¡ç†
- æŠ€èƒ½ç­‰çº§ç»´æŠ¤
- åŸ¹è®­è®°å½•ç®¡ç†

### 6. ç„Šæç®¡ç† (Welding Material Management)
- ç„Šæ¥ææ–™åº“å­˜ç®¡ç†
- ææ–™ä½¿ç”¨è¿½è¸ª
- ä¾›åº”å•†ç®¡ç†
- ç„Šæè®¡ç®—åŠŸèƒ½
  - ç„Šæç”¨é‡è®¡ç®—
  - æˆæœ¬æ ¸ç®—
  - æ¶ˆè€—é¢„æµ‹

### 7. è®¾å¤‡ç®¡ç† (Equipment Management)
- ç„Šæ¥è®¾å¤‡ç»´æŠ¤ç®¡ç†
- è®¾å¤‡ä½¿ç”¨è®°å½•
- ç»´ä¿®ä¿å…»è®¡åˆ’

### 8. ç”Ÿäº§ç®¡ç† (Production Management)
- ç”Ÿäº§ä»»åŠ¡ç®¡ç†
- ç”Ÿäº§æµç¨‹æ§åˆ¶
- è¿›åº¦è·Ÿè¸ª

### 9. è´¨é‡ç®¡ç† (Quality Management)
- è´¨é‡æ§åˆ¶ç®¡ç†
- æ£€éªŒè®°å½•ç»´æŠ¤
- ä¸åˆæ ¼å“å¤„ç†

### 10. æŠ¥è¡¨ç»Ÿè®¡ (Report & Statistics)
- æ•°æ®åˆ†ææŠ¥è¡¨
- ç»Ÿè®¡å›¾è¡¨å±•ç¤º
- å¯¼å‡ºåŠŸèƒ½

### 11. ä¼ä¸šå‘˜å·¥ç®¡ç† (Enterprise Employee Management)
*(ä»…ä¼ä¸šä¼šå‘˜ç”¨æˆ·å¯è§)*
- **å‘˜å·¥é‚€è¯·ç®¡ç†**: å‘é€é‚€è¯·é“¾æ¥ã€ç®¡ç†é‚€è¯·çŠ¶æ€
- **å‘˜å·¥æƒé™è®¾ç½®**: è®¾ç½®å‘˜å·¥åŠŸèƒ½è®¿é—®æƒé™å’Œæ–‡ä»¶æ“ä½œæƒé™
- **å·¥å‚ç»„ç»‡æ¶æ„**: åˆ›å»ºå’Œç®¡ç†å·¥å‚ã€éƒ¨é—¨ç»“æ„
- **å‘˜å·¥è´¦å·ç®¡ç†**: å¯ç”¨/ç¦ç”¨å‘˜å·¥è´¦å·ã€é‡ç½®å¯†ç 
- **è·¨å·¥å‚æ•°æ®æƒé™**: è®¾ç½®å·¥å‚é—´çš„æ•°æ®å…±äº«å’Œéš”ç¦»è§„åˆ™
- **å‘˜å·¥ä½¿ç”¨ç»Ÿè®¡**: æŸ¥çœ‹å‘˜å·¥æ´»è·ƒåº¦å’ŒåŠŸèƒ½ä½¿ç”¨æƒ…å†µ

### 12. ä¸ªäººä¸­å¿ƒ (Personal Center)
- ç”¨æˆ·ä¸ªäººä¿¡æ¯ç®¡ç†
- ç³»ç»Ÿè®¾ç½®é…ç½®
- æƒé™æŸ¥çœ‹ï¼ˆä¸ªäººæƒé™èŒƒå›´å±•ç¤ºï¼‰

## å¼€å‘é˜¶æ®µè§„åˆ’

### ç¬¬ä¸€é˜¶æ®µ - æ ¸å¿ƒåŠŸèƒ½ï¼ˆç«‹å³å¼€å‘ï¼‰
**ä¼˜å…ˆçº§**: ğŸ”´ æœ€é«˜

1. **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ** - ç™»å½•ã€æ³¨å†Œã€æƒé™ç®¡ç†
2. **ä¼šå‘˜ä½“ç³»** - ä¼šå‘˜ç­‰çº§ã€é…é¢ç®¡ç†ã€æƒé™æ§åˆ¶
3. **ä»ªè¡¨ç›˜** - ç³»ç»Ÿæ¦‚è§ˆå’Œæ•°æ®å±•ç¤º
4. **WPSç®¡ç†** - ç„Šæ¥å·¥è‰ºè§„ç¨‹ç®¡ç†ï¼ˆæ ¸å¿ƒä¸šåŠ¡ï¼‰
5. **PQRç®¡ç†** - å·¥è‰ºè¯„å®šè®°å½•ç®¡ç†ï¼ˆæ ¸å¿ƒä¸šåŠ¡ï¼‰
6. **pPQRç®¡ç†** - é¢„å¤‡å·¥è‰ºè¯„å®šè®°å½•ç®¡ç†ï¼ˆæ ¸å¿ƒä¸šåŠ¡ï¼‰
7. **ä¸ªäººä¸­å¿ƒ** - ç”¨æˆ·ä¸ªäººä¿¡æ¯ç®¡ç†

### ç¬¬äºŒé˜¶æ®µ - é‡è¦åŠŸèƒ½ï¼ˆä¼˜å…ˆå¼€å‘ï¼‰
**ä¼˜å…ˆçº§**: ğŸŸ¡ é«˜

8. **ç„Šå·¥ç®¡ç†** - ç„Šæ¥äººå‘˜èµ„è´¨ç®¡ç†
9. **ç„Šæç®¡ç†** - ç„Šæ¥ææ–™åº“å­˜ç®¡ç†
10. **è®¾å¤‡ç®¡ç†** - ç„Šæ¥è®¾å¤‡ç»´æŠ¤ç®¡ç†
11. **ä¼ä¸šå‘˜å·¥ç®¡ç†** - ä¼ä¸šåä½œç®¡ç†ï¼ˆä»…ä¼ä¸šä¼šå‘˜ï¼‰

### ç¬¬ä¸‰é˜¶æ®µ - å¢å¼ºåŠŸèƒ½ï¼ˆåç»­å¼€å‘ï¼‰
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä¸­

12. **ç”Ÿäº§ç®¡ç†** - ç”Ÿäº§ä»»åŠ¡å’Œæµç¨‹ç®¡ç†
13. **è´¨é‡ç®¡ç†** - è´¨é‡æ§åˆ¶å’Œæ£€éªŒç®¡ç†
14. **æŠ¥è¡¨ç»Ÿè®¡** - æ•°æ®åˆ†æå’ŒæŠ¥è¡¨ç”Ÿæˆ

### ç¬¬å››é˜¶æ®µ - ç®¡ç†åŠŸèƒ½ï¼ˆåç»­å¼€å‘ï¼‰
**ä¼˜å…ˆçº§**: ğŸ”µ ä½

15. **ç®¡ç†å‘˜é—¨æˆ·** - ç³»ç»Ÿç®¡ç†å‘˜åå°ç®¡ç†

**å½“å‰é˜¶æ®µ**: ç¬¬ä¸€é˜¶æ®µå¼€å‘ä¸­

## æŠ€æœ¯é€‰å‹

### åç«¯æŠ€æœ¯æ ˆ
- **Python 3.11+** - ä¸»è¦å¼€å‘è¯­è¨€ï¼Œæ€§èƒ½ä¼˜åŒ–å’Œç°ä»£åŒ–ç‰¹æ€§
- **FastAPI 0.104+** - é«˜æ€§èƒ½å¼‚æ­¥Webæ¡†æ¶ï¼Œè‡ªåŠ¨APIæ–‡æ¡£ç”Ÿæˆ
- **SQLAlchemy 2.0+** - ç°ä»£åŒ–ORMï¼Œæ”¯æŒå¼‚æ­¥æ“ä½œ
- **Alembic** - æ•°æ®åº“ç‰ˆæœ¬æ§åˆ¶å’Œè¿ç§»ç®¡ç†
- **PostgreSQL 15+** - ä¼ä¸šçº§å…³ç³»æ•°æ®åº“ï¼Œæ”¯æŒJSONå’Œå¤æ‚æŸ¥è¯¢
- **Redis 7.0+** - é«˜æ€§èƒ½ç¼“å­˜å’Œä¼šè¯å­˜å‚¨
- **Celery** - åˆ†å¸ƒå¼å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—
- **RabbitMQ** - å¯é çš„æ¶ˆæ¯ä¸­é—´ä»¶
- **Pydantic 2.0+** - æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–

### å‰ç«¯æŠ€æœ¯æ ˆ
- **React 18 + TypeScript** - ç°ä»£åŒ–å‰ç«¯æ¡†æ¶ï¼Œç±»å‹å®‰å…¨
- **Vite 5.0+** - å¿«é€Ÿæ„å»ºå·¥å…·ï¼Œçƒ­é‡è½½æ”¯æŒ
- **Ant Design 5.0+** - ä¼ä¸šçº§UIç»„ä»¶åº“ï¼Œä¸°å¯Œçš„ç»„ä»¶ç”Ÿæ€
- **React Query (TanStack Query)** - æœåŠ¡ç«¯çŠ¶æ€ç®¡ç†ï¼Œç¼“å­˜å’ŒåŒæ­¥
- **Zustand** - è½»é‡çº§å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†
- **React Router 6** - å•é¡µåº”ç”¨è·¯ç”±ç®¡ç†
- **Axios** - HTTPå®¢æˆ·ç«¯ï¼Œè¯·æ±‚æ‹¦æˆªå’Œé”™è¯¯å¤„ç†

### ç¡¬ä»¶äº¤äº’æŠ€æœ¯ (åæœŸå¼€å‘)
- **åŸºç¡€é€šä¿¡**: ä¸²å£é€šä¿¡ã€Modbusåè®®
- **å®æ—¶æ•°æ®**: WebSocketã€MQTTæ¶ˆæ¯ä¼ è¾“
- **è®¾å¤‡é›†æˆ**: é€šç”¨ä»ªå™¨æ§åˆ¶æ¥å£
- **æ•°æ®é‡‡é›†**: ç„Šæ¥å‚æ•°å®æ—¶ç›‘æ§
- **åè®®æ”¯æŒ**: å¤šç§å·¥ä¸šé€šä¿¡åè®®

### å›¾çº¸ç”ŸæˆæŠ€æœ¯
- **Matplotlib + Plotly** - 2Då›¾å½¢ç»˜åˆ¶
- **CADQuery** - 3D CADç”Ÿæˆ
- **ReportLab** - PDFæ–‡æ¡£ç”Ÿæˆ
- **OpenCV** - å›¾åƒå¤„ç†

### AI/æ•°æ®å¤„ç†æŠ€æœ¯
- **NumPy + Pandas** - æ•°æ®å¤„ç†å’Œåˆ†æ
- **Scikit-learn** - æœºå™¨å­¦ä¹ ç®—æ³•
- **SciPy** - ç§‘å­¦è®¡ç®—
- **Transformers** - è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆå¯é€‰ï¼‰

### éƒ¨ç½²å’Œè¿ç»´
- **Docker + Docker Compose** - å®¹å™¨åŒ–éƒ¨ç½²ï¼Œç¯å¢ƒä¸€è‡´æ€§
- **Nginx** - é«˜æ€§èƒ½åå‘ä»£ç†å’Œé™æ€æ–‡ä»¶æœåŠ¡
- **Gunicorn** - Python WSGIæœåŠ¡å™¨ï¼Œå¤šè¿›ç¨‹ç®¡ç†
- **Let's Encrypt** - å…è´¹SSLè¯ä¹¦ï¼ŒHTTPSæ”¯æŒ
- **Prometheus + Grafana** - ç›‘æ§å’Œå¯è§†åŒ–
- **ELK Stack** - æ—¥å¿—æ”¶é›†å’Œåˆ†æï¼ˆå¯é€‰ï¼‰

### å¼€å‘å·¥å…·
- **Poetry** - Pythonä¾èµ–ç®¡ç†å’Œè™šæ‹Ÿç¯å¢ƒ
- **Black + isort** - ä»£ç æ ¼å¼åŒ–å’Œå¯¼å…¥æ’åº
- **Pytest** - åŠŸèƒ½å¼ºå¤§çš„æµ‹è¯•æ¡†æ¶
- **Pre-commit** - Gité’©å­ç®¡ç†ï¼Œä»£ç è´¨é‡æ£€æŸ¥
- **mypy** - é™æ€ç±»å‹æ£€æŸ¥
- **flake8** - ä»£ç é£æ ¼æ£€æŸ¥
- **ESLint + Prettier** - å‰ç«¯ä»£ç è´¨é‡å’Œæ ¼å¼åŒ–

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„è®¾è®¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯å±‚ (React)                        â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·é—¨æˆ· (frontend)                                â”‚
â”‚  â””â”€â”€ ç®¡ç†å‘˜é—¨æˆ· (admin-frontend)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    åº”ç”¨å±‚ (FastAPI)                      â”‚
â”‚  â”œâ”€â”€ è®¤è¯æˆæƒæ¨¡å—                                        â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·ç®¡ç†æ¨¡å—                                        â”‚
â”‚  â”œâ”€â”€ WPS/PQRç®¡ç†æ¨¡å—                                     â”‚
â”‚  â”œâ”€â”€ ä¼ä¸šç®¡ç†æ¨¡å—                                        â”‚
â”‚  â”œâ”€â”€ æŠ¥è¡¨ç»Ÿè®¡æ¨¡å—                                        â”‚
â”‚  â””â”€â”€ ç³»ç»Ÿç®¡ç†æ¨¡å—                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®å±‚                                                â”‚
â”‚  â”œâ”€â”€ PostgreSQL (ä¸»æ•°æ®åº“)                              â”‚
â”‚  â”œâ”€â”€ Redis (ç¼“å­˜)                                       â”‚
â”‚  â””â”€â”€ æ–‡ä»¶å­˜å‚¨                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    åŸºç¡€è®¾æ–½å±‚                            â”‚
â”‚  â”œâ”€â”€ æ¶ˆæ¯é˜Ÿåˆ— (RabbitMQ)                                â”‚
â”‚  â”œâ”€â”€ ä»»åŠ¡é˜Ÿåˆ— (Celery)                                  â”‚
â”‚  â””â”€â”€ ç›‘æ§æ—¥å¿—                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åæœŸå¼€å‘åŠŸèƒ½éœ€æ±‚

> **æ³¨æ„**: ä»¥ä¸‹åŠŸèƒ½ä¸ºåæœŸå¼€å‘éœ€æ±‚ï¼Œå°†åœ¨ç³»ç»Ÿæ ¸å¿ƒåŠŸèƒ½ç¨³å®šåé€æ­¥å®ç°

### 1. ç¡¬ä»¶äº¤äº’åŠŸèƒ½ (åæœŸå¼€å‘)

#### 1.1 å®æ—¶å‚æ•°ç›‘æ§
- **ç”µæµç›‘æµ‹**: å®æ—¶é‡‡é›†ç„Šæ¥ç”µæµæ•°æ®
- **ç”µå‹ç›‘æµ‹**: å®æ—¶é‡‡é›†ç„Šæ¥ç”µå‹æ•°æ®
- **æ¸©åº¦ç›‘æµ‹**: ç„Šæ¥åŒºåŸŸæ¸©åº¦ç›‘æ§
- **æ°”ä½“æµé‡**: ä¿æŠ¤æ°”ä½“æµé‡ç›‘æµ‹

#### 1.2 è®¾å¤‡é€šä¿¡åè®®
- **Modbus RTU/TCP**: å·¥ä¸šæ ‡å‡†é€šä¿¡åè®®
- **ä¸²å£é€šä¿¡**: ç›´æ¥è¿æ¥ä¼ æ„Ÿå™¨è®¾å¤‡
- **MQTT**: ç‰©è”ç½‘è®¾å¤‡æ•°æ®ä¼ è¾“
- **WebSocket**: å‰ç«¯å®æ—¶æ•°æ®æ¨é€

#### 1.3 å‚æ•°éªŒè¯ä¸é¢„è­¦
- **å®æ—¶å¯¹æ¯”**: ç›‘æ§å‚æ•°ä¸WPSæ ‡å‡†å‚æ•°å¯¹æ¯”
- **å¼‚å¸¸é¢„è­¦**: å‚æ•°è¶…å‡ºèŒƒå›´æ—¶å®æ—¶æŠ¥è­¦
- **æ•°æ®è®°å½•**: å®Œæ•´çš„ç„Šæ¥è¿‡ç¨‹æ•°æ®è®°å½•
- **è´¨é‡è¿½æº¯**: ç„Šæ¥å‚æ•°ä¸äº§å“è´¨é‡å…³è”

### 2. å›¾çº¸ç”ŸæˆåŠŸèƒ½ (åæœŸå¼€å‘)

#### 2.1 ç®¡é“ç„Šç¼å¸ƒç½®å›¾
- **è‡ªåŠ¨å¸ƒå±€**: æ ¹æ®ç®¡é“å‚æ•°è‡ªåŠ¨ç”Ÿæˆç„Šç¼ä½ç½®
- **3Då¯è§†åŒ–**: ç«‹ä½“å±•ç¤ºç®¡é“ç„Šç¼åˆ†å¸ƒ
- **å‚æ•°æ ‡æ³¨**: ç„Šç¼ç¼–å·ã€ç„Šæ¥æ–¹æ³•ç­‰æ ‡æ³¨
- **æ ¼å¼è¾“å‡º**: æ”¯æŒPDFã€DWGã€PNGç­‰æ ¼å¼

#### 2.2 ç„Šæ¥å·¥è‰ºæ–‡ä»¶ç”Ÿæˆ
- **WPSæ¨¡æ¿**: æ ‡å‡†WPSè¡¨æ ¼è‡ªåŠ¨å¡«å……
- **å·¥è‰ºå¡ç‰‡**: ç°åœºæ–½å·¥å·¥è‰ºå¡ç‰‡ç”Ÿæˆ
- **æ£€éªŒè®°å½•**: è´¨é‡æ£€éªŒè¡¨æ ¼ç”Ÿæˆ
- **æ‰¹é‡å¯¼å‡º**: æ”¯æŒæ‰¹é‡ç”Ÿæˆå’Œå¯¼å‡º

#### 2.3 æ™ºèƒ½æ¨èç³»ç»Ÿ
- **å‚æ•°ä¼˜åŒ–**: AIæ¨èæœ€ä½³ç„Šæ¥å‚æ•°
- **å·¥è‰ºåŒ¹é…**: æ ¹æ®ææ–™æ¨èåˆé€‚çš„WPS
- **æ•ˆç‡æå‡**: ä¼˜åŒ–ç„Šæ¥é¡ºåºå’Œå·¥è‰ºæµç¨‹

### 3. å¼€å‘ä¼˜å…ˆçº§è¯´æ˜

#### ç¬¬ä¸€é˜¶æ®µ - æ ¸å¿ƒåŠŸèƒ½ (ç«‹å³å¼€å‘)
- ç”¨æˆ·æ³¨å†Œå’Œä¼šå‘˜ä½“ç³»
- WPS/PQRç®¡ç†
- åŸºç¡€ä¸šåŠ¡åŠŸèƒ½æ¨¡å—
- ç®¡ç†å‘˜é—¨æˆ·

#### ç¬¬äºŒé˜¶æ®µ - æ‰©å±•åŠŸèƒ½ (ä¸­æœŸå¼€å‘)
- æŠ¥è¡¨ç»Ÿè®¡
- ä¼ä¸šå‘˜å·¥ç®¡ç†
- ç”Ÿäº§/è´¨é‡/è®¾å¤‡ç®¡ç†
- æ”¯ä»˜é›†æˆå®Œå–„

#### ç¬¬ä¸‰é˜¶æ®µ - é«˜çº§åŠŸèƒ½ (åæœŸå¼€å‘)
- ç¡¬ä»¶äº¤äº’åŠŸèƒ½
- å›¾çº¸ç”ŸæˆåŠŸèƒ½
- AIæ™ºèƒ½æ¨è
- é«˜çº§æ•°æ®åˆ†æ

#### æŠ€æœ¯å‡†å¤‡
è™½ç„¶è¿™äº›åŠŸèƒ½åœ¨åæœŸå¼€å‘ï¼Œä½†æŠ€æœ¯æ ˆé€‰æ‹©å·²ç»è€ƒè™‘äº†è¿™äº›éœ€æ±‚ï¼š
- **Python** ä¸°å¯Œçš„ç¡¬ä»¶åº“æ”¯æŒ
- **FastAPI** é«˜æ€§èƒ½å®æ—¶é€šä¿¡
- **React** å®æ—¶æ•°æ®å±•ç¤ºèƒ½åŠ›
- **PostgreSQL** å¤æ‚æ•°æ®å­˜å‚¨

---

*æ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-10-15*
*æœ€åæ›´æ–°: 2025-10-15*

## ç®¡ç†å‘˜é—¨æˆ·ç³»ç»Ÿ

### é—¨æˆ·æ¶æ„è®¾è®¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·é—¨æˆ· (ä¸»ç«™ç‚¹)                       â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·æ³¨å†Œ/ç™»å½•                                       â”‚
â”‚  â”œâ”€â”€ ä¼šå‘˜åŠŸèƒ½æ¨¡å— (11ä¸ªä¸»è¦åŠŸèƒ½)                         â”‚
â”‚  â””â”€â”€ ä¸ªäººä¸­å¿ƒ                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
                        (ç‹¬ç«‹åŸŸå/å­è·¯å¾„)
                                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ç®¡ç†å‘˜é—¨æˆ· (admin.yourdomain.com)        â”‚
â”‚  â”œâ”€â”€ ç®¡ç†å‘˜ç™»å½•éªŒè¯                                       â”‚
â”‚  â”œâ”€â”€ ä¼šå‘˜ç›‘æ§æ¨¡å—                                       â”‚
â”‚  â”œâ”€â”€ ç³»ç»Ÿç®¡ç†æ¨¡å—                                       â”‚
â”‚  â”œâ”€â”€ æ•°æ®åˆ†ææ¨¡å—                                       â”‚
â”‚  â””â”€â”€ è¿è¥ç®¡ç†æ¨¡å—                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç®¡ç†å‘˜é—¨æˆ·åŠŸèƒ½æ¨¡å—
### ç®¡ç†å‘˜é—¨æˆ·è´¦å·å¯†ç 
- é‚®ç®±: Laimiu.new@gmail.com
- è´¦å·: Laimiu
- å¯†ç : ghzzz123 
#### 1. ä¼šå‘˜ç›‘æ§ä¸­å¿ƒ
**å®æ—¶ç›‘æ§é¢æ¿**
- **åœ¨çº¿ç”¨æˆ·ç»Ÿè®¡**: å½“å‰åœ¨çº¿ç”¨æˆ·æ•°ã€æ´»è·ƒåº¦åˆ†æ
- **ä¼šå‘˜åˆ†å¸ƒ**: å„ç­‰çº§ä¼šå‘˜æ•°é‡å’Œåˆ†å¸ƒæƒ…å†µ
- **æ”¶å…¥ç»Ÿè®¡**: æ—¥/æœˆ/å¹´æ”¶å…¥ç»Ÿè®¡å’Œè¶‹åŠ¿åˆ†æ
- **ç³»ç»Ÿè´Ÿè½½**: æœåŠ¡å™¨æ€§èƒ½ç›‘æ§å’Œèµ„æºä½¿ç”¨æƒ…å†µ

**ä¼šå‘˜è¯¦æƒ…ç®¡ç†**
- **ä¼šå‘˜åˆ—è¡¨**: æ”¯æŒå¤šæ¡ä»¶ç­›é€‰å’Œæœç´¢
- **ä¼šå‘˜è¯¦æƒ…**: æŸ¥çœ‹ç”¨æˆ·ä¸ªäººä¿¡æ¯ã€è®¢é˜…å†å²ã€ä½¿ç”¨æƒ…å†µ
- **æƒé™ç®¡ç†**: æ‰‹åŠ¨è°ƒæ•´ç”¨æˆ·æƒé™ç­‰çº§
- **è´¦å·æ“ä½œ**: ç¦ç”¨/å¯ç”¨ç”¨æˆ·è´¦å·ã€é‡ç½®å¯†ç 

#### 2. ä¼ä¸šä¼šå‘˜ç›‘æ§
**ä¼ä¸šæ¦‚è§ˆ**
- **ä¼ä¸šåˆ—è¡¨**: æŸ¥çœ‹æ‰€æœ‰ä¼ä¸šä¼šå‘˜ä¿¡æ¯
- **è®¢é˜…çŠ¶æ€**: ç›‘æ§ä¼ä¸šä¼šå‘˜è®¢é˜…å’Œç»­è´¹æƒ…å†µ
- **ä½¿ç”¨ç»Ÿè®¡**: ä¼ä¸šç”¨æˆ·æ´»è·ƒåº¦å’ŒåŠŸèƒ½ä½¿ç”¨æƒ…å†µ
- **å¼‚å¸¸ç›‘æ§**: æ£€æµ‹ä¼ä¸šå¼‚å¸¸ç™»å½•å’Œä½¿ç”¨è¡Œä¸º

**ä¼ä¸šæ•°æ®ç»Ÿè®¡**
- **ä¼ä¸šè§„æ¨¡**: ç»Ÿè®¡å„ä¼ä¸šå‘˜å·¥æ•°é‡å’Œå·¥å‚æ•°é‡
- **åŠŸèƒ½ä½¿ç”¨**: åˆ†æä¼ä¸šå„åŠŸèƒ½æ¨¡å—ä½¿ç”¨æƒ…å†µ
- **å­˜å‚¨å ç”¨**: ç›‘æ§ä¼ä¸šæ•°æ®å­˜å‚¨ç©ºé—´ä½¿ç”¨
- **æƒé™åˆè§„**: æ£€æŸ¥ä¼ä¸šæƒé™åˆ†é…æ˜¯å¦åˆè§„

#### 3. ç³»ç»Ÿç®¡ç†åŠŸèƒ½
**æ•°æ®ç®¡ç†**
- **æ•°æ®å¤‡ä»½**: æ‰‹åŠ¨/è‡ªåŠ¨å¤‡ä»½ç”¨æˆ·æ•°æ®
- **æ•°æ®æ¢å¤**: æ•°æ®æ¢å¤å’Œå›æ»šåŠŸèƒ½
- **å­˜å‚¨ç›‘æ§**: å­˜å‚¨ç©ºé—´ä½¿ç”¨æƒ…å†µç›‘æ§
- **æ¸…ç†å·¥å…·**: æ¸…ç†è¿‡æœŸæ•°æ®å’Œä¸´æ—¶æ–‡ä»¶

**ç³»ç»Ÿé…ç½®**
- **ä¼šå‘˜å®šä»·**: è°ƒæ•´å„ç­‰çº§ä¼šå‘˜ä»·æ ¼
- **åŠŸèƒ½å¼€å…³**: æ§åˆ¶åŠŸèƒ½æ¨¡å—çš„å¯ç”¨/ç¦ç”¨
- **ç³»ç»Ÿå…¬å‘Š**: å‘å¸ƒç³»ç»Ÿç»´æŠ¤å’Œæ›´æ–°é€šçŸ¥
- **ç‰ˆæœ¬ç®¡ç†**: ç³»ç»Ÿç‰ˆæœ¬æ§åˆ¶å’Œæ›´æ–°ç®¡ç†

#### 4. è´¢åŠ¡ç®¡ç†
**æ”¶å…¥åˆ†æ**
- **è®¢é˜…æ”¶å…¥**: è¯¦ç»†æ”¶å…¥ç»Ÿè®¡å’Œåˆ†æ
- **é€€æ¬¾å¤„ç†**: å¤„ç†ç”¨æˆ·é€€æ¬¾ç”³è¯·
- **å‘ç¥¨ç®¡ç†**: ç”Ÿæˆå’Œç®¡ç†ç”¨æˆ·å‘ç¥¨
- **è´¢åŠ¡æŠ¥è¡¨**: æœˆåº¦/å¹´åº¦è´¢åŠ¡æŠ¥è¡¨

**æ”¯ä»˜ç®¡ç†**
- **æ”¯ä»˜é€šé“**: ç›‘æ§æ”¯ä»˜æ¥å£çŠ¶æ€
- **å¼‚å¸¸è®¢å•**: å¤„ç†æ”¯ä»˜å¼‚å¸¸å’Œå¤±è´¥è®¢å•
- **å¯¹è´¦åŠŸèƒ½**: ä¸æ”¯ä»˜å¹³å°å¯¹è´¦

#### 5. å®‰å…¨ç›‘æ§
**å®‰å…¨é˜²æŠ¤**
- **ç™»å½•ç›‘æ§**: å¼‚å¸¸ç™»å½•è¡Œä¸ºæ£€æµ‹
- **æ“ä½œæ—¥å¿—**: è®°å½•æ‰€æœ‰ç®¡ç†å‘˜æ“ä½œ
- **å®‰å…¨æ‰«æ**: æ£€æµ‹ç³»ç»Ÿå®‰å…¨æ¼æ´
- **æƒé™å®¡è®¡**: å®šæœŸå®¡è®¡ç”¨æˆ·æƒé™åˆ†é…

**é£æ§ç®¡ç†**
- **è¡Œä¸ºåˆ†æ**: åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼
- **é£é™©é¢„è­¦**: æ£€æµ‹å¯ç–‘æ´»åŠ¨å¹¶é¢„è­¦
- **é»‘åå•ç®¡ç†**: ç®¡ç†æ¶æ„ç”¨æˆ·å’ŒIP

### æŠ€æœ¯å®ç°æ–¹æ¡ˆ

#### è®¿é—®æ§åˆ¶
```python
# ç®¡ç†å‘˜æƒé™è£…é¥°å™¨
from functools import wraps
from fastapi import HTTPException

def admin_required(func):
    @wraps(func)
    async def wrapper(*args, **kwargs):
        user = get_current_user()
        if not user or not user.is_admin:
            raise HTTPException(status_code=403, detail="Admin access required")
        return await func(*args, **kwargs)
    return wrapper
```

#### åŒé—¨æˆ·éƒ¨ç½²
```yaml
# docker-compose.yml
version: '3.8'
services:
  # ç”¨æˆ·é—¨æˆ·
  frontend:
    build: ./frontend
    environment:
      - PORTAL_TYPE=user
    ports:
      - "3000:3000"

  # ç®¡ç†å‘˜é—¨æˆ·
  admin-frontend:
    build: ./admin-frontend
    environment:
      - PORTAL_TYPE=admin
    ports:
      - "3001:3001"
```

#### åŸŸåé…ç½®
```nginx
# nginxé…ç½®
server {
    listen 80;
    server_name yourdomain.com;
    location / {
        proxy_pass http://frontend:3000;
    }
}

server {
    listen 80;
    server_name admin.yourdomain.com;
    location / {
        proxy_pass http://admin-frontend:3001;
    }
}
```

### ç®¡ç†å‘˜æƒé™ç­‰çº§

#### ç³»ç»Ÿç®¡ç†å‘˜ (Admin)
- **æ‰€æœ‰ç®¡ç†åŠŸèƒ½æƒé™** - å®Œæ•´çš„ç®¡ç†å‘˜é—¨æˆ·è®¿é—®æƒé™
- **ä¼šå‘˜ç›‘æ§å’Œç®¡ç†** - æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰ç”¨æˆ·è´¦å·
- **ç³»ç»Ÿé…ç½®ç®¡ç†** - è°ƒæ•´ä¼šå‘˜å®šä»·ã€åŠŸèƒ½å¼€å…³ç­‰
- **è´¢åŠ¡ç®¡ç†** - æŸ¥çœ‹æ”¶å…¥ç»Ÿè®¡ã€å¤„ç†é€€æ¬¾ç­‰
- **æ•°æ®ç®¡ç†** - æ•°æ®å¤‡ä»½ã€æ¢å¤ã€æ¸…ç†ç­‰
- **å®‰å…¨ç›‘æ§** - æŸ¥çœ‹æ—¥å¿—ã€å¤„ç†å¼‚å¸¸ç­‰

#### æ™®é€šç®¡ç†å‘˜ (å¯é€‰)
- **åªè¯»æƒé™** - ä»…å¯æŸ¥çœ‹æ•°æ®ï¼Œæ— æ³•ä¿®æ”¹
- **å®¢æœæ”¯æŒ** - å¤„ç†ç”¨æˆ·é—®é¢˜å’ŒåŸºç¡€æ“ä½œ
- **æŠ¥å‘ŠæŸ¥çœ‹** - æŸ¥çœ‹å„ç±»ç»Ÿè®¡æŠ¥è¡¨

**è¯´æ˜**ï¼š
- ä½œä¸ºä¸ªäººå¼€å‘è€…ï¼Œæ‚¨åªéœ€è¦**ä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜**è´¦å·å³å¯
- æ™®é€šç®¡ç†å‘˜è§’è‰²ä»…ä¸ºæœªæ¥å›¢é˜Ÿæ‰©å±•é¢„ç•™ï¼ŒåˆæœŸä¸éœ€è¦åˆ›å»º

## é¡¹ç›®æ–‡ä»¶ç»“æ„è®¾è®¡

### æ•´ä½“é¡¹ç›®ç»“æ„
```
weld-system/
â”œâ”€â”€ README.md                     # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ docker-compose.yml            # Dockerç¼–æ’é…ç½®
â”œâ”€â”€ docker-compose.dev.yml        # å¼€å‘ç¯å¢ƒDockeré…ç½®
â”œâ”€â”€ .env.example                  # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore                    # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ Makefile                      # å¸¸ç”¨å‘½ä»¤å¿«æ·æ–¹å¼
â”‚
â”œâ”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ api.md                    # APIæ–‡æ¡£
â”‚   â”œâ”€â”€ database.md               # æ•°æ®åº“è®¾è®¡
â”‚   â”œâ”€â”€ deployment.md             # éƒ¨ç½²æŒ‡å—
â”‚   â””â”€â”€ development.md            # å¼€å‘æŒ‡å—
â”‚
â”œâ”€â”€ scripts/                      # éƒ¨ç½²å’Œå·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ init-db.sql               # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ backup.sh                 # æ•°æ®å¤‡ä»½è„šæœ¬
â”‚   â”œâ”€â”€ deploy.sh                 # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ setup-dev.sh              # å¼€å‘ç¯å¢ƒè®¾ç½®è„šæœ¬
â”‚
â”œâ”€â”€ config/                       # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ nginx/                    # Nginxé…ç½®
â”‚   â”‚   â”œâ”€â”€ nginx.conf
â”‚   â”‚   â””â”€â”€ ssl/
â”‚   â”œâ”€â”€ monitoring/               # ç›‘æ§é…ç½®
â”‚   â”‚   â””â”€â”€ prometheus.yml
â”‚   â””â”€â”€ ssl/                      # SSLè¯ä¹¦
â”‚
â”œâ”€â”€ backend/                      # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ requirements.txt          # Pythonä¾èµ–
â”‚   â”œâ”€â”€ pyproject.toml           # Poetryé…ç½®
â”‚   â”œâ”€â”€ Dockerfile               # åç«¯Dockeræ–‡ä»¶
â”‚   â”œâ”€â”€ alembic.ini              # æ•°æ®åº“è¿ç§»é…ç½®
â”‚   â”œâ”€â”€ main.py                  # åº”ç”¨å…¥å£
â”‚   â”‚
â”‚   â”œâ”€â”€ app/                     # åº”ç”¨æ ¸å¿ƒä»£ç 
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ core/                # æ ¸å¿ƒé…ç½®å’Œå·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py        # åº”ç”¨é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ database.py      # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ security.py      # å®‰å…¨ç›¸å…³
â”‚   â”‚   â”‚   â”œâ”€â”€ redis.py         # Redisè¿æ¥
â”‚   â”‚   â”‚   â””â”€â”€ utils.py         # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py          # åŸºç¡€æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py          # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ wps.py           # WPSæ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ pqr.py           # PQRæ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ company.py       # ä¼ä¸šæ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ equipment.py     # è®¾å¤‡æ¨¡å‹
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ schemas/             # Pydanticæ¨¡å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”‚   â”œâ”€â”€ wps.py
â”‚   â”‚   â”‚   â””â”€â”€ response.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ api/                 # APIè·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ deps.py          # ä¾èµ–æ³¨å…¥
â”‚   â”‚   â”‚   â”œâ”€â”€ v1/              # APIç‰ˆæœ¬1
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.py      # è®¤è¯ç›¸å…³
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ users.py     # ç”¨æˆ·ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ wps.py       # WPSç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ pqr.py       # PQRç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ materials.py # ç„Šæç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ welders.py   # ç„Šå·¥ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ equipment.py # è®¾å¤‡ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ production.py# ç”Ÿäº§ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ quality.py   # è´¨é‡ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ reports.py   # æŠ¥è¡¨ç»Ÿè®¡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ admin.py     # ç®¡ç†å‘˜åŠŸèƒ½
â”‚   â”‚   â”‚   â””â”€â”€ websocket.py     # WebSocketè¿æ¥
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ user_service.py
â”‚   â”‚   â”‚   â”œâ”€â”€ wps_service.py
â”‚   â”‚   â”‚   â”œâ”€â”€ pqr_service.py
â”‚   â”‚   â”‚   â”œâ”€â”€ auth_service.py
â”‚   â”‚   â”‚   â”œâ”€â”€ payment_service.py
â”‚   â”‚   â”‚   â””â”€â”€ notification_service.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ai/                  # AIç›¸å…³åŠŸèƒ½
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ recommendation.py # æ™ºèƒ½æ¨è
â”‚   â”‚   â”‚   â”œâ”€â”€ optimization.py   # å‚æ•°ä¼˜åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ prediction.py     # é¢„æµ‹åˆ†æ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ hardware/            # ç¡¬ä»¶äº¤äº’
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ sensors.py       # ä¼ æ„Ÿå™¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ modbus_client.py # Modbusé€šä¿¡
â”‚   â”‚   â”‚   â””â”€â”€ monitoring.py    # å®æ—¶ç›‘æ§
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ drawing/             # å›¾çº¸ç”Ÿæˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ wps_generator.py # WPSæ–‡ä»¶ç”Ÿæˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ layout_generator.py # å¸ƒç½®å›¾ç”Ÿæˆ
â”‚   â”‚   â”‚   â””â”€â”€ pdf_generator.py # PDFç”Ÿæˆ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ tasks/               # å¼‚æ­¥ä»»åŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ celery_app.py    # Celeryé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ backup_tasks.py  # å¤‡ä»½ä»»åŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ report_tasks.py  # æŠ¥è¡¨ï¿½ï¿½æˆä»»åŠ¡
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ middleware/          # ä¸­é—´ä»¶
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ auth.py          # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚       â”œâ”€â”€ cors.py          # CORSä¸­é—´ä»¶
â”‚   â”‚       â””â”€â”€ logging.py       # æ—¥å¿—ä¸­é—´ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ alembic/                 # æ•°æ®åº“è¿ç§»
â”‚   â”‚   â”œâ”€â”€ versions/            # è¿ç§»ç‰ˆæœ¬
â”‚   â”‚   â”œâ”€â”€ env.py
â”‚   â”‚   â””â”€â”€ script.py.mako
â”‚   â”‚
â”‚   â””â”€â”€ tests/                   # æµ‹è¯•æ–‡ä»¶
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ conftest.py          # pytesté…ç½®
â”‚       â”œâ”€â”€ test_auth.py
â”‚       â”œâ”€â”€ test_wps.py
â”‚       â””â”€â”€ test_users.py
â”‚
â”œâ”€â”€ frontend/                    # ç”¨æˆ·é—¨æˆ·å‰ç«¯
â”‚   â”œâ”€â”€ package.json             # å‰ç«¯ä¾èµ–
â”‚   â”œâ”€â”€ tsconfig.json           # TypeScripté…ç½®
â”‚   â”œâ”€â”€ vite.config.ts          # Viteé…ç½®
â”‚   â”œâ”€â”€ Dockerfile              # å‰ç«¯Dockeræ–‡ä»¶
â”‚   â”œâ”€â”€ index.html              # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ .env.local              # æœ¬åœ°ç¯å¢ƒå˜é‡
â”‚   â”‚
â”‚   â”œâ”€â”€ public/                 # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ favicon.ico
â”‚   â”‚   â””â”€â”€ images/
â”‚   â”‚
â”‚   â””â”€â”€ src/                    # æºä»£ç 
â”‚       â”œâ”€â”€ main.tsx            # åº”ç”¨å…¥å£
â”‚       â”œâ”€â”€ App.tsx             # æ ¹ç»„ä»¶
â”‚       â”œâ”€â”€ vite-env.d.ts       # Viteç±»å‹å®šä¹‰
â”‚       â”‚
â”‚       â”œâ”€â”€ components/         # é€šç”¨ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ Layout/         # å¸ƒå±€ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ Forms/          # è¡¨å•ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ Tables/         # è¡¨æ ¼ç»„ä»¶
â”‚       â”‚   â””â”€â”€ Charts/         # å›¾è¡¨ç»„ä»¶
â”‚       â”‚
â”‚       â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ Dashboard/      # ä»ªè¡¨ç›˜
â”‚       â”‚   â”œâ”€â”€ WPS/           # WPSç®¡ç†
â”‚       â”‚   â”œâ”€â”€ PQR/           # PQRç®¡ç†
â”‚       â”‚   â”œâ”€â”€ Materials/     # ç„Šæç®¡ç†
â”‚       â”‚   â”œâ”€â”€ Welders/       # ç„Šå·¥ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ Equipment/     # è®¾å¤‡ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ Production/    # ç”Ÿäº§ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ Quality/       # è´¨é‡ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ Reports/       # æŠ¥è¡¨ç»Ÿè®¡
â”‚       â”‚   â”œâ”€â”€ Employees/     # å‘˜å·¥ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ Profile/       # ä¸ªäººä¸­å¿ƒ
â”‚       â”‚   â””â”€â”€ Auth/          # è®¤è¯é¡µé¢
â”‚       â”‚
â”‚       â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰Hooks
â”‚       â”‚   â”œâ”€â”€ useAuth.ts
â”‚       â”‚   â”œâ”€â”€ useWPS.ts
â”‚       â”‚   â””â”€â”€ useWebSocket.ts
â”‚       â”‚
â”‚       â”œâ”€â”€ services/           # APIæœåŠ¡
â”‚       â”‚   â”œâ”€â”€ api.ts          # APIå®¢æˆ·ç«¯
â”‚       â”‚   â”œâ”€â”€ auth.ts         # è®¤è¯æœåŠ¡
â”‚       â”‚   â”œâ”€â”€ wps.ts          # WPSæœåŠ¡
â”‚       â”‚   â””â”€â”€ websocket.ts    # WebSocketæœåŠ¡
â”‚       â”‚
â”‚       â”œâ”€â”€ store/              # çŠ¶æ€ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ index.ts
â”‚       â”‚   â”œâ”€â”€ authStore.ts
â”‚       â”‚   â””â”€â”€ wpsStore.ts
â”‚       â”‚
â”‚       â”œâ”€â”€ types/              # TypeScriptç±»å‹
â”‚       â”‚   â”œâ”€â”€ auth.ts
â”‚       â”‚   â”œâ”€â”€ wps.ts
â”‚       â”‚   â””â”€â”€ api.ts
â”‚       â”‚
â”‚       â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚       â”‚   â”œâ”€â”€ constants.ts
â”‚       â”‚   â”œâ”€â”€ helpers.ts
â”‚       â”‚   â””â”€â”€ validators.ts
â”‚       â”‚
â”‚       â””â”€â”€ styles/             # æ ·å¼æ–‡ä»¶
â”‚           â”œâ”€â”€ globals.css
â”‚           â””â”€â”€ components.css
â”‚
â”œâ”€â”€ admin-frontend/             # ç®¡ç†å‘˜é—¨æˆ·å‰ç«¯
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚
â”‚   â””â”€â”€ src/                   # ç®¡ç†å‘˜å‰ç«¯æºä»£ç 
â”‚       â”œâ”€â”€ main.tsx
â”‚       â”œâ”€â”€ App.tsx
â”‚       â”‚
â”‚       â”œâ”€â”€ pages/             # ç®¡ç†å‘˜é¡µé¢
â”‚       â”‚   â”œâ”€â”€ Dashboard/     # ç®¡ç†å‘˜ä»ªè¡¨ç›˜
â”‚       â”‚   â”œâ”€â”€ Users/         # ç”¨æˆ·ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ Companies/     # ä¼ä¸šç®¡ç†
â”‚       â”‚   â”œâ”€â”€ System/        # ç³»ç»Ÿç®¡ç†
â”‚       â”‚   â”œâ”€â”€ Finance/       # è´¢åŠ¡ç®¡ç†
â”‚       â”‚   â””â”€â”€ Security/      # å®‰å…¨ç›‘æ§
â”‚       â”‚
â”‚       â”œâ”€â”€ components/        # ç®¡ç†å‘˜ä¸“ç”¨ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ UserTable/
â”‚       â”‚   â”œâ”€â”€ CompanyChart/
â”‚       â”‚   â””â”€â”€ SystemMonitor/
â”‚       â”‚
â”‚       â””â”€â”€ services/          # ç®¡ç†å‘˜APIæœåŠ¡
â”‚           â”œâ”€â”€ admin.ts
â”‚           â”œâ”€â”€ users.ts
â”‚           â””â”€â”€ reports.ts
â”‚
â”œâ”€â”€ database/                   # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ init/                  # åˆå§‹åŒ–è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ 01-create-database.sql
â”‚   â”‚   â””â”€â”€ 02-create-admin.sql
â”‚   â””â”€â”€ migrations/            # æ•°æ®è¿ç§»æ–‡ä»¶
â”‚
â”œâ”€â”€ storage/                    # æ–‡ä»¶å­˜å‚¨
â”‚   â”œâ”€â”€ uploads/               # ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
â”‚   â”œâ”€â”€ reports/               # ç”Ÿæˆçš„æŠ¥è¡¨
â”‚   â”œâ”€â”€ drawings/              # ç”Ÿæˆçš„å›¾çº¸
â”‚   â””â”€â”€ backups/               # æ•°æ®å¤‡ä»½
â”‚
â””â”€â”€ monitoring/                 # ç›‘æ§å’Œæ—¥å¿—
    â”œâ”€â”€ logs/                  # åº”ç”¨æ—¥å¿—
    â”œâ”€â”€ metrics/               # æ€§èƒ½æŒ‡æ ‡
    â””â”€â”€ alerts/                # å‘Šè­¦é…ç½®
```

### å…³é”®é…ç½®æ–‡ä»¶è¯´æ˜

#### 1. æ ¹ç›®å½•é…ç½®æ–‡ä»¶

**docker-compose.yml**
```yaml
version: '3.8'
services:
  # åç«¯APIæœåŠ¡
  backend:
    build: ./backend
    environment:
      - DATABASE_URL=postgresql://user:pass@db:5432/weld_db
      - REDIS_URL=redis://redis:6379
    depends_on:
      - db
      - redis
    ports:
      - "8000:8000"

  # ç”¨æˆ·é—¨æˆ·å‰ç«¯
  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    depends_on:
      - backend

  # ç®¡ç†å‘˜é—¨æˆ·å‰ç«¯
  admin-frontend:
    build: ./admin-frontend
    ports:
      - "3001:3001"
    depends_on:
      - backend

  # æ•°æ®åº“
  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=weld_db
      - POSTGRES_USER=weld_user
      - POSTGRES_PASSWORD=weld_pass
    volumes:
      - postgres_data:/var/lib/postgresql/data

  # ç¼“å­˜
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  # æ¶ˆæ¯é˜Ÿåˆ—
  rabbitmq:
    image: rabbitmq:3-management
    environment:
      - RABBITMQ_DEFAULT_USER=weld_user
      - RABBITMQ_DEFAULT_PASS=weld_pass
    ports:
      - "5672:5672"
      - "15672:15672"

volumes:
  postgres_data:
```

**Makefile**
```makefile
.PHONY: help build up down logs clean test

help:
	@echo "Available commands:"
	@echo "  build    - Build all Docker images"
	@echo "  up       - Start all services"
	@echo "  down     - Stop all services"
	@echo "  logs     - Show logs"
	@echo "  clean    - Remove all containers and images"
	@echo "  test     - Run tests"

build:
	docker-compose build

up:
	docker-compose up -d

down:
	docker-compose down

logs:
	docker-compose logs -f

clean:
	docker-compose down -v --rmi all

test:
	docker-compose exec backend pytest
```

#### 2. å¼€å‘ç¯å¢ƒé…ç½®

**.env.example**
```env
# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://weld_user:weld_pass@localhost:5432/weld_db
REDIS_URL=redis://localhost:6379

# JWTé…ç½®
SECRET_KEY=your-secret-key-here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# æ”¯ä»˜é…ç½®
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# ç¡¬ä»¶é…ç½®
SERIAL_PORT=/dev/ttyUSB0
MODBUS_HOST=192.168.1.100

# æ–‡ä»¶å­˜å‚¨
UPLOAD_DIR=./storage/uploads
MAX_FILE_SIZE=10MB

# é‚®ä»¶é…ç½®
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
```

è¿™ä¸ªé¡¹ç›®ç»“æ„è®¾è®¡å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

### 1. **æ¸…æ™°çš„æ¨¡å—åˆ†ç¦»**
- å‰ç«¯ã€åç«¯ã€ç®¡ç†å‘˜é—¨æˆ·å®Œå…¨åˆ†ç¦»
- æ•°æ®åº“ã€é…ç½®ã€è„šæœ¬ç‹¬ç«‹ç®¡ç†
- ä¾¿äºå›¢é˜Ÿåä½œå’Œç»´æŠ¤

### 2. **å¾®æœåŠ¡å‹å¥½**
- åç«¯APIæŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡
- æ”¯æŒç‹¬ç«‹éƒ¨ç½²å’Œæ‰©å±•
- æ¸…æ™°çš„æœåŠ¡è¾¹ç•Œ

### 3. **å¼€å‘ä½“éªŒä¼˜åŒ–**
- Dockerä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒ
- å®Œæ•´çš„æµ‹è¯•æ¡†æ¶
- è¯¦ç»†çš„æ–‡æ¡£å’Œé…ç½®

### 4. **ç”Ÿäº§å°±ç»ª**
- åŒ…å«ç›‘æ§ã€æ—¥å¿—ã€å¤‡ä»½
- å®‰å…¨é…ç½®å’Œéƒ¨ç½²è„šæœ¬
- æ”¯æŒCI/CDé›†æˆ

---

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒæ•°æ®è¡¨ç»“æ„

#### 1. ç”¨æˆ·ç›¸å…³è¡¨

**users (ç”¨æˆ·è¡¨)**
```sql
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    username VARCHAR(100) UNIQUE NOT NULL,
    hashed_password VARCHAR(255) NOT NULL,
    full_name VARCHAR(255),
    phone VARCHAR(20),
    avatar_url VARCHAR(500),
    timezone VARCHAR(50) DEFAULT 'UTC',
    language VARCHAR(10) DEFAULT 'zh-CN',
    is_active BOOLEAN DEFAULT TRUE,
    is_admin BOOLEAN DEFAULT FALSE,
    email_verified BOOLEAN DEFAULT FALSE,
    phone_verified BOOLEAN DEFAULT FALSE,
    membership_tier VARCHAR(50) DEFAULT 'free', -- free, pro, advanced, flagship
    membership_type VARCHAR(50) DEFAULT 'personal', -- personal, enterprise
    subscription_status VARCHAR(50) DEFAULT 'active', -- active, expired, cancelled
    subscription_start_date TIMESTAMP,
    subscription_end_date TIMESTAMP,
    trial_end_date TIMESTAMP,
    auto_renewal BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login_at TIMESTAMP,
    password_changed_at TIMESTAMP,
    email_verification_token VARCHAR(255),
    password_reset_token VARCHAR(255),
    password_reset_expires TIMESTAMP,
    login_attempts INTEGER DEFAULT 0,
    locked_until TIMESTAMP,
    preferences JSONB, -- ç”¨æˆ·åå¥½è®¾ç½®
    INDEX idx_email (email),
    INDEX idx_username (username),
    INDEX idx_membership (membership_tier, membership_type),
    INDEX idx_subscription_status (subscription_status)
);
```

**companies (ä¼ä¸šè¡¨)**
```sql
CREATE TABLE companies (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    owner_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    membership_tier VARCHAR(50) NOT NULL, -- enterprise, enterprise_pro, enterprise_pro_max
    max_factories INTEGER DEFAULT 1,
    max_employees INTEGER DEFAULT 10,
    max_wps_records INTEGER DEFAULT 200, -- åŸºäºä¼šå‘˜ç­‰çº§çš„WPSè®°å½•é™åˆ¶
    max_pqr_records INTEGER DEFAULT 200, -- åŸºäºä¼šå‘˜ç­‰çº§çš„PQRè®°å½•é™åˆ¶
    business_license VARCHAR(255), -- è¥ä¸šæ‰§ç…§å·ç 
    contact_person VARCHAR(100), -- è”ç³»äºº
    contact_phone VARCHAR(20), -- è”ç³»ç”µè¯
    contact_email VARCHAR(255), -- è”ç³»é‚®ç®±
    address TEXT, -- å…¬å¸åœ°å€
    website VARCHAR(255), -- å…¬å¸ç½‘ç«™
    industry VARCHAR(100), -- è¡Œä¸šç±»å‹
    company_size VARCHAR(50), -- å…¬å¸è§„æ¨¡
    description TEXT, -- å…¬å¸æè¿°
    logo_url VARCHAR(500), -- å…¬å¸logo
    is_active BOOLEAN DEFAULT TRUE,
    is_verified BOOLEAN DEFAULT FALSE, -- æ˜¯å¦å·²è®¤è¯
    subscription_status VARCHAR(50) DEFAULT 'active', -- active, expired, cancelled
    subscription_start_date TIMESTAMP,
    subscription_end_date TIMESTAMP,
    trial_end_date TIMESTAMP,
    auto_renewal BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_owner (owner_id),
    INDEX idx_membership_tier (membership_tier),
    INDEX idx_subscription_status (subscription_status)
);
```

**factories (å·¥å‚è¡¨)**
```sql
CREATE TABLE factories (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    company_id UUID NOT NULL REFERENCES companies(id) ON DELETE CASCADE,
    name VARCHAR(255) NOT NULL,
    code VARCHAR(100) UNIQUE, -- å·¥å‚ç¼–ç 
    address TEXT,
    city VARCHAR(100),
    province VARCHAR(100),
    postal_code VARCHAR(20),
    country VARCHAR(50) DEFAULT 'China',
    contact_person VARCHAR(100),
    contact_phone VARCHAR(20),
    contact_email VARCHAR(255),
    timezone VARCHAR(50) DEFAULT 'Asia/Shanghai',
    description TEXT,
    established_date DATE, -- æˆç«‹æ—¥æœŸ
    certification_info JSONB, -- è®¤è¯ä¿¡æ¯
    is_active BOOLEAN DEFAULT TRUE,
    is_headquarters BOOLEAN DEFAULT FALSE, -- æ˜¯å¦ä¸ºæ€»éƒ¨
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_company (company_id),
    INDEX idx_code (code),
    INDEX idx_location (city, province)
);
```

**company_employees (ä¼ä¸šå‘˜å·¥å…³è”è¡¨)**
```sql
CREATE TABLE company_employees (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    company_id UUID NOT NULL REFERENCES companies(id) ON DELETE CASCADE,
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    factory_id UUID REFERENCES factories(id) ON DELETE SET NULL,
    role VARCHAR(50) DEFAULT 'employee', -- admin, manager, employee
    permissions JSONB, -- è‡ªå®šä¹‰æƒé™é…ç½®
    is_active BOOLEAN DEFAULT TRUE,
    invited_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    joined_at TIMESTAMP,
    UNIQUE(company_id, user_id),
    INDEX idx_company_user (company_id, user_id)
);
```

#### 2. WPS/PQRç›¸å…³è¡¨

**wps_records (WPSè®°å½•è¡¨)**
```sql
CREATE TABLE wps_records (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    factory_id UUID REFERENCES factories(id) ON DELETE SET NULL,
    wps_number VARCHAR(100) NOT NULL,
    title VARCHAR(255) NOT NULL,
    version VARCHAR(50) DEFAULT '1.0',
    revision INTEGER DEFAULT 1, -- ä¿®è®¢ç‰ˆæœ¬å·
    status VARCHAR(50) DEFAULT 'draft', -- draft, review, approved, archived, obsolete
    priority VARCHAR(20) DEFAULT 'normal', -- low, normal, high, urgent

    -- æ ‡å‡†å’Œè§„èŒƒ
    standard VARCHAR(100), -- ä½¿ç”¨çš„æ ‡å‡† (å¦‚AWS, ISO, GBç­‰)
    specification_number VARCHAR(100), -- è§„èŒƒç¼–å·
    pqr_support_uuids JSONB, -- æ”¯æŒçš„PQRè®°å½•UUIDåˆ—è¡¨

    -- ç„Šæ¥å·¥è‰ºå‚æ•°
    base_material VARCHAR(255),
    base_material_group VARCHAR(100), -- æ¯æç»„å·
    base_material_thickness DECIMAL(8,2), -- æ¯æåšåº¦èŒƒå›´
    filler_material VARCHAR(255),
    filler_material_classification VARCHAR(100), -- ç„Šæåˆ†ç±»
    welding_process VARCHAR(100),
    welding_process_variant VARCHAR(100), -- ç„Šæ¥å·¥è‰ºå˜ä½“
    joint_type VARCHAR(100),
    joint_design VARCHAR(255), -- æ¥å¤´è®¾è®¡è¯¦æƒ…
    welding_position VARCHAR(50),
    welding_position_progression VARCHAR(50), -- ç„Šæ¥ä½ç½®è¿›å±•
    preheat_temp_min DECIMAL(10,2),
    preheat_temp_max DECIMAL(10,2),
    interpass_temp_min DECIMAL(10,2),
    interpass_temp_max DECIMAL(10,2),
    post_weld_heat_treatment JSONB, -- ç„Šåçƒ­å¤„ç†å‚æ•°
    current_range VARCHAR(50),
    voltage_range VARCHAR(50),
    travel_speed VARCHAR(50),
    heat_input_range VARCHAR(50),
    gas_shield_type VARCHAR(100), -- ä¿æŠ¤æ°”ä½“ç±»å‹
    gas_flow_rate DECIMAL(8,2), -- æ°”ä½“æµé‡
    tungsten_electrode_type VARCHAR(100), -- é’¨æç±»å‹
    electrode_diameter DECIMAL(6,2), -- ç”µæç›´å¾„

    -- æŠ€æœ¯ä¿¡æ¯
    technique_description TEXT, -- å·¥è‰ºæè¿°
    welder_qualification_requirement VARCHAR(255), -- ç„Šå·¥èµ„è´¨è¦æ±‚
    inspection_requirements JSONB, -- æ£€éªŒè¦æ±‚

    -- é™„åŠ ä¿¡æ¯
    notes TEXT,
    attachments JSONB, -- é™„ä»¶ä¿¡æ¯
    tags JSONB, -- æ ‡ç­¾

    -- å®¡æ ¸å’Œæ‰¹å‡†ä¿¡æ¯
    reviewed_by UUID REFERENCES users(id),
    reviewed_at TIMESTAMP,
    approved_by UUID REFERENCES users(id),
    approved_at TIMESTAMP,
    effective_date DATE, -- ç”Ÿæ•ˆæ—¥æœŸ
    expiry_date DATE, -- è¿‡æœŸæ—¥æœŸ

    -- ç»Ÿè®¡ä¿¡æ¯
    view_count INTEGER DEFAULT 0,
    download_count INTEGER DEFAULT 0,
    last_viewed_at TIMESTAMP,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by UUID REFERENCES users(id),

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_factory (factory_id),
    INDEX idx_wps_number (wps_number),
    INDEX idx_status (status),
    INDEX idx_standard (standard),
    INDEX idx_approval (approved_by, approved_at),
    INDEX idx_effective_date (effective_date, expiry_date)
);
```

**pqr_records (PQRè®°å½•è¡¨)**
```sql
CREATE TABLE pqr_records (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    factory_id UUID REFERENCES factories(id) ON DELETE SET NULL,
    pqr_number VARCHAR(100) NOT NULL,
    wps_id UUID REFERENCES wps_records(id) ON DELETE SET NULL,
    title VARCHAR(255) NOT NULL,
    test_date DATE,
    status VARCHAR(50) DEFAULT 'pending', -- pending, qualified, failed

    -- æµ‹è¯•å‚æ•°
    test_organization VARCHAR(255),
    welder_name VARCHAR(100),
    base_material VARCHAR(255),
    filler_material VARCHAR(255),
    welding_process VARCHAR(100),

    -- æµ‹è¯•ç»“æœ
    tensile_strength DECIMAL(10,2),
    yield_strength DECIMAL(10,2),
    elongation DECIMAL(10,2),
    impact_energy JSONB, -- å†²å‡»èƒ½é‡æ•°æ®
    bend_test_result VARCHAR(50),
    macro_examination TEXT,

    -- é™„åŠ ä¿¡æ¯
    notes TEXT,
    attachments JSONB,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_pqr_number (pqr_number),
    INDEX idx_wps (wps_id)
);
```

**ppqr_records (pPQRé¢„å¤‡è¯„å®šè®°å½•è¡¨)**
```sql
CREATE TABLE ppqr_records (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    ppqr_number VARCHAR(100) NOT NULL,
    title VARCHAR(255) NOT NULL,
    status VARCHAR(50) DEFAULT 'draft', -- draft, under_review, approved, rejected
    planned_test_date DATE,

    -- é¢„å¤‡å‚æ•°
    proposed_parameters JSONB,
    review_comments TEXT,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id)
);
```

#### 3. ç„Šæå’Œç„Šå·¥ç®¡ç†è¡¨

**welding_materials (ç„Šæè¡¨)**
```sql
CREATE TABLE welding_materials (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    factory_id UUID REFERENCES factories(id) ON DELETE SET NULL,

    material_code VARCHAR(100) NOT NULL,
    material_name VARCHAR(255) NOT NULL,
    material_type VARCHAR(100), -- electrode, wire, flux, gas
    specification VARCHAR(255),
    manufacturer VARCHAR(255),

    -- åº“å­˜ä¿¡æ¯
    current_stock DECIMAL(10,2),
    unit VARCHAR(50),
    min_stock_level DECIMAL(10,2),
    storage_location VARCHAR(255),

    -- ä»·æ ¼ä¿¡æ¯
    unit_price DECIMAL(10,2),
    currency VARCHAR(10) DEFAULT 'CNY',

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_material_code (material_code)
);
```

**welders (ç„Šå·¥è¡¨)**
```sql
CREATE TABLE welders (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    factory_id UUID REFERENCES factories(id) ON DELETE SET NULL,

    welder_code VARCHAR(100) NOT NULL,
    full_name VARCHAR(255) NOT NULL,
    id_number VARCHAR(50),
    phone VARCHAR(20),

    -- èµ„è´¨ä¿¡æ¯
    certification_number VARCHAR(100),
    certification_level VARCHAR(50),
    certification_date DATE,
    expiry_date DATE,
    qualified_processes JSONB, -- åˆæ ¼çš„ç„Šæ¥æ–¹æ³•

    -- çŠ¶æ€
    is_active BOOLEAN DEFAULT TRUE,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_welder_code (welder_code)
);
```

#### 4. è®¾å¤‡å’Œç”Ÿäº§ç®¡ç†è¡¨

**equipment (è®¾å¤‡è¡¨)**
```sql
CREATE TABLE equipment (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    factory_id UUID REFERENCES factories(id) ON DELETE SET NULL,

    equipment_code VARCHAR(100) NOT NULL,
    equipment_name VARCHAR(255) NOT NULL,
    equipment_type VARCHAR(100), -- welding_machine, cutting_machine, etc.
    manufacturer VARCHAR(255),
    model VARCHAR(100),
    serial_number VARCHAR(100),

    -- çŠ¶æ€ä¿¡æ¯
    status VARCHAR(50) DEFAULT 'operational', -- operational, maintenance, broken
    purchase_date DATE,
    last_maintenance_date DATE,
    next_maintenance_date DATE,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id)
);
```

**production_tasks (ç”Ÿäº§ä»»åŠ¡è¡¨)**
```sql
CREATE TABLE production_tasks (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    factory_id UUID REFERENCES factories(id) ON DELETE SET NULL,

    task_number VARCHAR(100) NOT NULL,
    task_name VARCHAR(255) NOT NULL,
    wps_id UUID REFERENCES wps_records(id),

    -- ä»»åŠ¡ä¿¡æ¯
    start_date DATE,
    end_date DATE,
    status VARCHAR(50) DEFAULT 'pending', -- pending, in_progress, completed, cancelled
    priority VARCHAR(50) DEFAULT 'normal', -- low, normal, high, urgent

    -- åˆ†é…ä¿¡æ¯
    assigned_welder_id UUID REFERENCES welders(id),
    assigned_equipment_id UUID REFERENCES equipment(id),

    -- è¿›åº¦ä¿¡æ¯
    progress_percentage INTEGER DEFAULT 0,
    notes TEXT,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_status (status)
);
```

#### 5. è´¨é‡ç®¡ç†è¡¨

**quality_inspections (è´¨é‡æ£€éªŒè¡¨)**
```sql
CREATE TABLE quality_inspections (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    production_task_id UUID REFERENCES production_tasks(id),

    inspection_number VARCHAR(100) NOT NULL,
    inspection_date DATE NOT NULL,
    inspector_name VARCHAR(100),

    -- æ£€éªŒç»“æœ
    inspection_type VARCHAR(100), -- visual, radiographic, ultrasonic, etc.
    result VARCHAR(50) DEFAULT 'pending', -- pass, fail, conditional
    defects_found JSONB,

    -- å¤„ç†æªæ–½
    corrective_actions TEXT,
    follow_up_required BOOLEAN DEFAULT FALSE,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_task (production_task_id)
);
```

#### 6. ç³»ç»Ÿç®¡ç†è¡¨

**subscriptions (è®¢é˜…è®°å½•è¡¨)**
```sql
CREATE TABLE subscriptions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,

    plan_type VARCHAR(50) NOT NULL, -- free, pro, advanced, flagship, enterprise, etc.
    billing_cycle VARCHAR(50) DEFAULT 'monthly', -- monthly, quarterly, yearly
    amount DECIMAL(10,2) NOT NULL,
    currency VARCHAR(10) DEFAULT 'CNY',

    -- è®¢é˜…å‘¨æœŸ
    start_date TIMESTAMP NOT NULL,
    end_date TIMESTAMP NOT NULL,
    auto_renew BOOLEAN DEFAULT TRUE,

    -- æ”¯ä»˜ä¿¡æ¯
    payment_method VARCHAR(50),
    payment_status VARCHAR(50) DEFAULT 'pending', -- pending, paid, failed, refunded
    transaction_id VARCHAR(255),

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_status (payment_status)
);
```

**audit_logs (å®¡è®¡æ—¥å¿—è¡¨)**
```sql
CREATE TABLE audit_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE SET NULL,
    action VARCHAR(100) NOT NULL, -- create, update, delete, login, etc.
    resource_type VARCHAR(100), -- wps, pqr, user, etc.
    resource_id UUID,

    -- è¯¦ç»†ä¿¡æ¯
    ip_address VARCHAR(50),
    user_agent TEXT,
    changes JSONB, -- å˜æ›´è¯¦æƒ…

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_action (action),
    INDEX idx_resource (resource_type, resource_id),
    INDEX idx_created_at (created_at)
);
```

#### 6. ç³»ç»Ÿç®¡ç†å’Œå®¡è®¡è¡¨

**audit_logs (å®¡è®¡æ—¥å¿—è¡¨)**
```sql
CREATE TABLE audit_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE SET NULL,
    company_id UUID REFERENCES companies(id) ON DELETE SET NULL,
    action VARCHAR(100) NOT NULL, -- create, update, delete, login, logout, etc.
    resource_type VARCHAR(100) NOT NULL, -- wps, pqr, user, company, etc.
    resource_id UUID, -- è¢«æ“ä½œèµ„æºçš„ID
    old_values JSONB, -- ä¿®æ”¹å‰çš„å€¼
    new_values JSONB, -- ä¿®æ”¹åçš„å€¼
    ip_address INET, -- æ“ä½œIPåœ°å€
    user_agent TEXT, -- ç”¨æˆ·ä»£ç†
    session_id VARCHAR(255), -- ä¼šè¯ID
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    description TEXT, -- æ“ä½œæè¿°
    risk_level VARCHAR(20) DEFAULT 'low', -- low, medium, high, critical

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_action (action),
    INDEX idx_resource (resource_type, resource_id),
    INDEX idx_timestamp (timestamp),
    INDEX idx_risk_level (risk_level)
);
```

**user_sessions (ç”¨æˆ·ä¼šè¯è¡¨)**
```sql
CREATE TABLE user_sessions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    session_token VARCHAR(255) UNIQUE NOT NULL,
    refresh_token VARCHAR(255) UNIQUE,
    ip_address INET,
    user_agent TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    expires_at TIMESTAMP NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_activity_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_session_token (session_token),
    INDEX idx_refresh_token (refresh_token),
    INDEX idx_expires_at (expires_at)
);
```

**system_notifications (ç³»ç»Ÿé€šçŸ¥è¡¨)**
```sql
CREATE TABLE system_notifications (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    title VARCHAR(255) NOT NULL,
    message TEXT NOT NULL,
    notification_type VARCHAR(50) NOT NULL, -- info, warning, error, success, maintenance
    target_audience VARCHAR(50) DEFAULT 'all', -- all, users, admins, enterprises
    target_user_id UUID REFERENCES users(id) ON DELETE CASCADE, -- ç‰¹å®šç”¨æˆ·é€šçŸ¥
    target_company_id UUID REFERENCES companies(id) ON DELETE CASCADE, -- ç‰¹å®šå…¬å¸é€šçŸ¥
    is_active BOOLEAN DEFAULT TRUE,
    is_read BOOLEAN DEFAULT FALSE,
    scheduled_at TIMESTAMP, -- å®šæ—¶å‘é€
    expires_at TIMESTAMP, -- è¿‡æœŸæ—¶é—´
    created_by UUID REFERENCES users(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    read_at TIMESTAMP,

    INDEX idx_target_user (target_user_id),
    INDEX idx_target_company (target_company_id),
    INDEX idx_type (notification_type),
    INDEX idx_active (is_active),
    INDEX idx_scheduled (scheduled_at)
);
```

**file_attachments (æ–‡ä»¶é™„ä»¶è¡¨)**
```sql
CREATE TABLE file_attachments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    resource_type VARCHAR(100) NOT NULL, -- wps, pqr, company_user, etc.
    resource_id UUID NOT NULL, -- å…³è”èµ„æºID

    original_filename VARCHAR(255) NOT NULL,
    stored_filename VARCHAR(255) NOT NULL,
    file_path VARCHAR(500) NOT NULL,
    file_size BIGINT NOT NULL,
    mime_type VARCHAR(100) NOT NULL,
    file_hash VARCHAR(64) NOT NULL, -- SHA-256 hash for integrity

    description TEXT,
    is_public BOOLEAN DEFAULT FALSE,
    download_count INTEGER DEFAULT 0,
    last_downloaded_at TIMESTAMP,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_resource (resource_type, resource_id),
    INDEX idx_file_hash (file_hash)
);
```

**subscription_payments (è®¢é˜…æ”¯ä»˜è®°å½•è¡¨)**
```sql
CREATE TABLE subscription_payments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,

    payment_method VARCHAR(50) NOT NULL, -- alipay, wechat, credit_card, bank_transfer
    payment_gateway VARCHAR(100), -- æ”¯ä»˜ç½‘å…³
    transaction_id VARCHAR(255) UNIQUE, -- äº¤æ˜“ID
    order_id VARCHAR(255) UNIQUE, -- è®¢å•ID

    amount DECIMAL(12,2) NOT NULL,
    currency VARCHAR(10) DEFAULT 'CNY',
    payment_status VARCHAR(50) NOT NULL, -- pending, completed, failed, refunded, cancelled

    membership_tier VARCHAR(50) NOT NULL, -- è´­ä¹°çš„ä¼šå‘˜ç­‰çº§
    membership_type VARCHAR(50) NOT NULL, -- personal, enterprise
    subscription_duration INTEGER NOT NULL, -- è®¢é˜…æœˆæ•°

    payment_date TIMESTAMP,
    refunded_at TIMESTAMP,
    refund_amount DECIMAL(12,2),
    refund_reason TEXT,

    gateway_response JSONB, -- æ”¯ä»˜ç½‘å…³å“åº”
    notes TEXT,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_user (user_id),
    INDEX idx_company (company_id),
    INDEX idx_transaction (transaction_id),
    INDEX idx_order (order_id),
    INDEX idx_status (payment_status),
    INDEX idx_payment_date (payment_date)
);
```

### æ•°æ®åº“ç´¢å¼•ç­–ç•¥

1. **ä¸»é”®ç´¢å¼•**: æ‰€æœ‰è¡¨ä½¿ç”¨UUIDä½œä¸ºä¸»é”®
2. **å¤–é”®ç´¢å¼•**: æ‰€æœ‰å¤–é”®å­—æ®µè‡ªåŠ¨åˆ›å»ºç´¢å¼•
3. **æŸ¥è¯¢ä¼˜åŒ–ç´¢å¼•**:
   - ç”¨æˆ·é‚®ç®±ã€ç”¨æˆ·åï¼ˆå”¯ä¸€ç´¢å¼•ï¼‰
   - ä¼šå‘˜ç­‰çº§å’Œç±»å‹ï¼ˆç»„åˆç´¢å¼•ï¼‰
   - è®°å½•ç¼–å·ï¼ˆå¦‚WPSç¼–å·ã€PQRç¼–å·ï¼‰
   - çŠ¶æ€å­—æ®µï¼ˆç”¨äºç­›é€‰ï¼‰
   - æ—¶é—´å­—æ®µï¼ˆç”¨äºæ’åºå’ŒèŒƒå›´æŸ¥è¯¢ï¼‰

### æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–

1. **åˆ†åŒºç­–ç•¥**:
   - å®¡è®¡æ—¥å¿—è¡¨æŒ‰æœˆåˆ†åŒº
   - å†å²æ•°æ®å½’æ¡£ç­–ç•¥

2. **ç¼“å­˜ç­–ç•¥**:
   - ç”¨æˆ·ä¼šå‘˜ä¿¡æ¯ç¼“å­˜ï¼ˆRedisï¼‰
   - å¸¸ç”¨æŸ¥è¯¢ç»“æœç¼“å­˜
   - ä¼šè¯æ•°æ®ç¼“å­˜

3. **æŸ¥è¯¢ä¼˜åŒ–**:
   - ä½¿ç”¨EXPLAINåˆ†ææ…¢æŸ¥è¯¢
   - é¿å…N+1æŸ¥è¯¢é—®é¢˜
   - ä½¿ç”¨è¿æ¥æ± ç®¡ç†æ•°æ®åº“è¿æ¥

---

## APIæ¥å£è®¾è®¡è§„èŒƒ

### RESTful APIè®¾è®¡åŸåˆ™

#### 1. URLå‘½åè§„èŒƒ

```
# èµ„æºå‘½åä½¿ç”¨å¤æ•°å½¢å¼
GET    /api/v1/users              # è·å–ç”¨æˆ·åˆ—è¡¨
POST   /api/v1/users              # åˆ›å»ºç”¨æˆ·
GET    /api/v1/users/{id}         # è·å–å•ä¸ªç”¨æˆ·
PUT    /api/v1/users/{id}         # æ›´æ–°ç”¨æˆ·
DELETE /api/v1/users/{id}         # åˆ é™¤ç”¨æˆ·

# åµŒå¥—èµ„æº
GET    /api/v1/companies/{id}/employees    # è·å–ä¼ä¸šå‘˜å·¥åˆ—è¡¨
POST   /api/v1/companies/{id}/employees    # æ·»åŠ ä¼ä¸šå‘˜å·¥

# ç‰¹æ®Šæ“ä½œä½¿ç”¨åŠ¨è¯
POST   /api/v1/users/{id}/activate         # æ¿€æ´»ç”¨æˆ·
POST   /api/v1/subscriptions/{id}/renew    # ç»­è´¹è®¢é˜…
```

#### 2. HTTPçŠ¶æ€ç ä½¿ç”¨è§„èŒƒ

```
200 OK                  - è¯·æ±‚æˆåŠŸ
201 Created             - èµ„æºåˆ›å»ºæˆåŠŸ
204 No Content          - åˆ é™¤æˆåŠŸ
400 Bad Request         - è¯·æ±‚å‚æ•°é”™è¯¯
401 Unauthorized        - æœªè®¤è¯
403 Forbidden           - æ— æƒé™
404 Not Found           - èµ„æºä¸å­˜åœ¨
409 Conflict            - èµ„æºå†²çª
422 Unprocessable Entity - éªŒè¯å¤±è´¥
429 Too Many Requests   - è¯·æ±‚è¿‡äºé¢‘ç¹
500 Internal Server Error - æœåŠ¡å™¨é”™è¯¯
```

#### 3. ç»Ÿä¸€å“åº”æ ¼å¼

**æˆåŠŸå“åº”**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "name": "example"
  },
  "message": "æ“ä½œæˆåŠŸ",
  "timestamp": "2025-10-15T10:00:00Z"
}
```

**åˆ—è¡¨å“åº”**
```json
{
  "success": true,
  "data": {
    "items": [...],
    "total": 100,
    "page": 1,
    "page_size": 20,
    "total_pages": 5
  },
  "message": "æŸ¥è¯¢æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "éªŒè¯å¤±è´¥",
    "details": {
      "email": ["é‚®ç®±æ ¼å¼ä¸æ­£ç¡®"],
      "password": ["å¯†ç é•¿åº¦è‡³å°‘8ä½"]
    }
  },
  "timestamp": "2025-10-15T10:00:00Z"
}
```

### æ ¸å¿ƒAPIç«¯ç‚¹

#### è®¤è¯ç›¸å…³
```
POST   /api/v1/auth/register          # ç”¨æˆ·æ³¨å†Œ
POST   /api/v1/auth/login             # ç”¨æˆ·ç™»å½•
POST   /api/v1/auth/logout            # ç”¨æˆ·ç™»å‡º
POST   /api/v1/auth/refresh           # åˆ·æ–°Token
POST   /api/v1/auth/forgot-password   # å¿˜è®°å¯†ç 
POST   /api/v1/auth/reset-password    # é‡ç½®å¯†ç 
GET    /api/v1/auth/verify-email      # éªŒè¯é‚®ç®±
```

#### ç”¨æˆ·ç®¡ç†
```
GET    /api/v1/users/me               # è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
PUT    /api/v1/users/me               # æ›´æ–°å½“å‰ç”¨æˆ·ä¿¡æ¯
GET    /api/v1/users/me/subscription  # è·å–è®¢é˜…ä¿¡æ¯
POST   /api/v1/users/me/upgrade       # å‡çº§ä¼šå‘˜
```

#### WPSç®¡ç†
```
GET    /api/v1/wps                    # è·å–WPSåˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€æœç´¢ã€ç­›é€‰ï¼‰
POST   /api/v1/wps                    # åˆ›å»ºWPS
GET    /api/v1/wps/{id}               # è·å–WPSè¯¦æƒ…
PUT    /api/v1/wps/{id}               # æ›´æ–°WPS
DELETE /api/v1/wps/{id}               # åˆ é™¤WPS
POST   /api/v1/wps/{id}/approve       # å®¡æ‰¹WPS
POST   /api/v1/wps/{id}/reject        # æ‹’ç»WPS
POST   /api/v1/wps/{id}/archive       # å½’æ¡£WPS
GET    /api/v1/wps/{id}/versions      # è·å–ç‰ˆæœ¬å†å²
POST   /api/v1/wps/{id}/duplicate     # å¤åˆ¶WPS
GET    /api/v1/wps/{id}/export/pdf    # å¯¼å‡ºPDF
GET    /api/v1/wps/{id}/export/excel  # å¯¼å‡ºExcel
POST   /api/v1/wps/batch              # æ‰¹é‡æ“ä½œWPS
GET    /api/v1/wps/search             # é«˜çº§æœç´¢WPS
GET    /api/v1/wps/templates          # è·å–WPSæ¨¡æ¿
POST   /api/v1/wps/from-template      # ä»æ¨¡æ¿åˆ›å»ºWPS
```

#### PQRç®¡ç†
```
GET    /api/v1/pqr                    # è·å–PQRåˆ—è¡¨
POST   /api/v1/pqr                    # åˆ›å»ºPQR
GET    /api/v1/pqr/{id}               # è·å–PQRè¯¦æƒ…
PUT    /api/v1/pqr/{id}               # æ›´æ–°PQR
DELETE /api/v1/pqr/{id}               # åˆ é™¤PQR
POST   /api/v1/pqr/{id}/qualify       # æ ‡è®°ä¸ºåˆæ ¼
POST   /api/v1/pqr/{id}/fail          # æ ‡è®°ä¸ºä¸åˆæ ¼
GET    /api/v1/pqr/{id}/export/pdf    # å¯¼å‡ºPDF
POST   /api/v1/pqr/batch              # æ‰¹é‡æ“ä½œPQR
```

#### pPQRç®¡ç†
```
GET    /api/v1/ppqr                   # è·å–pPQRåˆ—è¡¨
POST   /api/v1/ppqr                   # åˆ›å»ºpPQR
GET    /api/v1/ppqr/{id}              # è·å–pPQRè¯¦æƒ…
PUT    /api/v1/ppqr/{id}              # æ›´æ–°pPQR
DELETE /api/v1/ppqr/{id}              # åˆ é™¤pPQR
POST   /api/v1/ppqr/{id}/submit       # æäº¤å®¡æ ¸
POST   /api/v1/ppqr/{id}/approve      # å®¡æ‰¹é€šè¿‡
POST   /api/v1/ppqr/{id}/reject       # å®¡æ‰¹æ‹’ç»
```

#### ç„Šå·¥ç®¡ç†
```
GET    /api/v1/welders                # è·å–ç„Šå·¥åˆ—è¡¨
POST   /api/v1/welders                # æ·»åŠ ç„Šå·¥
GET    /api/v1/welders/{id}           # è·å–ç„Šå·¥è¯¦æƒ…
PUT    /api/v1/welders/{id}           # æ›´æ–°ç„Šå·¥ä¿¡æ¯
DELETE /api/v1/welders/{id}           # åˆ é™¤ç„Šå·¥
POST   /api/v1/welders/{id}/certify   # æ·»åŠ èµ„è´¨è¯ä¹¦
GET    /api/v1/welders/{id}/history   # è·å–ç„Šå·¥å†å²è®°å½•
POST   /api/v1/welders/import         # æ‰¹é‡å¯¼å…¥ç„Šå·¥
```

#### ç„Šæç®¡ç†
```
GET    /api/v1/materials              # è·å–ç„Šæåˆ—è¡¨
POST   /api/v1/materials              # æ·»åŠ ç„Šæ
GET    /api/v1/materials/{id}         # è·å–ç„Šæè¯¦æƒ…
PUT    /api/v1/materials/{id}         # æ›´æ–°ç„Šæä¿¡æ¯
DELETE /api/v1/materials/{id}         # åˆ é™¤ç„Šæ
POST   /api/v1/materials/{id}/stock   # æ›´æ–°åº“å­˜
GET    /api/v1/materials/low-stock    # è·å–ä½åº“å­˜é¢„è­¦
POST   /api/v1/materials/consume      # è®°å½•ç„Šææ¶ˆè€—
GET    /api/v1/materials/history      # è·å–åº“å­˜å†å²
```

#### è®¾å¤‡ç®¡ç†
```
GET    /api/v1/equipment              # è·å–è®¾å¤‡åˆ—è¡¨
POST   /api/v1/equipment              # æ·»åŠ è®¾å¤‡
GET    /api/v1/equipment/{id}         # è·å–è®¾å¤‡è¯¦æƒ…
PUT    /api/v1/equipment/{id}         # æ›´æ–°è®¾å¤‡ä¿¡æ¯
DELETE /api/v1/equipment/{id}         # åˆ é™¤è®¾å¤‡
POST   /api/v1/equipment/{id}/maintain # è®°å½•ç»´æŠ¤
GET    /api/v1/equipment/{id}/schedule # è·å–ç»´æŠ¤è®¡åˆ’
POST   /api/v1/equipment/{id}/status   # æ›´æ–°è®¾å¤‡çŠ¶æ€
```

#### ä¼ä¸šç®¡ç†
```
GET    /api/v1/companies              # è·å–ä¼ä¸šåˆ—è¡¨
POST   /api/v1/companies              # åˆ›å»ºä¼ä¸š
GET    /api/v1/companies/{id}         # è·å–ä¼ä¸šè¯¦æƒ…
PUT    /api/v1/companies/{id}         # æ›´æ–°ä¼ä¸šä¿¡æ¯
DELETE /api/v1/companies/{id}         # åˆ é™¤ä¼ä¸š
GET    /api/v1/companies/{id}/employees    # è·å–å‘˜å·¥åˆ—è¡¨
POST   /api/v1/companies/{id}/invite       # é‚€è¯·å‘˜å·¥
PUT    /api/v1/companies/{id}/employees/{user_id}  # æ›´æ–°å‘˜å·¥æƒé™
DELETE /api/v1/companies/{id}/employees/{user_id}  # ç§»é™¤å‘˜å·¥
GET    /api/v1/companies/{id}/factories     # è·å–å·¥å‚åˆ—è¡¨
POST   /api/v1/companies/{id}/factories     # æ·»åŠ å·¥å‚
GET    /api/v1/companies/{id}/usage        # è·å–ä½¿ç”¨ç»Ÿè®¡
POST   /api/v1/companies/{id}/upgrade      # å‡çº§ä¼šå‘˜ç­‰çº§
```

#### æŠ¥è¡¨ç»Ÿè®¡
```
GET    /api/v1/reports/dashboard       # ä»ªè¡¨ç›˜æ•°æ®
GET    /api/v1/reports/wps-summary     # WPSç»Ÿè®¡æŠ¥è¡¨
GET    /api/v1/reports/pqr-summary     # PQRç»Ÿè®¡æŠ¥è¡¨
GET    /api/v1/reports/usage           # ä½¿ç”¨æƒ…å†µæŠ¥è¡¨
GET    /api/v1/reports/materials       # ç„Šææ¶ˆè€—æŠ¥è¡¨
POST   /api/v1/reports/export          # å¯¼å‡ºæŠ¥è¡¨
```

#### æ–‡ä»¶ç®¡ç†
```
POST   /api/v1/files/upload            # ä¸Šä¼ æ–‡ä»¶
GET    /api/v1/files/{id}              # ä¸‹è½½æ–‡ä»¶
DELETE /api/v1/files/{id}              # åˆ é™¤æ–‡ä»¶
GET    /api/v1/files/{id}/info         # è·å–æ–‡ä»¶ä¿¡æ¯
POST   /api/v1/files/batch-upload      # æ‰¹é‡ä¸Šä¼ æ–‡ä»¶
```

#### é€šçŸ¥ç³»ç»Ÿ
```
GET    /api/v1/notifications           # è·å–é€šçŸ¥åˆ—è¡¨
PUT    /api/v1/notifications/{id}/read # æ ‡è®°å·²è¯»
POST   /api/v1/notifications/mark-all  # å…¨éƒ¨æ ‡è®°å·²è¯»
DELETE /api/v1/notifications/{id}      # åˆ é™¤é€šçŸ¥
```

#### ç®¡ç†å‘˜API
```
GET    /api/v1/admin/users            # è·å–æ‰€æœ‰ç”¨æˆ·
POST   /api/v1/admin/users/{id}/ban   # å°ç¦ç”¨æˆ·
POST   /api/v1/admin/users/{id}/unban # è§£å°ç”¨æˆ·
PUT    /api/v1/admin/users/{id}/role  # ä¿®æ”¹ç”¨æˆ·è§’è‰²
GET    /api/v1/admin/companies        # è·å–æ‰€æœ‰ä¼ä¸š
PUT    /api/v1/admin/companies/{id}/verify # è®¤è¯ä¼ä¸š
GET    /api/v1/admin/statistics       # è·å–ç³»ç»Ÿç»Ÿè®¡
GET    /api/v1/admin/subscriptions    # è·å–è®¢é˜…åˆ—è¡¨
POST   /api/v1/admin/subscriptions/{id}/cancel # å–æ¶ˆè®¢é˜…
GET    /api/v1/admin/audit-logs       # è·å–å®¡è®¡æ—¥å¿—
GET    /api/v1/admin/system-health    # ç³»ç»Ÿå¥åº·æ£€æŸ¥
POST   /api/v1/admin/maintenance      # ç³»ç»Ÿç»´æŠ¤æ¨¡å¼
GET    /api/v1/admin/backup           # æ•°æ®åº“å¤‡ä»½
POST   /api/v1/admin/notifications   # å‘é€ç³»ç»Ÿé€šçŸ¥
```

#### æ”¯ä»˜å’Œè®¢é˜…
```
GET    /api/v1/plans                  # è·å–è®¢é˜…è®¡åˆ’
POST   /api/v1/subscriptions          # åˆ›å»ºè®¢é˜…
GET    /api/v1/subscriptions/{id}     # è·å–è®¢é˜…è¯¦æƒ…
POST   /api/v1/subscriptions/{id}/renew # ç»­è´¹è®¢é˜…
POST   /api/v1/subscriptions/{id}/cancel # å–æ¶ˆè®¢é˜…
GET    /api/v1/payments               # è·å–æ”¯ä»˜è®°å½•
POST   /api/v1/payments/create        # åˆ›å»ºæ”¯ä»˜è®¢å•
GET    /api/v1/payments/{id}/status   # æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€
POST   /api/v1/payments/webhook       # æ”¯ä»˜å›è°ƒæ¥å£
```

### APIè®¤è¯å’Œæˆæƒ

#### JWT Tokenè®¤è¯
```python
# Tokenç»“æ„
{
  "user_id": "uuid",
  "email": "user@example.com",
  "membership_tier": "pro",
  "is_admin": false,
  "exp": 1234567890,
  "iat": 1234567890
}

# è¯·æ±‚å¤´
Authorization: Bearer <access_token>
```

#### æƒé™éªŒè¯è£…é¥°å™¨
```python
from functools import wraps
from fastapi import HTTPException, Depends

def require_membership(min_tier: str):
    """è¦æ±‚æœ€ä½ä¼šå‘˜ç­‰çº§"""
    def decorator(func):
        @wraps(func)
        async def wrapper(*args, current_user=Depends(get_current_user), **kwargs):
            if not check_membership_tier(current_user.membership_tier, min_tier):
                raise HTTPException(
                    status_code=403,
                    detail="éœ€è¦æ›´é«˜çš„ä¼šå‘˜ç­‰çº§"
                )
            return await func(*args, current_user=current_user, **kwargs)
        return wrapper
    return decorator

# ä½¿ç”¨ç¤ºä¾‹
@router.post("/ppqr")
@require_membership("pro")
async def create_ppqr(data: PPQRCreate, current_user: User = Depends(get_current_user)):
    # åªæœ‰ä¸“ä¸šç‰ˆåŠä»¥ä¸Šä¼šå‘˜å¯ä»¥åˆ›å»ºpPQR
    pass
```

### APIè¯¦ç»†è§„èŒƒ

#### åˆ†é¡µå‚æ•°è§„èŒƒ
```
# æ‰€æœ‰åˆ—è¡¨APIéƒ½æ”¯æŒåˆ†é¡µ
GET /api/v1/wps?page=1&page_size=20&sort=created_at&order=desc

# æŸ¥è¯¢å‚æ•°
page: é¡µç  (é»˜è®¤: 1)
page_size: æ¯é¡µæ•°é‡ (é»˜è®¤: 20, æœ€å¤§: 100)
sort: æ’åºå­—æ®µ
order: æ’åºæ–¹å‘ (asc/desc)
search: æœç´¢å…³é”®è¯
```

#### æœç´¢å’Œç­›é€‰
```
# é«˜çº§æœç´¢æ”¯æŒ
GET /api/v1/wps?search=ç®¡é“ç„Šæ¥&status=approved&standard=AWS&created_after=2024-01-01

# å¸¸ç”¨ç­›é€‰å‚æ•°
status: çŠ¶æ€ç­›é€‰
standard: æ ‡å‡†ç­›é€‰
company_id: ä¼ä¸šç­›é€‰
factory_id: å·¥å‚ç­›é€‰
created_after: åˆ›å»ºæ—¶é—´ç­›é€‰ï¼ˆä¹‹åï¼‰
created_before: åˆ›å»ºæ—¶é—´ç­›é€‰ï¼ˆä¹‹å‰ï¼‰
updated_after: æ›´æ–°æ—¶é—´ç­›é€‰ï¼ˆä¹‹åï¼‰
```

#### APIè¯·æ±‚ç¤ºä¾‹

**åˆ›å»ºWPS**
```bash
curl -X POST "https://api.weld-system.com/v1/wps" \
  -H "Authorization: Bearer {access_token}" \
  -H "Content-Type: application/json" \
  -d '{
    "wps_number": "WPS-2024-001",
    "title": "ç¢³é’¢ç®¡é“å¯¹æ¥ç„Šå·¥è‰º",
    "standard": "AWS D1.1",
    "base_material": "ASTM A36",
    "filler_material": "E7018",
    "welding_process": "SMAW",
    "joint_type": "Butt Joint",
    "welding_position": "1G",
    "preheat_temp_min": 50,
    "preheat_temp_max": 100,
    "current_range": "90-130A",
    "voltage_range": "22-28V",
    "travel_speed": "3-5 cm/min"
  }'
```

**æ‰¹é‡æ“ä½œ**
```bash
curl -X POST "https://api.weld-system.com/v1/wps/batch" \
  -H "Authorization: Bearer {access_token}" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "archive",
    "ids": ["uuid1", "uuid2", "uuid3"]
  }'
```

**æ–‡ä»¶ä¸Šä¼ **
```bash
curl -X POST "https://api.weld-system.com/v1/files/upload" \
  -H "Authorization: Bearer {access_token}" \
  -F "file=@document.pdf" \
  -F "resource_type=wps" \
  -F "resource_id=uuid-here" \
  -F "description=WPSæ”¯æŒæ–‡æ¡£"
```

#### APIå“åº”ç¤ºä¾‹

**æˆåŠŸå“åº”**
```json
{
  "success": true,
  "data": {
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "wps_number": "WPS-2024-001",
    "title": "ç¢³é’¢ç®¡é“å¯¹æ¥ç„Šå·¥è‰º",
    "status": "draft",
    "created_at": "2024-10-15T10:00:00Z",
    "updated_at": "2024-10-15T10:00:00Z"
  },
  "message": "WPSåˆ›å»ºæˆåŠŸ",
  "timestamp": "2024-10-15T10:00:00Z"
}
```

**åˆ—è¡¨å“åº”**
```json
{
  "success": true,
  "data": {
    "items": [
      {
        "id": "uuid1",
        "wps_number": "WPS-001",
        "title": "å·¥è‰º1",
        "status": "approved",
        "created_at": "2024-10-15T10:00:00Z"
      }
    ],
    "total": 150,
    "page": 1,
    "page_size": 20,
    "total_pages": 8,
    "has_next": true,
    "has_prev": false
  },
  "message": "æŸ¥è¯¢æˆåŠŸ"
}
```

**é”™è¯¯å“åº”**
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥",
    "details": {
      "wps_number": ["WPSç¼–å·å·²å­˜åœ¨"],
      "current_range": ["ç”µæµèŒƒå›´æ ¼å¼ä¸æ­£ç¡®"]
    },
    "request_id": "req_123456789"
  },
  "timestamp": "2024-10-15T10:00:00Z"
}
```

#### APIé”™è¯¯ç è§„èŒƒ
```
# é€šç”¨é”™è¯¯ç 
VALIDATION_ERROR: å‚æ•°éªŒè¯å¤±è´¥
UNAUTHORIZED: æœªè®¤è¯
FORBIDDEN: æƒé™ä¸è¶³
NOT_FOUND: èµ„æºä¸å­˜åœ¨
CONFLICT: èµ„æºå†²çª
RATE_LIMIT_EXCEEDED: è¯·æ±‚é¢‘ç‡è¶…é™
INTERNAL_ERROR: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

# ä¸šåŠ¡é”™è¯¯ç 
MEMBERSHIP_REQUIRED: éœ€è¦ä¼šå‘˜æƒé™
QUOTA_EXCEEDED: é…é¢å·²ç”¨å®Œ
SUBSCRIPTION_EXPIRED: è®¢é˜…å·²è¿‡æœŸ
COMPANY_NOT_VERIFIED: ä¼ä¸šæœªè®¤è¯
WPS_ALREADY_APPROVED: WPSå·²å®¡æ‰¹ï¼Œæ— æ³•ä¿®æ”¹
```

#### APIç‰ˆæœ¬æ§åˆ¶
```
# å½“å‰ç‰ˆæœ¬: v1
# ç‰ˆæœ¬åœ¨URLä¸­æŒ‡å®š: /api/v1/
# å‘åå…¼å®¹æ€§: ä¿æŒè‡³å°‘ä¸¤ä¸ªç‰ˆæœ¬çš„å…¼å®¹æ€§
# åºŸå¼ƒé€šçŸ¥: æå‰3ä¸ªæœˆé€šçŸ¥APIåºŸå¼ƒ

# ç‰ˆæœ¬å‡çº§ç­–ç•¥
- æ·»åŠ å­—æ®µ: ä¸å½±å“ç°æœ‰ç‰ˆæœ¬
- åˆ é™¤å­—æ®µ: å‘å¸ƒæ–°ç‰ˆæœ¬
- ä¿®æ”¹å­—æ®µç±»å‹: å‘å¸ƒæ–°ç‰ˆæœ¬
- ä¿®æ”¹ä¸šåŠ¡é€»è¾‘: å‘å¸ƒæ–°ç‰ˆæœ¬
```

## å®‰å…¨æ€§è®¾è®¡

### 1. è®¤è¯å®‰å…¨

#### å¯†ç å®‰å…¨ç­–ç•¥
```python
from passlib.context import CryptContext
import secrets

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

# å¯†ç è¦æ±‚
PASSWORD_MIN_LENGTH = 8
PASSWORD_REQUIRE_UPPERCASE = True
PASSWORD_REQUIRE_LOWERCASE = True
PASSWORD_REQUIRE_DIGIT = True
PASSWORD_REQUIRE_SPECIAL = True

def hash_password(password: str) -> str:
    """ä½¿ç”¨bcryptåŠ å¯†å¯†ç """
    return pwd_context.hash(password)

def verify_password(plain_password: str, hashed_password: str) -> bool:
    """éªŒè¯å¯†ç """
    return pwd_context.verify(plain_password, hashed_password)

def generate_secure_token(length: int = 32) -> str:
    """ç”Ÿæˆå®‰å…¨çš„éšæœºtoken"""
    return secrets.token_urlsafe(length)
```

#### JWT Tokenå®‰å…¨
```python
from datetime import datetime, timedelta
from jose import JWTError, jwt

SECRET_KEY = "your-secret-key-here"  # ä»ç¯å¢ƒå˜é‡è¯»å–
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30
REFRESH_TOKEN_EXPIRE_DAYS = 7

def create_access_token(data: dict) -> str:
    """åˆ›å»ºè®¿é—®ä»¤ç‰Œ"""
    to_encode = data.copy()
    expire = datetime.utcnow() + timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    to_encode.update({"exp": expire, "type": "access"})
    return jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)

def create_refresh_token(data: dict) -> str:
    """åˆ›å»ºåˆ·æ–°ä»¤ç‰Œ"""
    to_encode = data.copy()
    expire = datetime.utcnow() + timedelta(days=REFRESH_TOKEN_EXPIRE_DAYS)
    to_encode.update({"exp": expire, "type": "refresh"})
    return jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
```

#### ç™»å½•ä¿æŠ¤
```python
from fastapi import HTTPException
from datetime import datetime, timedelta
import redis

redis_client = redis.Redis(host='localhost', port=6379, db=0)

MAX_LOGIN_ATTEMPTS = 5
LOCKOUT_DURATION = 15  # åˆ†é’Ÿ

async def check_login_attempts(email: str):
    """æ£€æŸ¥ç™»å½•å°è¯•æ¬¡æ•°"""
    key = f"login_attempts:{email}"
    attempts = redis_client.get(key)

    if attempts and int(attempts) >= MAX_LOGIN_ATTEMPTS:
        raise HTTPException(
            status_code=429,
            detail=f"ç™»å½•å°è¯•æ¬¡æ•°è¿‡å¤šï¼Œè¯·{LOCKOUT_DURATION}åˆ†é’Ÿåå†è¯•"
        )

async def record_failed_login(email: str):
    """è®°å½•å¤±è´¥çš„ç™»å½•å°è¯•"""
    key = f"login_attempts:{email}"
    redis_client.incr(key)
    redis_client.expire(key, LOCKOUT_DURATION * 60)

async def clear_login_attempts(email: str):
    """æ¸…é™¤ç™»å½•å°è¯•è®°å½•"""
    key = f"login_attempts:{email}"
    redis_client.delete(key)
```

### 2. æ•°æ®å®‰å…¨

#### æ•°æ®åŠ å¯†
```python
from cryptography.fernet import Fernet
import os

# æ•æ„Ÿæ•°æ®åŠ å¯†
ENCRYPTION_KEY = os.getenv("ENCRYPTION_KEY")
cipher_suite = Fernet(ENCRYPTION_KEY)

def encrypt_sensitive_data(data: str) -> str:
    """åŠ å¯†æ•æ„Ÿæ•°æ®"""
    return cipher_suite.encrypt(data.encode()).decode()

def decrypt_sensitive_data(encrypted_data: str) -> str:
    """è§£å¯†æ•æ„Ÿæ•°æ®"""
    return cipher_suite.decrypt(encrypted_data.encode()).decode()
```

#### SQLæ³¨å…¥é˜²æŠ¤
```python
from sqlalchemy import text

# âŒ é”™è¯¯ç¤ºä¾‹ - å®¹æ˜“å—åˆ°SQLæ³¨å…¥æ”»å‡»
def get_user_unsafe(email: str):
    query = f"SELECT * FROM users WHERE email = '{email}'"
    return db.execute(query)

# âœ… æ­£ç¡®ç¤ºä¾‹ - ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
def get_user_safe(email: str):
    query = text("SELECT * FROM users WHERE email = :email")
    return db.execute(query, {"email": email})

# âœ… ä½¿ç”¨ORMï¼ˆæ¨èï¼‰
def get_user_orm(email: str):
    return db.query(User).filter(User.email == email).first()
```

#### XSSé˜²æŠ¤
```python
from html import escape
from bleach import clean

def sanitize_html_input(content: str) -> str:
    """æ¸…ç†HTMLè¾“å…¥ï¼Œé˜²æ­¢XSSæ”»å‡»"""
    allowed_tags = ['p', 'br', 'strong', 'em', 'u']
    allowed_attributes = {}
    return clean(content, tags=allowed_tags, attributes=allowed_attributes, strip=True)

def escape_user_input(text: str) -> str:
    """è½¬ä¹‰ç”¨æˆ·è¾“å…¥"""
    return escape(text)
```

### 3. APIå®‰å…¨

#### CORSé…ç½®
```python
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=[
        "https://yourdomain.com",
        "https://admin.yourdomain.com"
    ],  # ç”Ÿäº§ç¯å¢ƒåªå…è®¸ç‰¹å®šåŸŸå
    allow_credentials=True,
    allow_methods=["GET", "POST", "PUT", "DELETE"],
    allow_headers=["*"],
    max_age=3600,
)
```

#### è¯·æ±‚é™æµ
```python
from slowapi import Limiter, _rate_limit_exceeded_handler
from slowapi.util import get_remote_address
from slowapi.errors import RateLimitExceeded

limiter = Limiter(key_func=get_remote_address)
app.state.limiter = limiter
app.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler)

# ä½¿ç”¨ç¤ºä¾‹
@app.post("/api/v1/auth/login")
@limiter.limit("5/minute")  # æ¯åˆ†é’Ÿæœ€å¤š5æ¬¡è¯·æ±‚
async def login(request: Request, credentials: LoginCredentials):
    pass

@app.get("/api/v1/wps")
@limiter.limit("100/minute")  # æ™®é€šAPIé™åˆ¶
async def get_wps_list(request: Request):
    pass
```

#### CSRFä¿æŠ¤
```python
from fastapi_csrf_protect import CsrfProtect
from pydantic import BaseModel

class CsrfSettings(BaseModel):
    secret_key: str = "your-csrf-secret-key"
    cookie_samesite: str = "lax"
    cookie_secure: bool = True
    cookie_httponly: bool = True

@CsrfProtect.load_config
def get_csrf_config():
    return CsrfSettings()

# ä½¿ç”¨ç¤ºä¾‹
@app.post("/api/v1/wps")
async def create_wps(
    request: Request,
    data: WPSCreate,
    csrf_protect: CsrfProtect = Depends()
):
    await csrf_protect.validate_csrf(request)
    # å¤„ç†è¯·æ±‚
```

### 4. æ–‡ä»¶ä¸Šä¼ å®‰å…¨

```python
from fastapi import UploadFile, HTTPException
import magic
import os

ALLOWED_EXTENSIONS = {'.pdf', '.jpg', '.jpeg', '.png', '.doc', '.docx', '.xls', '.xlsx'}
MAX_FILE_SIZE = 10 * 1024 * 1024  # 10MB

async def validate_file_upload(file: UploadFile):
    """éªŒè¯ä¸Šä¼ æ–‡ä»¶"""
    # æ£€æŸ¥æ–‡ä»¶æ‰©å±•å
    file_ext = os.path.splitext(file.filename)[1].lower()
    if file_ext not in ALLOWED_EXTENSIONS:
        raise HTTPException(
            status_code=400,
            detail=f"ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: {file_ext}"
        )

    # æ£€æŸ¥æ–‡ä»¶å¤§å°
    file.file.seek(0, 2)  # ç§»åŠ¨åˆ°æ–‡ä»¶æœ«å°¾
    file_size = file.file.tell()
    file.file.seek(0)  # é‡ç½®æ–‡ä»¶æŒ‡é’ˆ

    if file_size > MAX_FILE_SIZE:
        raise HTTPException(
            status_code=400,
            detail=f"æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ ({MAX_FILE_SIZE / 1024 / 1024}MB)"
        )

    # éªŒè¯æ–‡ä»¶MIMEç±»å‹
    file_content = await file.read(1024)
    file.file.seek(0)
    mime_type = magic.from_buffer(file_content, mime=True)

    allowed_mimes = {
        'application/pdf',
        'image/jpeg',
        'image/png',
        'application/msword',
        'application/vnd.openxmlformats-officedocument.wordprocessingml.document'
    }

    if mime_type not in allowed_mimes:
        raise HTTPException(
            status_code=400,
            detail="æ–‡ä»¶ç±»å‹éªŒè¯å¤±è´¥"
        )

    return True
```

### 5. æ•°æ®è®¿é—®æ§åˆ¶

```python
from fastapi import Depends, HTTPException
from sqlalchemy.orm import Session

async def check_resource_ownership(
    resource_id: str,
    resource_type: str,
    current_user: User,
    db: Session
):
    """æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æƒè®¿é—®èµ„æº"""

    # ç®¡ç†å‘˜å¯ä»¥è®¿é—®æ‰€æœ‰èµ„æº
    if current_user.is_admin:
        return True

    # æ£€æŸ¥ä¸ªäººèµ„æºæ‰€æœ‰æƒ
    if resource_type == "wps":
        resource = db.query(WPSRecord).filter(WPSRecord.id == resource_id).first()
    elif resource_type == "pqr":
        resource = db.query(PQRRecord).filter(PQRRecord.id == resource_id).first()
    else:
        raise HTTPException(status_code=400, detail="æœªçŸ¥çš„èµ„æºç±»å‹")

    if not resource:
        raise HTTPException(status_code=404, detail="èµ„æºä¸å­˜åœ¨")

    # æ£€æŸ¥æ˜¯å¦æ˜¯èµ„æºæ‰€æœ‰è€…
    if resource.user_id == current_user.id:
        return True

    # æ£€æŸ¥ä¼ä¸šæƒé™
    if resource.company_id:
        employee = db.query(CompanyEmployee).filter(
            CompanyEmployee.company_id == resource.company_id,
            CompanyEmployee.user_id == current_user.id,
            CompanyEmployee.is_active == True
        ).first()

        if employee:
            # æ£€æŸ¥å‘˜å·¥æƒé™
            permissions = employee.permissions or {}
            if permissions.get(f"{resource_type}_read", False):
                return True

    raise HTTPException(status_code=403, detail="æ— æƒè®¿é—®æ­¤èµ„æº")
```

### 6. å®¡è®¡æ—¥å¿—

```python
from datetime import datetime
from fastapi import Request

async def log_audit_event(
    user_id: str,
    action: str,
    resource_type: str,
    resource_id: str,
    request: Request,
    changes: dict = None,
    db: Session = None
):
    """è®°å½•å®¡è®¡æ—¥å¿—"""
    audit_log = AuditLog(
        user_id=user_id,
        action=action,
        resource_type=resource_type,
        resource_id=resource_id,
        ip_address=request.client.host,
        user_agent=request.headers.get("user-agent"),
        changes=changes,
        created_at=datetime.utcnow()
    )
    db.add(audit_log)
    db.commit()

# ä½¿ç”¨ç¤ºä¾‹
@app.put("/api/v1/wps/{wps_id}")
async def update_wps(
    wps_id: str,
    data: WPSUpdate,
    request: Request,
    current_user: User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    wps = db.query(WPSRecord).filter(WPSRecord.id == wps_id).first()
    old_data = wps.dict()

    # æ›´æ–°WPS
    for key, value in data.dict(exclude_unset=True).items():
        setattr(wps, key, value)

    db.commit()

    # è®°å½•å®¡è®¡æ—¥å¿—
    await log_audit_event(
        user_id=current_user.id,
        action="update",
        resource_type="wps",
        resource_id=wps_id,
        request=request,
        changes={"old": old_data, "new": wps.dict()},
        db=db
    )

    return wps
```

---

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. æ•°æ®åº“ä¼˜åŒ–

#### æŸ¥è¯¢ä¼˜åŒ–
```python
from sqlalchemy.orm import joinedload, selectinload

# âŒ N+1æŸ¥è¯¢é—®é¢˜
def get_wps_with_user_bad():
    wps_list = db.query(WPSRecord).all()
    for wps in wps_list:
        user = wps.user  # æ¯æ¬¡éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢
        print(user.name)

# âœ… ä½¿ç”¨é¢„åŠ è½½
def get_wps_with_user_good():
    wps_list = db.query(WPSRecord).options(
        joinedload(WPSRecord.user)
    ).all()
    for wps in wps_list:
        print(wps.user.name)  # ä¸ä¼šè§¦å‘é¢å¤–æŸ¥è¯¢

# âœ… æ‰¹é‡æŸ¥è¯¢
def get_multiple_wps(ids: list):
    return db.query(WPSRecord).filter(WPSRecord.id.in_(ids)).all()
```

#### åˆ†é¡µæŸ¥è¯¢
```python
from fastapi import Query

@app.get("/api/v1/wps")
async def get_wps_list(
    page: int = Query(1, ge=1),
    page_size: int = Query(20, ge=1, le=100),
    db: Session = Depends(get_db)
):
    # è®¡ç®—åç§»é‡
    offset = (page - 1) * page_size

    # æŸ¥è¯¢æ€»æ•°
    total = db.query(WPSRecord).count()

    # åˆ†é¡µæŸ¥è¯¢
    items = db.query(WPSRecord)\
        .offset(offset)\
        .limit(page_size)\
        .all()

    return {
        "items": items,
        "total": total,
        "page": page,
        "page_size": page_size,
        "total_pages": (total + page_size - 1) // page_size
    }
```

#### æ•°æ®åº“è¿æ¥æ± 
```python
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker

# é…ç½®è¿æ¥æ± 
engine = create_engine(
    DATABASE_URL,
    pool_size=20,          # è¿æ¥æ± å¤§å°
    max_overflow=10,       # è¶…è¿‡pool_sizeåæœ€å¤šåˆ›å»ºçš„è¿æ¥æ•°
    pool_timeout=30,       # è·å–è¿æ¥çš„è¶…æ—¶æ—¶é—´
    pool_recycle=3600,     # è¿æ¥å›æ”¶æ—¶é—´ï¼ˆç§’ï¼‰
    pool_pre_ping=True,    # ä½¿ç”¨å‰æ£€æŸ¥è¿æ¥æ˜¯å¦æœ‰æ•ˆ
    echo=False             # ç”Ÿäº§ç¯å¢ƒå…³é—­SQLæ—¥å¿—
)

SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)
```

### 2. ç¼“å­˜ç­–ç•¥

#### Redisç¼“å­˜
```python
import redis
import json
from functools import wraps
from typing import Optional

redis_client = redis.Redis(
    host='localhost',
    port=6379,
    db=0,
    decode_responses=True
)

def cache_result(expire: int = 300):
    """ç¼“å­˜è£…é¥°å™¨"""
    def decorator(func):
        @wraps(func)
        async def wrapper(*args, **kwargs):
            # ç”Ÿæˆç¼“å­˜é”®
            cache_key = f"{func.__name__}:{str(args)}:{str(kwargs)}"

            # å°è¯•ä»ç¼“å­˜è·å–
            cached = redis_client.get(cache_key)
            if cached:
                return json.loads(cached)

            # æ‰§è¡Œå‡½æ•°
            result = await func(*args, **kwargs)

            # å­˜å…¥ç¼“å­˜
            redis_client.setex(
                cache_key,
                expire,
                json.dumps(result, default=str)
            )

            return result
        return wrapper
    return decorator

# ä½¿ç”¨ç¤ºä¾‹
@cache_result(expire=600)  # ç¼“å­˜10åˆ†é’Ÿ
async def get_user_statistics(user_id: str):
    # å¤æ‚çš„ç»Ÿè®¡æŸ¥è¯¢
    return db.query(...).all()
```

#### ä¼šå‘˜ä¿¡æ¯ç¼“å­˜
```python
async def get_user_membership_cached(user_id: str) -> dict:
    """è·å–ç”¨æˆ·ä¼šå‘˜ä¿¡æ¯ï¼ˆå¸¦ç¼“å­˜ï¼‰"""
    cache_key = f"user_membership:{user_id}"

    # å°è¯•ä»ç¼“å­˜è·å–
    cached = redis_client.get(cache_key)
    if cached:
        return json.loads(cached)

    # ä»æ•°æ®åº“æŸ¥è¯¢
    user = db.query(User).filter(User.id == user_id).first()
    membership_info = {
        "tier": user.membership_tier,
        "type": user.membership_type,
        "status": user.subscription_status,
        "limits": get_membership_limits(user.membership_tier)
    }

    # å­˜å…¥ç¼“å­˜ï¼ˆ1å°æ—¶ï¼‰
    redis_client.setex(cache_key, 3600, json.dumps(membership_info))

    return membership_info

async def invalidate_user_membership_cache(user_id: str):
    """æ¸…é™¤ç”¨æˆ·ä¼šå‘˜ä¿¡æ¯ç¼“å­˜"""
    cache_key = f"user_membership:{user_id}"
    redis_client.delete(cache_key)
```

### 3. å¼‚æ­¥ä»»åŠ¡å¤„ç†

#### Celeryé…ç½®
```python
from celery import Celery

celery_app = Celery(
    'weld_system',
    broker='redis://localhost:6379/0',
    backend='redis://localhost:6379/0'
)

celery_app.conf.update(
    task_serializer='json',
    accept_content=['json'],
    result_serializer='json',
    timezone='Asia/Shanghai',
    enable_utc=True,
    task_track_started=True,
    task_time_limit=30 * 60,  # 30åˆ†é’Ÿè¶…æ—¶
)

# å¼‚æ­¥ä»»åŠ¡ç¤ºä¾‹
@celery_app.task
def generate_report_async(user_id: str, report_type: str):
    """å¼‚æ­¥ç”ŸæˆæŠ¥è¡¨"""
    # å¤æ‚çš„æŠ¥è¡¨ç”Ÿæˆé€»è¾‘
    report_data = generate_complex_report(user_id, report_type)

    # ä¿å­˜æŠ¥è¡¨
    save_report_to_storage(report_data)

    # å‘é€é€šçŸ¥
    send_notification(user_id, "æŠ¥è¡¨ç”Ÿæˆå®Œæˆ")

    return {"status": "completed", "report_id": report_data.id}

# APIç«¯ç‚¹
@app.post("/api/v1/reports/generate")
async def request_report_generation(
    report_type: str,
    current_user: User = Depends(get_current_user)
):
    # æäº¤å¼‚æ­¥ä»»åŠ¡
    task = generate_report_async.delay(current_user.id, report_type)

    return {
        "task_id": task.id,
        "status": "processing",
        "message": "æŠ¥è¡¨æ­£åœ¨ç”Ÿæˆä¸­ï¼Œå®Œæˆåå°†é€šçŸ¥æ‚¨"
    }
```

### 4. å‰ç«¯æ€§èƒ½ä¼˜åŒ–

#### APIå“åº”å‹ç¼©
```python
from fastapi.middleware.gzip import GZipMiddleware

app.add_middleware(GZipMiddleware, minimum_size=1000)
```

#### åˆ†é¡µå’Œæ‡’åŠ è½½
```typescript
// React Queryå®ç°æ— é™æ»šåŠ¨
import { useInfiniteQuery } from '@tanstack/react-query';

function WPSList() {
  const {
    data,
    fetchNextPage,
    hasNextPage,
    isFetchingNextPage,
  } = useInfiniteQuery({
    queryKey: ['wps'],
    queryFn: ({ pageParam = 1 }) => fetchWPS(pageParam),
    getNextPageParam: (lastPage) => lastPage.nextPage,
  });

  return (
    <div>
      {data?.pages.map((page) =>
        page.items.map((wps) => <WPSCard key={wps.id} data={wps} />)
      )}
      {hasNextPage && (
        <button onClick={() => fetchNextPage()}>
          åŠ è½½æ›´å¤š
        </button>
      )}
    </div>
  );
}
```

### 5. é™æ€èµ„æºä¼˜åŒ–

#### CDNé…ç½®
```nginx
# Nginxé…ç½®
location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}

location /static/ {
    alias /var/www/static/;
    expires 1y;
    add_header Cache-Control "public, immutable";
}
```

## å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µ

### 1. ä»£ç é£æ ¼è§„èŒƒ

#### Pythonä»£ç è§„èŒƒï¼ˆPEP 8ï¼‰
```python
# ä½¿ç”¨Blackè¿›è¡Œä»£ç æ ¼å¼åŒ–
# pyproject.toml
[tool.black]
line-length = 100
target-version = ['py311']
include = '\.pyi?$'

# ä½¿ç”¨isortè¿›è¡Œå¯¼å…¥æ’åº
[tool.isort]
profile = "black"
line_length = 100
multi_line_output = 3

# ä½¿ç”¨flake8è¿›è¡Œä»£ç æ£€æŸ¥
[flake8]
max-line-length = 100
extend-ignore = E203, W503
exclude = .git,__pycache__,venv
```

#### TypeScriptä»£ç è§„èŒƒ
```json
// .eslintrc.json
{
  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:react/recommended",
    "plugin:react-hooks/recommended",
    "prettier"
  ],
  "rules": {
    "no-console": "warn",
    "@typescript-eslint/explicit-function-return-type": "off",
    "@typescript-eslint/no-explicit-any": "error",
    "react/react-in-jsx-scope": "off"
  }
}

// prettier.config.js
module.exports = {
  semi: true,
  trailingComma: 'es5',
  singleQuote: true,
  printWidth: 100,
  tabWidth: 2,
};
```

### 2. Gitå·¥ä½œæµè§„èŒƒ

#### åˆ†æ”¯ç®¡ç†ç­–ç•¥
```
main          - ç”Ÿäº§ç¯å¢ƒåˆ†æ”¯ï¼ˆå—ä¿æŠ¤ï¼‰
â”œâ”€â”€ develop   - å¼€å‘ç¯å¢ƒåˆ†æ”¯
â”‚   â”œâ”€â”€ feature/user-auth      - åŠŸèƒ½åˆ†æ”¯
â”‚   â”œâ”€â”€ feature/wps-management - åŠŸèƒ½åˆ†æ”¯
â”‚   â”œâ”€â”€ bugfix/login-error     - ä¿®å¤åˆ†æ”¯
â”‚   â””â”€â”€ hotfix/security-patch  - ç´§æ€¥ä¿®å¤åˆ†æ”¯
```

#### æäº¤ä¿¡æ¯è§„èŒƒ
```bash
# æäº¤ä¿¡æ¯æ ¼å¼
<type>(<scope>): <subject>

<body>

<footer>

# ç±»å‹è¯´æ˜
feat:     æ–°åŠŸèƒ½
fix:      ä¿®å¤bug
docs:     æ–‡æ¡£æ›´æ–°
style:    ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„ä»£ç 
test:     æµ‹è¯•ç›¸å…³
chore:    æ„å»º/å·¥å…·é“¾æ›´æ–°

# ç¤ºä¾‹
feat(auth): æ·»åŠ JWTè®¤è¯åŠŸèƒ½

- å®ç°ç”¨æˆ·ç™»å½•æ¥å£
- æ·»åŠ Tokenåˆ·æ–°æœºåˆ¶
- å¢åŠ ç™»å½•å¤±è´¥é™åˆ¶

Closes #123
```

#### Pre-commité’©å­
```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files

  - repo: https://github.com/psf/black
    rev: 23.3.0
    hooks:
      - id: black

  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort

  - repo: https://github.com/pycqa/flake8
    rev: 6.0.0
    hooks:
      - id: flake8
```

### 3. é¡¹ç›®ç»“æ„æœ€ä½³å®è·µ

#### åç«¯æ¨¡å—ç»„ç»‡
```python
# app/services/base_service.py
from typing import Generic, TypeVar, Type, Optional, List
from sqlalchemy.orm import Session
from app.models.base import Base

ModelType = TypeVar("ModelType", bound=Base)

class BaseService(Generic[ModelType]):
    """åŸºç¡€æœåŠ¡ç±»"""

    def __init__(self, model: Type[ModelType], db: Session):
        self.model = model
        self.db = db

    def get(self, id: str) -> Optional[ModelType]:
        """è·å–å•ä¸ªå¯¹è±¡"""
        return self.db.query(self.model).filter(self.model.id == id).first()

    def get_multi(self, skip: int = 0, limit: int = 100) -> List[ModelType]:
        """è·å–å¤šä¸ªå¯¹è±¡"""
        return self.db.query(self.model).offset(skip).limit(limit).all()

    def create(self, obj_in: dict) -> ModelType:
        """åˆ›å»ºå¯¹è±¡"""
        db_obj = self.model(**obj_in)
        self.db.add(db_obj)
        self.db.commit()
        self.db.refresh(db_obj)
        return db_obj

    def update(self, id: str, obj_in: dict) -> Optional[ModelType]:
        """æ›´æ–°å¯¹è±¡"""
        db_obj = self.get(id)
        if db_obj:
            for key, value in obj_in.items():
                setattr(db_obj, key, value)
            self.db.commit()
            self.db.refresh(db_obj)
        return db_obj

    def delete(self, id: str) -> bool:
        """åˆ é™¤å¯¹è±¡"""
        db_obj = self.get(id)
        if db_obj:
            self.db.delete(db_obj)
            self.db.commit()
            return True
        return False

# app/services/wps_service.py
from app.services.base_service import BaseService
from app.models.wps import WPSRecord

class WPSService(BaseService[WPSRecord]):
    """WPSæœåŠ¡ç±»"""

    def get_by_user(self, user_id: str, skip: int = 0, limit: int = 100):
        """è·å–ç”¨æˆ·çš„WPSè®°å½•"""
        return self.db.query(self.model)\
            .filter(self.model.user_id == user_id)\
            .offset(skip)\
            .limit(limit)\
            .all()

    def approve_wps(self, wps_id: str, approver_id: str):
        """å®¡æ‰¹WPS"""
        wps = self.get(wps_id)
        if wps:
            wps.status = 'approved'
            wps.approved_by = approver_id
            wps.approved_at = datetime.utcnow()
            self.db.commit()
            return wps
        return None
```

#### å‰ç«¯ç»„ä»¶ç»„ç»‡
```typescript
// src/components/WPS/WPSCard.tsx
import React from 'react';
import { Card, Tag, Button } from 'antd';
import { WPS } from '@/types/wps';

interface WPSCardProps {
  data: WPS;
  onEdit?: (id: string) => void;
  onDelete?: (id: string) => void;
}

export const WPSCard: React.FC<WPSCardProps> = ({ data, onEdit, onDelete }) => {
  return (
    <Card
      title={data.title}
      extra={<Tag color={getStatusColor(data.status)}>{data.status}</Tag>}
      actions={[
        <Button key="edit" onClick={() => onEdit?.(data.id)}>ç¼–è¾‘</Button>,
        <Button key="delete" danger onClick={() => onDelete?.(data.id)}>åˆ é™¤</Button>,
      ]}
    >
      <p>WPSç¼–å·: {data.wps_number}</p>
      <p>ç‰ˆæœ¬: {data.version}</p>
      <p>åŸºæ: {data.base_material}</p>
    </Card>
  );
};

// src/hooks/useWPS.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { wpsApi } from '@/services/wps';

export const useWPSList = (page: number = 1, pageSize: number = 20) => {
  return useQuery({
    queryKey: ['wps', page, pageSize],
    queryFn: () => wpsApi.getList(page, pageSize),
  });
};

export const useCreateWPS = () => {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: wpsApi.create,
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['wps'] });
    },
  });
};
```

### 4. é”™è¯¯å¤„ç†è§„èŒƒ

#### åç«¯é”™è¯¯å¤„ç†
```python
# app/core/exceptions.py
from fastapi import HTTPException, status

class WeldSystemException(Exception):
    """åŸºç¡€å¼‚å¸¸ç±»"""
    def __init__(self, message: str, status_code: int = 500):
        self.message = message
        self.status_code = status_code
        super().__init__(self.message)

class ResourceNotFoundException(WeldSystemException):
    """èµ„æºä¸å­˜åœ¨å¼‚å¸¸"""
    def __init__(self, resource_type: str, resource_id: str):
        message = f"{resource_type} with id {resource_id} not found"
        super().__init__(message, status_code=404)

class PermissionDeniedException(WeldSystemException):
    """æƒé™ä¸è¶³å¼‚å¸¸"""
    def __init__(self, message: str = "Permission denied"):
        super().__init__(message, status_code=403)

class MembershipLimitException(WeldSystemException):
    """ä¼šå‘˜é™åˆ¶å¼‚å¸¸"""
    def __init__(self, resource_type: str, limit: int):
        message = f"Membership limit reached for {resource_type} (max: {limit})"
        super().__init__(message, status_code=403)

# å…¨å±€å¼‚å¸¸å¤„ç†å™¨
from fastapi import Request
from fastapi.responses import JSONResponse

@app.exception_handler(WeldSystemException)
async def weld_system_exception_handler(request: Request, exc: WeldSystemException):
    return JSONResponse(
        status_code=exc.status_code,
        content={
            "success": False,
            "error": {
                "code": exc.__class__.__name__,
                "message": exc.message
            }
        }
    )
```

#### å‰ç«¯é”™è¯¯å¤„ç†
```typescript
// src/utils/errorHandler.ts
import { message } from 'antd';
import { AxiosError } from 'axios';

export interface APIError {
  code: string;
  message: string;
  details?: Record<string, string[]>;
}

export const handleAPIError = (error: unknown) => {
  if (error instanceof AxiosError) {
    const apiError = error.response?.data?.error as APIError;

    if (apiError) {
      // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
      message.error(apiError.message);

      // å¤„ç†éªŒè¯é”™è¯¯
      if (apiError.details) {
        return apiError.details;
      }
    } else {
      message.error('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
    }
  } else {
    message.error('æœªçŸ¥é”™è¯¯');
  }

  return null;
};

// ä½¿ç”¨ç¤ºä¾‹
const handleSubmit = async (values: WPSFormData) => {
  try {
    await createWPS(values);
    message.success('åˆ›å»ºæˆåŠŸ');
  } catch (error) {
    const validationErrors = handleAPIError(error);
    if (validationErrors) {
      form.setFields(
        Object.entries(validationErrors).map(([name, errors]) => ({
          name,
          errors,
        }))
      );
    }
  }
};
```

---

## æµ‹è¯•ç­–ç•¥

### 1. åç«¯æµ‹è¯•

#### å•å…ƒæµ‹è¯•
```python
# tests/test_services/test_wps_service.py
import pytest
from app.services.wps_service import WPSService
from app.models.wps import WPSRecord

@pytest.fixture
def wps_service(db_session):
    return WPSService(WPSRecord, db_session)

@pytest.fixture
def sample_wps_data():
    return {
        "wps_number": "WPS-001",
        "title": "Test WPS",
        "base_material": "Q235",
        "welding_process": "SMAW",
        "user_id": "test-user-id"
    }

def test_create_wps(wps_service, sample_wps_data):
    """æµ‹è¯•åˆ›å»ºWPS"""
    wps = wps_service.create(sample_wps_data)

    assert wps.id is not None
    assert wps.wps_number == "WPS-001"
    assert wps.title == "Test WPS"

def test_get_wps(wps_service, sample_wps_data):
    """æµ‹è¯•è·å–WPS"""
    created_wps = wps_service.create(sample_wps_data)
    retrieved_wps = wps_service.get(created_wps.id)

    assert retrieved_wps is not None
    assert retrieved_wps.id == created_wps.id

def test_update_wps(wps_service, sample_wps_data):
    """æµ‹è¯•æ›´æ–°WPS"""
    wps = wps_service.create(sample_wps_data)
    updated_wps = wps_service.update(wps.id, {"title": "Updated Title"})

    assert updated_wps.title == "Updated Title"

def test_delete_wps(wps_service, sample_wps_data):
    """æµ‹è¯•åˆ é™¤WPS"""
    wps = wps_service.create(sample_wps_data)
    result = wps_service.delete(wps.id)

    assert result is True
    assert wps_service.get(wps.id) is None
```

#### APIæµ‹è¯•
```python
# tests/test_api/test_wps_api.py
from fastapi.testclient import TestClient
from app.main import app

client = TestClient(app)

def test_create_wps_api(auth_headers):
    """æµ‹è¯•åˆ›å»ºWPS API"""
    response = client.post(
        "/api/v1/wps",
        json={
            "wps_number": "WPS-001",
            "title": "Test WPS",
            "base_material": "Q235"
        },
        headers=auth_headers
    )

    assert response.status_code == 201
    data = response.json()
    assert data["success"] is True
    assert data["data"]["wps_number"] == "WPS-001"

def test_get_wps_list_api(auth_headers):
    """æµ‹è¯•è·å–WPSåˆ—è¡¨API"""
    response = client.get("/api/v1/wps", headers=auth_headers)

    assert response.status_code == 200
    data = response.json()
    assert "items" in data["data"]
    assert "total" in data["data"]

def test_unauthorized_access():
    """æµ‹è¯•æœªæˆæƒè®¿é—®"""
    response = client.get("/api/v1/wps")
    assert response.status_code == 401
```

#### é›†æˆæµ‹è¯•
```python
# tests/test_integration/test_wps_workflow.py
def test_complete_wps_workflow(client, db_session):
    """æµ‹è¯•å®Œæ•´çš„WPSå·¥ä½œæµ"""
    # 1. æ³¨å†Œç”¨æˆ·
    register_response = client.post("/api/v1/auth/register", json={
        "email": "test@example.com",
        "password": "Test123!@#",
        "username": "testuser"
    })
    assert register_response.status_code == 201

    # 2. ç™»å½•
    login_response = client.post("/api/v1/auth/login", json={
        "email": "test@example.com",
        "password": "Test123!@#"
    })
    assert login_response.status_code == 200
    token = login_response.json()["data"]["access_token"]
    headers = {"Authorization": f"Bearer {token}"}

    # 3. åˆ›å»ºWPS
    create_response = client.post("/api/v1/wps", json={
        "wps_number": "WPS-001",
        "title": "Test WPS"
    }, headers=headers)
    assert create_response.status_code == 201
    wps_id = create_response.json()["data"]["id"]

    # 4. è·å–WPS
    get_response = client.get(f"/api/v1/wps/{wps_id}", headers=headers)
    assert get_response.status_code == 200

    # 5. æ›´æ–°WPS
    update_response = client.put(f"/api/v1/wps/{wps_id}", json={
        "title": "Updated WPS"
    }, headers=headers)
    assert update_response.status_code == 200

    # 6. åˆ é™¤WPS
    delete_response = client.delete(f"/api/v1/wps/{wps_id}", headers=headers)
    assert delete_response.status_code == 204
```

### 2. å‰ç«¯æµ‹è¯•

#### ç»„ä»¶æµ‹è¯•
```typescript
// src/components/WPS/__tests__/WPSCard.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { WPSCard } from '../WPSCard';

const mockWPS = {
  id: '1',
  wps_number: 'WPS-001',
  title: 'Test WPS',
  version: '1.0',
  status: 'draft',
  base_material: 'Q235',
};

describe('WPSCard', () => {
  it('renders WPS information correctly', () => {
    render(<WPSCard data={mockWPS} />);

    expect(screen.getByText('Test WPS')).toBeInTheDocument();
    expect(screen.getByText('WPSç¼–å·: WPS-001')).toBeInTheDocument();
    expect(screen.getByText('ç‰ˆæœ¬: 1.0')).toBeInTheDocument();
  });

  it('calls onEdit when edit button is clicked', () => {
    const onEdit = jest.fn();
    render(<WPSCard data={mockWPS} onEdit={onEdit} />);

    fireEvent.click(screen.getByText('ç¼–è¾‘'));
    expect(onEdit).toHaveBeenCalledWith('1');
  });

  it('calls onDelete when delete button is clicked', () => {
    const onDelete = jest.fn();
    render(<WPSCard data={mockWPS} onDelete={onDelete} />);

    fireEvent.click(screen.getByText('åˆ é™¤'));
    expect(onDelete).toHaveBeenCalledWith('1');
  });
});
```

#### Hookæµ‹è¯•
```typescript
// src/hooks/__tests__/useWPS.test.ts
import { renderHook, waitFor } from '@testing-library/react';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { useWPSList } from '../useWPS';

const createWrapper = () => {
  const queryClient = new QueryClient({
    defaultOptions: {
      queries: { retry: false },
    },
  });

  return ({ children }: { children: React.ReactNode }) => (
    <QueryClientProvider client={queryClient}>
      {children}
    </QueryClientProvider>
  );
};

describe('useWPSList', () => {
  it('fetches WPS list successfully', async () => {
    const { result } = renderHook(() => useWPSList(), {
      wrapper: createWrapper(),
    });

    await waitFor(() => expect(result.current.isSuccess).toBe(true));

    expect(result.current.data).toBeDefined();
    expect(result.current.data?.items).toBeInstanceOf(Array);
  });
});
```

### 3. æµ‹è¯•è¦†ç›–ç‡

```bash
# åç«¯æµ‹è¯•è¦†ç›–ç‡
pytest --cov=app --cov-report=html --cov-report=term

# å‰ç«¯æµ‹è¯•è¦†ç›–ç‡
npm run test -- --coverage

# è¦†ç›–ç‡ç›®æ ‡
# - å•å…ƒæµ‹è¯•è¦†ç›–ç‡: >= 80%
# - é›†æˆæµ‹è¯•è¦†ç›–ç‡: >= 60%
# - å…³é”®ä¸šåŠ¡é€»è¾‘: >= 90%
```

## éƒ¨ç½²æµç¨‹

### 1. å¼€å‘ç¯å¢ƒéƒ¨ç½²

#### æœ¬åœ°å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/weld-system.git
cd weld-system

# 2. å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
cp .env.example .env

# 3. å¯åŠ¨DockeræœåŠ¡
docker-compose -f docker-compose.dev.yml up -d

# 4. åˆå§‹åŒ–æ•°æ®åº“
docker-compose exec backend alembic upgrade head

# 5. åˆ›å»ºç®¡ç†å‘˜è´¦å·
docker-compose exec backend python scripts/create_admin.py

# 6. è®¿é—®åº”ç”¨
# ç”¨æˆ·é—¨æˆ·: http://localhost:3000
# ç®¡ç†å‘˜é—¨æˆ·: http://localhost:3001
# APIæ–‡æ¡£: http://localhost:8000/docs
```

#### å¼€å‘ç¯å¢ƒDockeré…ç½®
```yaml
# docker-compose.dev.yml
version: '3.8'

services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile.dev
    volumes:
      - ./backend:/app
    environment:
      - DEBUG=True
      - RELOAD=True
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile.dev
    volumes:
      - ./frontend:/app
      - /app/node_modules
    command: npm run dev

  admin-frontend:
    build:
      context: ./admin-frontend
      dockerfile: Dockerfile.dev
    volumes:
      - ./admin-frontend:/app
      - /app/node_modules
    command: npm run dev
```

### 2. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### æœåŠ¡å™¨è¦æ±‚
```
æœ€ä½é…ç½®:
- CPU: 2æ ¸
- å†…å­˜: 4GB
- ç¡¬ç›˜: 50GB SSD
- å¸¦å®½: 5Mbps

æ¨èé…ç½®:
- CPU: 4æ ¸
- å†…å­˜: 8GB
- ç¡¬ç›˜: 100GB SSD
- å¸¦å®½: 10Mbps

æ“ä½œç³»ç»Ÿ: Ubuntu 22.04 LTS
```

#### éƒ¨ç½²æ­¥éª¤

**1. æœåŠ¡å™¨åˆå§‹åŒ–**
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# å®‰è£…Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# å®‰è£…Nginx
sudo apt install nginx -y

# å®‰è£…SSLè¯ä¹¦å·¥å…·
sudo apt install certbot python3-certbot-nginx -y
```

**2. é…ç½®SSLè¯ä¹¦**
```bash
# è·å–SSLè¯ä¹¦
sudo certbot --nginx -d yourdomain.com -d admin.yourdomain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

**3. Nginxé…ç½®**
```nginx
# /etc/nginx/sites-available/weld-system
# ç”¨æˆ·é—¨æˆ·
server {
    listen 80;
    server_name yourdomain.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name yourdomain.com;

    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;

    # SSLé…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    # å‰ç«¯
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }

    # API
    location /api/ {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # WebSocket
    location /ws/ {
        proxy_pass http://localhost:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    # é™æ€æ–‡ä»¶
    location /static/ {
        alias /var/www/weld-system/static/;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}

# ç®¡ç†å‘˜é—¨æˆ·
server {
    listen 443 ssl http2;
    server_name admin.yourdomain.com;

    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;

    location / {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

**4. éƒ¨ç½²åº”ç”¨**
```bash
# å…‹éš†ä»£ç 
git clone https://github.com/yourusername/weld-system.git
cd weld-system

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
nano .env  # ç¼–è¾‘ç”Ÿäº§ç¯å¢ƒé…ç½®

# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# åˆå§‹åŒ–æ•°æ®åº“
docker-compose exec backend alembic upgrade head

# åˆ›å»ºç®¡ç†å‘˜
docker-compose exec backend python scripts/create_admin.py

# é‡å¯Nginx
sudo systemctl restart nginx
```

**5. éƒ¨ç½²è„šæœ¬**
```bash
#!/bin/bash
# scripts/deploy.sh

set -e

echo "å¼€å§‹éƒ¨ç½²..."

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# å¤‡ä»½æ•°æ®åº“
docker-compose exec -T db pg_dump -U weld_user weld_db > backup_$(date +%Y%m%d_%H%M%S).sql

# åœæ­¢æœåŠ¡
docker-compose down

# æ„å»ºæ–°é•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# è¿è¡Œæ•°æ®åº“è¿ç§»
docker-compose exec -T backend alembic upgrade head

# æ¸…ç†æ—§é•œåƒ
docker image prune -f

echo "éƒ¨ç½²å®Œæˆï¼"
```

### 3. CI/CDé…ç½®

#### GitHub Actions
```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          cd backend
          pip install -r requirements.txt

      - name: Run tests
        run: |
          cd backend
          pytest --cov=app

      - name: Run linting
        run: |
          cd backend
          flake8 app

  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'

    steps:
      - name: Deploy to server
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            cd /opt/weld-system
            ./scripts/deploy.sh
```

### 4. æ•°æ®åº“å¤‡ä»½ç­–ç•¥

```bash
#!/bin/bash
# scripts/backup.sh

BACKUP_DIR="/var/backups/weld-system"
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="$BACKUP_DIR/backup_$DATE.sql"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®åº“
docker-compose exec -T db pg_dump -U weld_user weld_db > $BACKUP_FILE

# å‹ç¼©å¤‡ä»½
gzip $BACKUP_FILE

# åˆ é™¤30å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "backup_*.sql.gz" -mtime +30 -delete

echo "å¤‡ä»½å®Œæˆ: $BACKUP_FILE.gz"

# ä¸Šä¼ åˆ°äº‘å­˜å‚¨ï¼ˆå¯é€‰ï¼‰
# aws s3 cp $BACKUP_FILE.gz s3://your-bucket/backups/
```

**è®¾ç½®å®šæ—¶å¤‡ä»½**
```bash
# æ·»åŠ åˆ°crontab
crontab -e

# æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½
0 2 * * * /opt/weld-system/scripts/backup.sh
```

---

## ç›‘æ§å’Œæ—¥å¿—

### 1. åº”ç”¨ç›‘æ§

#### Prometheusé…ç½®
```yaml
# config/monitoring/prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'weld-system-backend'
    static_configs:
      - targets: ['backend:8000']

  - job_name: 'postgres'
    static_configs:
      - targets: ['db:5432']

  - job_name: 'redis'
    static_configs:
      - targets: ['redis:6379']
```

#### åº”ç”¨æŒ‡æ ‡æ”¶é›†
```python
# app/core/metrics.py
from prometheus_client import Counter, Histogram, Gauge
import time

# è¯·æ±‚è®¡æ•°å™¨
request_count = Counter(
    'http_requests_total',
    'Total HTTP requests',
    ['method', 'endpoint', 'status']
)

# è¯·æ±‚å»¶è¿Ÿ
request_latency = Histogram(
    'http_request_duration_seconds',
    'HTTP request latency',
    ['method', 'endpoint']
)

# æ´»è·ƒç”¨æˆ·æ•°
active_users = Gauge(
    'active_users_total',
    'Number of active users'
)

# ä¸­é—´ä»¶
from fastapi import Request
import time

@app.middleware("http")
async def metrics_middleware(request: Request, call_next):
    start_time = time.time()

    response = await call_next(request)

    # è®°å½•æŒ‡æ ‡
    duration = time.time() - start_time
    request_count.labels(
        method=request.method,
        endpoint=request.url.path,
        status=response.status_code
    ).inc()

    request_latency.labels(
        method=request.method,
        endpoint=request.url.path
    ).observe(duration)

    return response
```

### 2. æ—¥å¿—ç®¡ç†

#### æ—¥å¿—é…ç½®
```python
# app/core/logging.py
import logging
from logging.handlers import RotatingFileHandler
import json
from datetime import datetime

class JSONFormatter(logging.Formatter):
    """JSONæ ¼å¼æ—¥å¿—"""
    def format(self, record):
        log_data = {
            "timestamp": datetime.utcnow().isoformat(),
            "level": record.levelname,
            "logger": record.name,
            "message": record.getMessage(),
            "module": record.module,
            "function": record.funcName,
            "line": record.lineno
        }

        if record.exc_info:
            log_data["exception"] = self.formatException(record.exc_info)

        return json.dumps(log_data)

# é…ç½®æ—¥å¿—
def setup_logging():
    logger = logging.getLogger("weld_system")
    logger.setLevel(logging.INFO)

    # æ–‡ä»¶å¤„ç†å™¨
    file_handler = RotatingFileHandler(
        "logs/app.log",
        maxBytes=10485760,  # 10MB
        backupCount=10
    )
    file_handler.setFormatter(JSONFormatter())

    # æ§åˆ¶å°å¤„ç†å™¨
    console_handler = logging.StreamHandler()
    console_handler.setFormatter(logging.Formatter(
        '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    ))

    logger.addHandler(file_handler)
    logger.addHandler(console_handler)

    return logger

logger = setup_logging()
```

#### æ—¥å¿—ä½¿ç”¨ç¤ºä¾‹
```python
from app.core.logging import logger

@app.post("/api/v1/wps")
async def create_wps(data: WPSCreate, current_user: User = Depends(get_current_user)):
    logger.info(
        f"User {current_user.id} creating WPS",
        extra={
            "user_id": current_user.id,
            "wps_number": data.wps_number,
            "action": "create_wps"
        }
    )

    try:
        wps = wps_service.create(data.dict())
        logger.info(f"WPS {wps.id} created successfully")
        return wps
    except Exception as e:
        logger.error(
            f"Failed to create WPS: {str(e)}",
            exc_info=True,
            extra={"user_id": current_user.id}
        )
        raise
```

### 3. é”™è¯¯è¿½è¸ª

#### Sentryé›†æˆ
```python
# app/core/sentry.py
import sentry_sdk
from sentry_sdk.integrations.fastapi import FastApiIntegration
from sentry_sdk.integrations.sqlalchemy import SqlalchemyIntegration

def init_sentry():
    sentry_sdk.init(
        dsn="your-sentry-dsn",
        integrations=[
            FastApiIntegration(),
            SqlalchemyIntegration(),
        ],
        traces_sample_rate=0.1,
        environment="production",
        release="weld-system@1.0.0"
    )

# åœ¨main.pyä¸­åˆå§‹åŒ–
from app.core.sentry import init_sentry

if not DEBUG:
    init_sentry()
```

### 4. æ€§èƒ½ç›‘æ§

#### æ…¢æŸ¥è¯¢ç›‘æ§
```python
# app/core/database.py
from sqlalchemy import event
from sqlalchemy.engine import Engine
import time
import logging

logger = logging.getLogger("sqlalchemy.performance")

@event.listens_for(Engine, "before_cursor_execute")
def before_cursor_execute(conn, cursor, statement, parameters, context, executemany):
    conn.info.setdefault('query_start_time', []).append(time.time())

@event.listens_for(Engine, "after_cursor_execute")
def after_cursor_execute(conn, cursor, statement, parameters, context, executemany):
    total = time.time() - conn.info['query_start_time'].pop(-1)

    # è®°å½•æ…¢æŸ¥è¯¢ï¼ˆè¶…è¿‡1ç§’ï¼‰
    if total > 1.0:
        logger.warning(
            f"Slow query detected: {total:.2f}s",
            extra={
                "query": statement,
                "duration": total
            }
        )
```

---

## å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 1. æ•°æ®åº“ç›¸å…³

**é—®é¢˜: æ•°æ®åº“è¿æ¥æ± è€—å°½**
```
sqlalchemy.exc.TimeoutError: QueuePool limit of size 20 overflow 10 reached
```

è§£å†³æ–¹æ¡ˆ:
```python
# å¢åŠ è¿æ¥æ± å¤§å°
engine = create_engine(
    DATABASE_URL,
    pool_size=30,
    max_overflow=20
)

# ç¡®ä¿æ­£ç¡®å…³é—­è¿æ¥
@app.middleware("http")
async def db_session_middleware(request: Request, call_next):
    response = Response("Internal server error", status_code=500)
    try:
        request.state.db = SessionLocal()
        response = await call_next(request)
    finally:
        request.state.db.close()
    return response
```

**é—®é¢˜: æ•°æ®åº“è¿ç§»å†²çª**
```
alembic.util.exc.CommandError: Multiple head revisions are present
```

è§£å†³æ–¹æ¡ˆ:
```bash
# åˆå¹¶è¿ç§»åˆ†æ”¯
alembic merge heads -m "merge migrations"

# åº”ç”¨è¿ç§»
alembic upgrade head
```

### 2. æ€§èƒ½é—®é¢˜

**é—®é¢˜: APIå“åº”ç¼“æ…¢**

æ’æŸ¥æ­¥éª¤:
```bash
# 1. æ£€æŸ¥æ•°æ®åº“æ…¢æŸ¥è¯¢
docker-compose exec db psql -U weld_user -d weld_db -c "
SELECT query, calls, total_time, mean_time
FROM pg_stat_statements
ORDER BY mean_time DESC
LIMIT 10;"

# 2. æ£€æŸ¥Redisè¿æ¥
docker-compose exec redis redis-cli ping

# 3. æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs -f backend | grep "Slow query"

# 4. æ£€æŸ¥ç³»ç»Ÿèµ„æº
docker stats
```

è§£å†³æ–¹æ¡ˆ:
- æ·»åŠ æ•°æ®åº“ç´¢å¼•
- ä½¿ç”¨ç¼“å­˜
- ä¼˜åŒ–æŸ¥è¯¢ï¼ˆä½¿ç”¨é¢„åŠ è½½ï¼‰
- å¢åŠ æœåŠ¡å™¨èµ„æº

### 3. éƒ¨ç½²é—®é¢˜

**é—®é¢˜: Dockerå®¹å™¨æ— æ³•å¯åŠ¨**
```
Error: Cannot start service backend: driver failed programming external connectivity
```

è§£å†³æ–¹æ¡ˆ:
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
sudo lsof -i :8000

# åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
sudo kill -9 <PID>

# æˆ–ä¿®æ”¹docker-compose.ymlä¸­çš„ç«¯å£æ˜ å°„
ports:
  - "8001:8000"  # ä½¿ç”¨ä¸åŒçš„ä¸»æœºç«¯å£
```

**é—®é¢˜: SSLè¯ä¹¦è¿‡æœŸ**

è§£å†³æ–¹æ¡ˆ:
```bash
# æ‰‹åŠ¨ç»­æœŸ
sudo certbot renew

# é‡å¯Nginx
sudo systemctl restart nginx

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ
sudo crontab -e
# æ·»åŠ : 0 0 1 * * certbot renew --quiet
```

### 4. ä¼šå‘˜ç³»ç»Ÿé—®é¢˜

**é—®é¢˜: ä¼šå‘˜é™åˆ¶æ£€æŸ¥å¤±è´¥**

è§£å†³æ–¹æ¡ˆ:
```python
async def check_membership_limit(
    user_id: str,
    resource_type: str,
    db: Session
) -> bool:
    """æ£€æŸ¥ä¼šå‘˜é™åˆ¶"""
    # è·å–ç”¨æˆ·ä¼šå‘˜ä¿¡æ¯ï¼ˆå¸¦ç¼“å­˜ï¼‰
    membership = await get_user_membership_cached(user_id)

    # è·å–é™åˆ¶
    limits = MEMBERSHIP_LIMITS[membership['tier']]
    max_count = limits.get(resource_type, 0)

    # æŸ¥è¯¢å½“å‰æ•°é‡
    if resource_type == 'wps':
        current_count = db.query(WPSRecord).filter(
            WPSRecord.user_id == user_id
        ).count()

    if current_count >= max_count:
        raise MembershipLimitException(resource_type, max_count)

    return True
```

### 5. å‰ç«¯é—®é¢˜

**é—®é¢˜: Tokenè¿‡æœŸå¯¼è‡´è¯·æ±‚å¤±è´¥**

è§£å†³æ–¹æ¡ˆ:
```typescript
// src/utils/axios.ts
import axios from 'axios';
import { refreshToken } from '@/services/auth';

const api = axios.create({
  baseURL: '/api/v1',
});

// è¯·æ±‚æ‹¦æˆªå™¨
api.interceptors.request.use((config) => {
  const token = localStorage.getItem('access_token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// å“åº”æ‹¦æˆªå™¨
api.interceptors.response.use(
  (response) => response,
  async (error) => {
    const originalRequest = error.config;

    // Tokenè¿‡æœŸ
    if (error.response?.status === 401 && !originalRequest._retry) {
      originalRequest._retry = true;

      try {
        const newToken = await refreshToken();
        localStorage.setItem('access_token', newToken);
        originalRequest.headers.Authorization = `Bearer ${newToken}`;
        return api(originalRequest);
      } catch (refreshError) {
        // åˆ·æ–°å¤±è´¥ï¼Œè·³è½¬åˆ°ç™»å½•é¡µ
        window.location.href = '/login';
        return Promise.reject(refreshError);
      }
    }

    return Promise.reject(error);
  }
);
```

---

## å¼€å‘è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µ - MVP (1-2ä¸ªæœˆ)
- [x] é¡¹ç›®æ¶æ„è®¾è®¡
- [ ] ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [ ] åŸºç¡€ä¼šå‘˜ä½“ç³»
- [ ] WPS/PQRåŸºç¡€åŠŸèƒ½
- [ ] ç”¨æˆ·é—¨æˆ·å‰ç«¯
- [ ] åŸºç¡€APIå¼€å‘

### ç¬¬äºŒé˜¶æ®µ - æ ¸å¿ƒåŠŸèƒ½ (2-3ä¸ªæœˆ)
- [ ] ä¼ä¸šä¼šå‘˜åŠŸèƒ½
- [ ] å‘˜å·¥ç®¡ç†ç³»ç»Ÿ
- [ ] ç„Šæç®¡ç†
- [ ] ç„Šå·¥ç®¡ç†
- [ ] æ”¯ä»˜é›†æˆ
- [ ] ç®¡ç†å‘˜é—¨æˆ·

### ç¬¬ä¸‰é˜¶æ®µ - æ‰©å±•åŠŸèƒ½ (3-4ä¸ªæœˆ)
- [ ] è®¾å¤‡ç®¡ç†
- [ ] ç”Ÿäº§ç®¡ç†
- [ ] è´¨é‡ç®¡ç†
- [ ] æŠ¥è¡¨ç»Ÿè®¡
- [ ] æ•°æ®å¯¼å‡ºåŠŸèƒ½
- [ ] ç§»åŠ¨ç«¯é€‚é…

### ç¬¬å››é˜¶æ®µ - é«˜çº§åŠŸèƒ½ (åæœŸ)
- [ ] ç¡¬ä»¶è®¾å¤‡é›†æˆ
- [ ] å®æ—¶å‚æ•°ç›‘æ§
- [ ] å›¾çº¸è‡ªåŠ¨ç”Ÿæˆ
- [ ] AIæ™ºèƒ½æ¨è
- [ ] é«˜çº§æ•°æ®åˆ†æ

---

## é™„å½•

### A. ä¼šå‘˜ç­‰çº§é™åˆ¶é…ç½®

```python
# app/core/membership.py
MEMBERSHIP_LIMITS = {
    "free": {
        "wps": 10,
        "pqr": 10,
        "ppqr": 0,
        "materials": 0,
        "welders": 0,
        "equipment": 0,
        "storage_mb": 100,
    },
    "pro": {
        "wps": 30,
        "pqr": 30,
        "ppqr": 30,
        "materials": 50,
        "welders": 20,
        "equipment": 0,
        "storage_mb": 500,
    },
    "advanced": {
        "wps": 50,
        "pqr": 50,
        "ppqr": 50,
        "materials": 100,
        "welders": 50,
        "equipment": 20,
        "storage_mb": 1024,
    },
    "flagship": {
        "wps": 100,
        "pqr": 100,
        "ppqr": 100,
        "materials": 200,
        "welders": 100,
        "equipment": 50,
        "storage_mb": 2048,
    },
    "enterprise": {
        "wps": 200,
        "pqr": 200,
        "ppqr": 200,
        "materials": 500,
        "welders": 200,
        "equipment": 100,
        "storage_mb": 5120,
        "factories": 1,
        "employees": 10,
    },
    "enterprise_pro": {
        "wps": 200,
        "pqr": 200,
        "ppqr": 200,
        "materials": 1000,
        "welders": 500,
        "equipment": 200,
        "storage_mb": 10240,
        "factories": 3,
        "employees": 20,
    },
    "enterprise_pro_max": {
        "wps": 200,
        "pqr": 200,
        "ppqr": 200,
        "materials": -1,  # æ— é™åˆ¶
        "welders": -1,
        "equipment": -1,
        "storage_mb": 20480,
        "factories": 5,
        "employees": 50,
    },
}
```

### B. APIé”™è¯¯ç å‚è€ƒ

```python
ERROR_CODES = {
    # è®¤è¯ç›¸å…³ (1xxx)
    "AUTH_001": "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯",
    "AUTH_002": "Tokenå·²è¿‡æœŸ",
    "AUTH_003": "Tokenæ— æ•ˆ",
    "AUTH_004": "é‚®ç®±æœªéªŒè¯",
    "AUTH_005": "è´¦å·å·²è¢«ç¦ç”¨",

    # æƒé™ç›¸å…³ (2xxx)
    "PERM_001": "æƒé™ä¸è¶³",
    "PERM_002": "éœ€è¦æ›´é«˜çš„ä¼šå‘˜ç­‰çº§",
    "PERM_003": "èµ„æºè®¿é—®è¢«æ‹’ç»",

    # èµ„æºç›¸å…³ (3xxx)
    "RES_001": "èµ„æºä¸å­˜åœ¨",
    "RES_002": "èµ„æºå·²å­˜åœ¨",
    "RES_003": "èµ„æºå·²è¢«åˆ é™¤",

    # ä¼šå‘˜ç›¸å…³ (4xxx)
    "MEM_001": "å·²è¾¾åˆ°ä¼šå‘˜é™åˆ¶",
    "MEM_002": "è®¢é˜…å·²è¿‡æœŸ",
    "MEM_003": "æ”¯ä»˜å¤±è´¥",

    # éªŒè¯ç›¸å…³ (5xxx)
    "VAL_001": "å‚æ•°éªŒè¯å¤±è´¥",
    "VAL_002": "æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ",
    "VAL_003": "æ–‡ä»¶å¤§å°è¶…é™",
}
```

### C. ç¯å¢ƒå˜é‡å®Œæ•´åˆ—è¡¨

```env
# åº”ç”¨é…ç½®
APP_NAME=ç„Šæ¥å·¥è‰ºç®¡ç†ç³»ç»Ÿ
APP_VERSION=1.0.0
DEBUG=False
SECRET_KEY=your-secret-key-here
ALLOWED_HOSTS=yourdomain.com,admin.yourdomain.com

# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://weld_user:weld_pass@db:5432/weld_db
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10

# Redisé…ç½®
REDIS_URL=redis://redis:6379/0
REDIS_PASSWORD=

# JWTé…ç½®
JWT_SECRET_KEY=your-jwt-secret
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# é‚®ä»¶é…ç½®
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@yourdomain.com

# æ”¯ä»˜é…ç½®
STRIPE_SECRET_KEY=sk_live_...
STRIPE_PUBLISHABLE_KEY=pk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...

# æ–‡ä»¶å­˜å‚¨
UPLOAD_DIR=/var/www/uploads
MAX_FILE_SIZE=10485760
ALLOWED_EXTENSIONS=.pdf,.jpg,.jpeg,.png,.doc,.docx

# ç›‘æ§é…ç½®
SENTRY_DSN=https://...@sentry.io/...
PROMETHEUS_ENABLED=True

# æ—¥å¿—é…ç½®
LOG_LEVEL=INFO
LOG_FILE=/var/log/weld-system/app.log
```

---

*æ–‡æ¡£æœ€åæ›´æ–°: 2025-10-15*
*ç‰ˆæœ¬: 2.0*
*ç»´æŠ¤è€…: å¼€å‘å›¢é˜Ÿ*