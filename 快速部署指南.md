# ğŸš€ å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## âœ… å·²å®Œæˆçš„å‡†å¤‡å·¥ä½œ

æ­å–œï¼ä»¥ä¸‹é…ç½®å·²ç»å…¨éƒ¨å®Œæˆï¼š

- âœ… **QQ é‚®ç®±æˆæƒç **: å·²é…ç½®
- âœ… **ç¯å¢ƒå˜é‡**: `backend/.env.production` å·²é…ç½®å®Œæˆ
- âœ… **ç®¡ç†å‘˜è´¦å·**: å·²è®¾ç½®
- âœ… **åŸŸåè§„åˆ’**: sdhaohan.cn, laimiu.sdhaohan.cn, api.sdhaohan.cn
- âœ… **Docker é…ç½®**: æ‰€æœ‰ Dockerfile å’Œ docker-compose.yml å·²å°±ç»ª
- âœ… **Nginx é…ç½®**: åå‘ä»£ç†å’Œ SSL é…ç½®å·²å®Œæˆ
- âœ… **éƒ¨ç½²è„šæœ¬**: deploy.sh å·²å‡†å¤‡å¥½

---

## ğŸ¯ ç°åœ¨åªéœ€è¦ 3 æ­¥ï¼

### ç¬¬ 1 æ­¥ï¼šé…ç½® DNS è§£æ (5åˆ†é’Ÿ)

ç™»å½•è…¾è®¯äº‘ DNS æ§åˆ¶å°ï¼Œæ·»åŠ ä»¥ä¸‹ A è®°å½•ï¼š

| ä¸»æœºè®°å½• | è®°å½•ç±»å‹ | è®°å½•å€¼ | TTL |
|---------|---------|--------|-----|
| @ | A | 43.142.188.252 | 600 |
| laimiu | A | 43.142.188.252 | 600 |
| api | A | 43.142.188.252 | 600 |

**éªŒè¯ DNS è§£æ**ï¼š
```bash
ping sdhaohan.cn
ping laimiu.sdhaohan.cn
ping api.sdhaohan.cn
```

æ‰€æœ‰åŸŸåéƒ½åº”è¯¥è¿”å› `43.142.188.252`

â° **ç­‰å¾…æ—¶é—´**: DNS è§£æé€šå¸¸éœ€è¦ 5-10 åˆ†é’Ÿç”Ÿæ•ˆ

---

### ç¬¬ 2 æ­¥ï¼šä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨ (2åˆ†é’Ÿ)

#### æ–¹å¼ A: ä½¿ç”¨ Gitï¼ˆæ¨èï¼‰

```bash
# 1. åœ¨æœ¬åœ°æäº¤ä»£ç 
git add .
git commit -m "Ready for deployment"
git push

# 2. SSH ç™»å½•æœåŠ¡å™¨
ssh root@43.142.188.252

# 3. å…‹éš†ä»£ç 
git clone <ä½ çš„ä»“åº“åœ°å€>
cd <é¡¹ç›®ç›®å½•>
```

#### æ–¹å¼ B: ä½¿ç”¨ SCP ä¸Šä¼ 

```bash
# åœ¨æœ¬åœ°ç”µè„‘æ‰§è¡Œï¼ˆPowerShellï¼‰
scp -r .\ root@43.142.188.252:/root/welding-system/
```

---

### ç¬¬ 3 æ­¥ï¼šè¿è¡Œéƒ¨ç½²è„šæœ¬ (10åˆ†é’Ÿ)

```bash
# 1. SSH ç™»å½•æœåŠ¡å™¨ï¼ˆå¦‚æœè¿˜æ²¡ç™»å½•ï¼‰
ssh root@43.142.188.252

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
cd /root/welding-system  # æˆ–ä½ çš„é¡¹ç›®ç›®å½•

# 3. ç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™
chmod +x deploy.sh
chmod +x create_default_admin.sh

# 4. è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy.sh
```

**éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆ**ï¼š
- âœ… æ£€æŸ¥ç¯å¢ƒï¼ˆDocker, Docker Composeï¼‰
- âœ… æ„å»ºæ‰€æœ‰ Docker é•œåƒ
- âœ… å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆPostgreSQL, Redis, Backend, Frontend, Admin Portal, Nginxï¼‰
- âœ… è¿è¡Œæ•°æ®åº“è¿ç§»
- âœ… ç”³è¯· SSL è¯ä¹¦ï¼ˆLet's Encryptï¼‰
- âœ… é…ç½® Nginx åå‘ä»£ç†

**åˆ›å»ºç®¡ç†å‘˜è´¦å·**ï¼š

éƒ¨ç½²è„šæœ¬ä¼šè¯¢é—®æ˜¯å¦åˆ›å»ºç®¡ç†å‘˜è´¦å·ï¼Œé€‰æ‹© `y`ï¼Œç„¶åè¾“å…¥ï¼š
- é‚®ç®±: `Laimiu.new@gmail.com`
- å¯†ç : `ghzzz123`

æˆ–è€…ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼š
```bash
./create_default_admin.sh
```

---

## ğŸ‰ éƒ¨ç½²å®Œæˆï¼

éƒ¨ç½²æˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```
========================================
éƒ¨ç½²å®Œæˆï¼
========================================

ç”¨æˆ·é—¨æˆ·: https://sdhaohan.cn
ç®¡ç†é—¨æˆ·: https://laimiu.sdhaohan.cn
åç«¯API: https://api.sdhaohan.cn
APIæ–‡æ¡£: https://api.sdhaohan.cn/api/v1/docs
```

---

## âœ… éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
docker-compose ps
```

æ‰€æœ‰æœåŠ¡åº”è¯¥éƒ½æ˜¯ `Up` çŠ¶æ€ï¼š
```
NAME                STATUS
postgres            Up (healthy)
redis               Up (healthy)
backend             Up (healthy)
frontend            Up
admin-portal        Up
nginx               Up
certbot             Up
```

### 2. è®¿é—®ç½‘ç«™

#### ç”¨æˆ·é—¨æˆ·
æ‰“å¼€æµè§ˆå™¨è®¿é—®: https://sdhaohan.cn
- [ ] é¡µé¢æ­£å¸¸åŠ è½½
- [ ] HTTPS è¯ä¹¦æœ‰æ•ˆï¼ˆç»¿è‰²é”å›¾æ ‡ï¼‰
- [ ] å¯ä»¥æ³¨å†Œè´¦å·
- [ ] å¯ä»¥æ”¶åˆ°éªŒè¯ç é‚®ä»¶

#### ç®¡ç†é—¨æˆ·
æ‰“å¼€æµè§ˆå™¨è®¿é—®: https://laimiu.sdhaohan.cn
- [ ] é¡µé¢æ­£å¸¸åŠ è½½
- [ ] HTTPS è¯ä¹¦æœ‰æ•ˆ
- [ ] ä½¿ç”¨ä»¥ä¸‹è´¦å·ç™»å½•ï¼š
  - é‚®ç®±: `Laimiu.new@gmail.com`
  - å¯†ç : `ghzzz123`

#### API æ–‡æ¡£
æ‰“å¼€æµè§ˆå™¨è®¿é—®: https://api.sdhaohan.cn/api/v1/docs
- [ ] Swagger æ–‡æ¡£æ­£å¸¸æ˜¾ç¤º
- [ ] å¯ä»¥æµ‹è¯• API æ¥å£

### 3. æµ‹è¯•é‚®ä»¶åŠŸèƒ½

åœ¨ç”¨æˆ·é—¨æˆ·æ³¨å†Œä¸€ä¸ªæ–°è´¦å·ï¼Œæ£€æŸ¥æ˜¯å¦èƒ½æ”¶åˆ°éªŒè¯ç é‚®ä»¶ã€‚

---

## ğŸ“Š æœåŠ¡å™¨ä¿¡æ¯

### è¿æ¥ä¿¡æ¯
- **IP åœ°å€**: 43.142.188.252
- **SSH ç™»å½•**: `ssh root@43.142.188.252`
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 22.04 + Docker

### åŸŸåä¿¡æ¯
- **ç”¨æˆ·é—¨æˆ·**: https://sdhaohan.cn
- **ç®¡ç†é—¨æˆ·**: https://laimiu.sdhaohan.cn
- **åç«¯ API**: https://api.sdhaohan.cn

### ç®¡ç†å‘˜è´¦å·
- **é‚®ç®±**: Laimiu.new@gmail.com
- **å¯†ç **: ghzzz123

### æ•°æ®åº“ä¿¡æ¯
- **æ•°æ®åº“**: weld_db
- **ç”¨æˆ·**: weld_user
- **å¯†ç **: WeldDB@2024#Secure!Pass
- **ç«¯å£**: 5432ï¼ˆä»…å®¹å™¨å†…éƒ¨è®¿é—®ï¼‰

### Redis ä¿¡æ¯
- **å¯†ç **: Redis@2024#Strong!Key
- **ç«¯å£**: 6379ï¼ˆä»…å®¹å™¨å†…éƒ¨è®¿é—®ï¼‰

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs -f backend

# æŸ¥çœ‹ Nginx æ—¥å¿—
docker-compose logs -f nginx

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œæ—¥å¿—
docker-compose logs --tail=100
```

### é‡å¯æœåŠ¡
```bash
# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose restart

# é‡å¯å•ä¸ªæœåŠ¡
docker-compose restart backend
docker-compose restart nginx
```

### åœæ­¢å’Œå¯åŠ¨
```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build
```

### æ•°æ®åº“ç®¡ç†
```bash
# è¿›å…¥æ•°æ®åº“
docker-compose exec postgres psql -U weld_user -d weld_db

# å¤‡ä»½æ•°æ®åº“
docker-compose exec postgres pg_dump -U weld_user weld_db > backup_$(date +%Y%m%d_%H%M%S).sql

# æ¢å¤æ•°æ®åº“
docker-compose exec -T postgres psql -U weld_user -d weld_db < backup.sql
```

### SSL è¯ä¹¦ç®¡ç†
```bash
# æ‰‹åŠ¨ç»­æœŸè¯ä¹¦
docker-compose run --rm certbot renew

# é‡æ–°ç”³è¯·è¯ä¹¦
docker-compose run --rm certbot certonly --webroot \
    --webroot-path=/var/www/certbot \
    --email 2564786659@qq.com \
    --agree-tos \
    -d sdhaohan.cn

# é‡å¯ Nginx åŠ è½½æ–°è¯ä¹¦
docker-compose restart nginx
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: SSL è¯ä¹¦ç”³è¯·å¤±è´¥ï¼Ÿ
**åŸå› **: DNS è§£ææœªç”Ÿæ•ˆæˆ–ç«¯å£æœªå¼€æ”¾

**è§£å†³æ–¹æ³•**:
1. ç¡®è®¤ DNS å·²è§£æ: `ping sdhaohan.cn`
2. ç¡®è®¤ç«¯å£ 80 å·²å¼€æ”¾
3. ç­‰å¾… 5-10 åˆ†é’Ÿåé‡è¯•

### Q2: æ— æ³•è®¿é—®ç½‘ç«™ï¼ˆ502 Bad Gatewayï¼‰ï¼Ÿ
**åŸå› **: åç«¯æœåŠ¡æœªå¯åŠ¨

**è§£å†³æ–¹æ³•**:
```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs backend

# é‡å¯åç«¯æœåŠ¡
docker-compose restart backend
```

### Q3: é‚®ä»¶å‘é€å¤±è´¥ï¼Ÿ
**åŸå› **: QQ é‚®ç®±æˆæƒç é”™è¯¯æˆ– SMTP é…ç½®é—®é¢˜

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥ `backend/.env.production` ä¸­çš„ `SMTP_PASSWORD`
2. æŸ¥çœ‹åç«¯æ—¥å¿—: `docker-compose logs backend | grep -i smtp`
3. é‡å¯åç«¯æœåŠ¡: `docker-compose restart backend`

### Q4: å‰ç«¯é¡µé¢ç©ºç™½ï¼Ÿ
**åŸå› **: å‰ç«¯æ„å»ºå¤±è´¥æˆ– API åœ°å€é…ç½®é”™è¯¯

**è§£å†³æ–¹æ³•**:
```bash
# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker-compose logs frontend
docker-compose logs admin-portal

# é‡æ–°æ„å»ºå‰ç«¯
docker-compose up -d --build frontend admin-portal
```

### Q5: æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ
**åŸå› **: PostgreSQL æœåŠ¡æœªå¯åŠ¨æˆ–å¯†ç é”™è¯¯

**è§£å†³æ–¹æ³•**:
```bash
# æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€
docker-compose ps postgres

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker-compose logs postgres

# é‡å¯æ•°æ®åº“
docker-compose restart postgres
```

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. **æŸ¥çœ‹æ—¥å¿—**: `docker-compose logs -f`
2. **æŸ¥çœ‹æ–‡æ¡£**: 
   - `DEPLOYMENT_GUIDE.md` - è¯¦ç»†éƒ¨ç½²æŒ‡å—
   - `DEPLOYMENT_CHECKLIST.md` - æ£€æŸ¥æ¸…å•
   - `QUICK_DEPLOY.md` - å¿«é€Ÿå‚è€ƒ
3. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**: `docker-compose ps`

---

## ğŸŠ ä¸‹ä¸€æ­¥

éƒ¨ç½²æˆåŠŸåï¼Œä½ å¯ä»¥ï¼š

1. âœ… ç™»å½•ç®¡ç†é—¨æˆ·ï¼Œç†Ÿæ‚‰ç³»ç»ŸåŠŸèƒ½
2. âœ… åˆ›å»ºä¼ä¸šå·¥ä½œç©ºé—´
3. âœ… æ·»åŠ ç”¨æˆ·å’Œè§’è‰²
4. âœ… åˆ›å»º WPS/PQR æ–‡æ¡£
5. âœ… é…ç½®ç³»ç»Ÿè®¾ç½®

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

---

**éƒ¨ç½²æ—¶é—´**: é¢„è®¡ 15-20 åˆ†é’Ÿ  
**éš¾åº¦**: â­â­â˜†â˜†â˜† (ç®€å•)  
**å‡†å¤‡çŠ¶æ€**: âœ… å·²å°±ç»ªï¼Œéšæ—¶å¯ä»¥éƒ¨ç½²ï¼

