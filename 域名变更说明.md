# ğŸ”„ åŸŸåå˜æ›´è¯´æ˜

## å˜æ›´å†…å®¹

ç®¡ç†å‘˜é—¨æˆ·çš„åŸŸåå·²ä» `admin.sdhaohan.cn` æ›´æ”¹ä¸º `laimiu.sdhaohan.cn`

---

## ğŸ“‹ æ–°çš„åŸŸåé…ç½®

| æœåŠ¡ | åŸŸå | ç”¨é€” |
|------|------|------|
| ç”¨æˆ·é—¨æˆ· | `sdhaohan.cn` | æ™®é€šç”¨æˆ·è®¿é—®çš„å‰ç«¯ç•Œé¢ |
| ç®¡ç†é—¨æˆ· | `laimiu.sdhaohan.cn` | ç®¡ç†å‘˜åå°ç®¡ç†ç•Œé¢ âœ¨ **å·²æ›´æ”¹** |
| åç«¯ API | `api.sdhaohan.cn` | åç«¯æ¥å£æœåŠ¡ |

---

## âœ… å·²æ›´æ–°çš„æ–‡ä»¶

ä»¥ä¸‹æ–‡ä»¶å·²å…¨éƒ¨æ›´æ–°ä¸ºæ–°åŸŸåï¼š

### é…ç½®æ–‡ä»¶ (3ä¸ª)
1. âœ… `nginx/conf.d/default.conf` - Nginx ç«™ç‚¹é…ç½®
2. âœ… `backend/.env.production` - åç«¯ CORS é…ç½®
3. âœ… `deploy.sh` - éƒ¨ç½²è„šæœ¬

### æ–‡æ¡£æ–‡ä»¶ (7ä¸ª)
4. âœ… `DEPLOYMENT_GUIDE.md` - éƒ¨ç½²æŒ‡å—
5. âœ… `QUICK_DEPLOY.md` - å¿«é€Ÿéƒ¨ç½²å‚è€ƒ
6. âœ… `DEPLOYMENT_CHECKLIST.md` - éƒ¨ç½²æ£€æŸ¥æ¸…å•
7. âœ… `DEPLOYMENT_FILES_SUMMARY.md` - éƒ¨ç½²æ–‡ä»¶è¯´æ˜
8. âœ… `README.md` - é¡¹ç›®ä¸»æ–‡æ¡£
9. âœ… `éƒ¨ç½²å‡†å¤‡å®Œæˆ.md` - éƒ¨ç½²å‡†å¤‡æ–‡æ¡£
10. âœ… `åŸŸåå˜æ›´è¯´æ˜.md` - æœ¬æ–‡æ¡£

---

## ğŸ¯ éƒ¨ç½²å‰éœ€è¦åšçš„äº‹

### 1. DNS è§£æé…ç½®

åœ¨è…¾è®¯äº‘ DNS æ§åˆ¶å°ï¼Œéœ€è¦æ·»åŠ ä»¥ä¸‹è®°å½•ï¼š

| ä¸»æœºè®°å½• | è®°å½•ç±»å‹ | è®°å½•å€¼ | è¯´æ˜ |
|---------|---------|--------|------|
| @ | A | 43.142.188.252 | ä¸»åŸŸå |
| **laimiu** | **A** | **43.142.188.252** | **ç®¡ç†é—¨æˆ·ï¼ˆæ–°ï¼‰** âœ¨ |
| api | A | 43.142.188.252 | API åŸŸå |

âš ï¸ **é‡è¦**: ä¸è¦å†æ·»åŠ  `admin` çš„ A è®°å½•ï¼Œæ”¹ä¸ºæ·»åŠ  `laimiu`

### 2. éªŒè¯ DNS è§£æ

```bash
# éªŒè¯ä¸»åŸŸå
ping sdhaohan.cn

# éªŒè¯ç®¡ç†é—¨æˆ·ï¼ˆæ–°åŸŸåï¼‰
ping laimiu.sdhaohan.cn

# éªŒè¯ API åŸŸå
ping api.sdhaohan.cn
```

æ‰€æœ‰åŸŸåéƒ½åº”è¯¥è§£æåˆ° `43.142.188.252`

---

## ğŸ” SSL è¯ä¹¦ç”³è¯·

éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨ä¸ºæ–°åŸŸåç”³è¯· SSL è¯ä¹¦ï¼š

```bash
# è‡ªåŠ¨ç”³è¯· laimiu.sdhaohan.cn çš„è¯ä¹¦
docker-compose run --rm certbot certonly --webroot \
    --webroot-path=/var/www/certbot \
    --email 2564786659@qq.com \
    --agree-tos \
    --no-eff-email \
    -d laimiu.sdhaohan.cn
```

è¯ä¹¦å°†ä¿å­˜åœ¨ï¼š
```
nginx/certbot/conf/live/laimiu.sdhaohan.cn/
â”œâ”€â”€ fullchain.pem
â””â”€â”€ privkey.pem
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1: é…ç½® DNS
åœ¨è…¾è®¯äº‘ DNS æ§åˆ¶å°æ·»åŠ  `laimiu` çš„ A è®°å½•

### æ­¥éª¤ 2: éªŒè¯ DNS
```bash
ping laimiu.sdhaohan.cn
```

### æ­¥éª¤ 3: ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
```bash
# æ–¹å¼ A: Gitï¼ˆæ¨èï¼‰
git add .
git commit -m "Update admin portal domain to laimiu.sdhaohan.cn"
git push

# åœ¨æœåŠ¡å™¨ä¸Š
ssh root@43.142.188.252
cd <é¡¹ç›®ç›®å½•>
git pull

# æ–¹å¼ B: SCP ä¸Šä¼ 
scp -r ./ root@43.142.188.252:/root/welding-system/
```

### æ­¥éª¤ 4: è¿è¡Œéƒ¨ç½²è„šæœ¬
```bash
ssh root@43.142.188.252
cd <é¡¹ç›®ç›®å½•>
chmod +x deploy.sh
./deploy.sh
```

éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… æ„å»ºæ‰€æœ‰ Docker é•œåƒ
- âœ… å¯åŠ¨æ‰€æœ‰æœåŠ¡
- âœ… ä¸º `laimiu.sdhaohan.cn` ç”³è¯· SSL è¯ä¹¦
- âœ… é…ç½® Nginx åå‘ä»£ç†
- âœ… åˆå§‹åŒ–æ•°æ®åº“

---

## ğŸ” éƒ¨ç½²åéªŒè¯

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
docker-compose ps
```

æ‰€æœ‰æœåŠ¡åº”è¯¥éƒ½æ˜¯ `Up` çŠ¶æ€

### 2. è®¿é—®ç®¡ç†é—¨æˆ·
```bash
# æµ‹è¯• HTTPS
curl -I https://laimiu.sdhaohan.cn
```

åº”è¯¥è¿”å› `200 OK`

### 3. æµè§ˆå™¨è®¿é—®
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
```
https://laimiu.sdhaohan.cn
```

- [ ] é¡µé¢æ­£å¸¸åŠ è½½
- [ ] HTTPS è¯ä¹¦æœ‰æ•ˆï¼ˆç»¿è‰²é”å›¾æ ‡ï¼‰
- [ ] å¯ä»¥æ­£å¸¸ç™»å½•ç®¡ç†åå°

### 4. æ£€æŸ¥ CORS é…ç½®
åœ¨ç®¡ç†é—¨æˆ·çš„æµè§ˆå™¨æ§åˆ¶å°ï¼Œä¸åº”è¯¥çœ‹åˆ°ä»»ä½• CORS é”™è¯¯

---

## ğŸ“ é…ç½®å˜æ›´è¯¦æƒ…

### Nginx é…ç½®å˜æ›´
<augment_code_snippet path="nginx/conf.d/default.conf" mode="EXCERPT">
````nginx
# HTTPS - ç®¡ç†é—¨æˆ· (laimiu.sdhaohan.cn)
server {
    listen 443 ssl http2;
    server_name laimiu.sdhaohan.cn;

    ssl_certificate /etc/letsencrypt/live/laimiu.sdhaohan.cn/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/laimiu.sdhaohan.cn/privkey.pem;
    ...
}
````
</augment_code_snippet>

### åç«¯ CORS é…ç½®å˜æ›´
<augment_code_snippet path="backend/.env.production" mode="EXCERPT">
````bash
ALLOWED_ORIGINS=["https://sdhaohan.cn", "https://laimiu.sdhaohan.cn", "https://api.sdhaohan.cn"]
````
</augment_code_snippet>

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **DNS è§£ææ—¶é—´**: DNS è§£æå¯èƒ½éœ€è¦ 5-10 åˆ†é’Ÿç”Ÿæ•ˆï¼Œè¯·è€å¿ƒç­‰å¾…

2. **SSL è¯ä¹¦ç”³è¯·**: ç¡®ä¿ DNS å·²è§£ææˆåŠŸåå†ç”³è¯·è¯ä¹¦ï¼Œå¦åˆ™ä¼šå¤±è´¥

3. **æ—§åŸŸå**: å¦‚æœä¹‹å‰å·²ç»éƒ¨ç½²è¿‡ `admin.sdhaohan.cn`ï¼Œå®ƒå°†ä¸å†å·¥ä½œ

4. **æµè§ˆå™¨ç¼“å­˜**: å¦‚æœä¹‹å‰è®¿é—®è¿‡æ—§åŸŸåï¼Œå¯èƒ½éœ€è¦æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

5. **ä¹¦ç­¾æ›´æ–°**: å¦‚æœæœ‰ä¿å­˜ç®¡ç†é—¨æˆ·çš„ä¹¦ç­¾ï¼Œéœ€è¦æ›´æ–°ä¸ºæ–°åŸŸå

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: DNS è§£æä¸ç”Ÿæ•ˆæ€ä¹ˆåŠï¼Ÿ
**A**: ç­‰å¾… 5-10 åˆ†é’Ÿï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ï¼š
```bash
nslookup laimiu.sdhaohan.cn
```

### Q2: SSL è¯ä¹¦ç”³è¯·å¤±è´¥ï¼Ÿ
**A**: ç¡®ä¿ï¼š
- DNS å·²æ­£ç¡®è§£æåˆ°æœåŠ¡å™¨ IP
- æœåŠ¡å™¨å®‰å…¨ç»„å·²å¼€æ”¾ 80 ç«¯å£
- Nginx æœåŠ¡æ­£åœ¨è¿è¡Œ

### Q3: è®¿é—®ç®¡ç†é—¨æˆ·å‡ºç° CORS é”™è¯¯ï¼Ÿ
**A**: æ£€æŸ¥ `backend/.env.production` ä¸­çš„ `ALLOWED_ORIGINS` æ˜¯å¦åŒ…å«æ–°åŸŸå

### Q4: é¡µé¢æ˜¾ç¤º 502 Bad Gatewayï¼Ÿ
**A**: æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š
```bash
docker-compose logs backend
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. `DEPLOYMENT_GUIDE.md` - è¯¦ç»†éƒ¨ç½²æŒ‡å—
2. `QUICK_DEPLOY.md` - å¿«é€Ÿå‚è€ƒ
3. `DEPLOYMENT_CHECKLIST.md` - æ£€æŸ¥æ¸…å•

æˆ–æŸ¥çœ‹æœåŠ¡æ—¥å¿—ï¼š
```bash
docker-compose logs -f
```

---

**å˜æ›´æ—¥æœŸ**: 2025-10-31  
**å˜æ›´åŸå› **: ç”¨æˆ·è¦æ±‚  
**å½±å“èŒƒå›´**: ç®¡ç†é—¨æˆ·åŸŸå  
**å‘åå…¼å®¹**: å¦ï¼ˆæ—§åŸŸå admin.sdhaohan.cn å°†ä¸å†å·¥ä½œï¼‰

