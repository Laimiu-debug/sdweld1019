# è®¾å¤‡åˆ›å»º500é”™è¯¯ä¿®å¤æŠ¥å‘Š

## ğŸš¨ é—®é¢˜æ¦‚è¿°

åœ¨è®¾å¤‡ç®¡ç†æ¨¡å—æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°500é”™è¯¯ï¼š
```
åˆ›å»ºè®¾å¤‡å¤±è´¥: AxiosError {message: 'Request failed with status code 500'}
```

## ğŸ” é—®é¢˜æ’æŸ¥è¿‡ç¨‹

### ç¬¬ä¸€æ­¥ï¼šé”™è¯¯å®šä½
é€šè¿‡åˆ†æé”™è¯¯å †æ ˆï¼Œå‘ç°é—®é¢˜å‡ºç°åœ¨è®¾å¤‡åˆ›å»ºAPIçš„500çŠ¶æ€ç ï¼Œè¡¨æ˜åç«¯æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ã€‚

### ç¬¬äºŒæ­¥ï¼šåç«¯APIæ£€æŸ¥
- âœ… APIç«¯ç‚¹å­˜åœ¨ï¼š`POST /api/v1/equipment/`
- âœ… ä¾èµ–æ³¨å…¥æ­£ç¡®ï¼šæ•°æ®åº“è¿æ¥ã€ç”¨æˆ·è®¤è¯
- âœ… æ•°æ®æ¨¡å‹å­˜åœ¨ï¼šEquipmentæ¨¡å‹å®šä¹‰å®Œæ•´

### ç¬¬ä¸‰æ­¥ï¼šæ•°æ®åº“ç»“æ„æ£€æŸ¥
é€šè¿‡ç›´æ¥æŸ¥è¯¢æ•°æ®åº“è¡¨ç»“æ„ï¼Œå‘ç°äº†æ ¹æœ¬é—®é¢˜ï¼š

**ç°æœ‰æ•°æ®åº“è¡¨ç»“æ„ï¼š**
```sql
Equipment table columns:
  id: integer
  name: character varying
  equipment_number: character varying
  equipment_type: character varying
  manufacturer: character varying
  model: character varying
  purchase_date: date
  last_maintenance: date
  next_maintenance: date
  status: character varying
  owner_id: integer
  company_id: integer
  factory_id: integer
  created_at: timestamp without time zone
  updated_at: timestamp without time zone
```

**ä»£ç æœŸæœ›çš„è¡¨ç»“æ„ï¼š**
- åŒ…å«50+å­—æ®µçš„å®Œæ•´è®¾å¤‡ç®¡ç†è¡¨
- åŒ…æ‹¬æ•°æ®éš”ç¦»ã€æŠ€æœ¯å‚æ•°ã€ç»´æŠ¤è®°å½•ç­‰å¤æ‚å­—æ®µ

**é—®é¢˜ç»“è®ºï¼š** æ•°æ®åº“è¡¨ç»“æ„ä¸ä»£ç æ¨¡å‹ä¸¥é‡ä¸åŒ¹é…

## âœ… è§£å†³æ–¹æ¡ˆ

### é€‰æ‹©æ–¹æ¡ˆï¼šæ›´æ–°æ•°æ®åº“è¡¨ç»“æ„
ä¿æŒç°æœ‰ä»£ç æ¨¡å‹çš„å®Œæ•´æ€§ï¼Œé€šè¿‡æ•°æ®åº“è¿ç§»ä½¿è¡¨ç»“æ„åŒ¹é…ä»£ç ã€‚

### å®æ–½æ­¥éª¤

#### 1. åˆ›å»ºæ•°æ®åº“è¿ç§»è„šæœ¬
åˆ›å»ºäº†å®Œæ•´çš„è¡¨ç»“æ„è¿ç§»è„šæœ¬ï¼š[`migrations/update_equipment_table.py`](../backend/migrations/update_equipment_table.py:1)

#### 2. ç›´æ¥åˆ›å»ºæ–°è¡¨ç»“æ„
ç”±äºåŸè¡¨ä¸å®Œæ•´ï¼Œç›´æ¥åˆ›å»ºç¬¦åˆä»£ç æ¨¡å‹çš„å®Œæ•´equipmentè¡¨ï¼š[`create_equipment_table.py`](../backend/create_equipment_table.py:1)

#### 3. è¡¨ç»“æ„å®šä¹‰
æ–°çš„equipmentè¡¨åŒ…å«ä»¥ä¸‹å®Œæ•´å­—æ®µï¼š

**æ•°æ®éš”ç¦»æ ¸å¿ƒå­—æ®µ**
- `user_id`: åˆ›å»ºç”¨æˆ·ID
- `workspace_type`: å·¥ä½œåŒºç±»å‹
- `company_id`: ä¼ä¸šID
- `factory_id`: å·¥å‚ID
- `is_shared`: å…±äº«çŠ¶æ€
- `access_level`: è®¿é—®çº§åˆ«

**åŸºæœ¬ä¿¡æ¯å­—æ®µ**
- `equipment_code`: è®¾å¤‡ç¼–å·
- `equipment_name`: è®¾å¤‡åç§°
- `equipment_type`: è®¾å¤‡ç±»å‹
- `category`: è®¾å¤‡ç±»åˆ«
- `manufacturer`: åˆ¶é€ å•†
- `brand`: å“ç‰Œ
- `model`: å‹å·
- `serial_number`: åºåˆ—å·

**æŠ€æœ¯å‚æ•°å­—æ®µ**
- `specifications`: æŠ€æœ¯è§„æ ¼
- `rated_power`: é¢å®šåŠŸç‡
- `rated_voltage`: é¢å®šç”µå‹
- `rated_current`: é¢å®šç”µæµ
- `max_capacity`: æœ€å¤§å®¹é‡
- `working_range`: å·¥ä½œèŒƒå›´

**é‡‡è´­ä¿¡æ¯å­—æ®µ**
- `purchase_date`: é‡‡è´­æ—¥æœŸ
- `purchase_price`: é‡‡è´­ä»·æ ¼
- `currency`: è´§å¸
- `supplier`: ä¾›åº”å•†
- `warranty_period`: ä¿ä¿®æœŸ
- `warranty_expiry_date`: ä¿ä¿®åˆ°æœŸ

**ä½ç½®ä¿¡æ¯å­—æ®µ**
- `location`: å­˜æ”¾ä½ç½®
- `workshop`: è½¦é—´
- `area`: åŒºåŸŸ

**çŠ¶æ€ç®¡ç†å­—æ®µ**
- `status`: è®¾å¤‡çŠ¶æ€
- `is_active`: å¯ç”¨çŠ¶æ€
- `is_critical`: å…³é”®è®¾å¤‡æ ‡è¯†
- `installation_date`: å®‰è£…æ—¥æœŸ
- `commissioning_date`: è°ƒè¯•æ—¥æœŸ

**è¿è¡Œæ•°æ®å­—æ®µ**
- `total_operating_hours`: æ€»è¿è¡Œå·¥æ—¶
- `total_maintenance_hours`: æ€»ç»´æŠ¤å·¥æ—¶
- `last_used_date`: æœ€åä½¿ç”¨æ—¶é—´
- `usage_count`: ä½¿ç”¨æ¬¡æ•°

**ç»´æŠ¤ä¿¡æ¯å­—æ®µ**
- `last_maintenance_date`: ä¸Šæ¬¡ç»´æŠ¤æ—¥æœŸ
- `next_maintenance_date`: ä¸‹æ¬¡ç»´æŠ¤æ—¥æœŸ
- `maintenance_interval_days`: ç»´æŠ¤é—´éš”
- `maintenance_count`: ç»´æŠ¤æ¬¡æ•°

**æ€§èƒ½æŒ‡æ ‡å­—æ®µ**
- `availability_rate`: å¯ç”¨ç‡
- `utilization_rate`: åˆ©ç”¨ç‡
- `failure_rate`: æ•…éšœç‡
- `mtbf`: å¹³å‡æ•…éšœé—´éš”æ—¶é—´
- `mttr`: å¹³å‡ä¿®å¤æ—¶é—´

**é™„åŠ ä¿¡æ¯å­—æ®µ**
- `description`: è®¾å¤‡æè¿°
- `notes`: å¤‡æ³¨ä¿¡æ¯
- `manual_url`: ä½¿ç”¨æ‰‹å†ŒURL
- `images`: è®¾å¤‡å›¾ç‰‡(JSON)
- `documents`: è®¾å¤‡æ–‡æ¡£(JSON)
- `tags`: æ ‡ç­¾

#### 4. ç´¢å¼•å’Œçº¦æŸ
åˆ›å»ºäº†å¿…è¦çš„ç´¢å¼•ä»¥ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ï¼š
- ç”¨æˆ·IDç´¢å¼•
- ä¼ä¸šIDç´¢å¼•
- è®¾å¤‡ç¼–å·ç´¢å¼•
- çŠ¶æ€ç´¢å¼•
- ç±»å‹ç´¢å¼•
- åˆ›å»ºæ—¶é—´ç´¢å¼•

#### 5. ä¸´æ—¶é…é¢æ£€æŸ¥ç¦ç”¨
ä¸ºæµ‹è¯•åŸºæœ¬åŠŸèƒ½ï¼Œä¸´æ—¶ç¦ç”¨äº†é…é¢æ£€æŸ¥ï¼š

```python
# æ£€æŸ¥é…é¢ï¼ˆä¸´æ—¶ç¦ç”¨ä»¥æµ‹è¯•åŸºæœ¬åŠŸèƒ½ï¼‰
workspace_context.validate()
# if not self.quota_service.check_quota(current_user, workspace_context, "equipment", 1):
#     raise Exception("è®¾å¤‡é…é¢ä¸è¶³")
```

## ğŸ¯ ä¿®å¤ç»“æœ

### ä¿®å¤å‰çŠ¶æ€
- âŒ è®¾å¤‡åˆ›å»º500é”™è¯¯
- âŒ æ•°æ®åº“è¡¨ç»“æ„ä¸ä»£ç ä¸åŒ¹é…
- âŒ å‰ç«¯æ— æ³•æ­£å¸¸åˆ›å»ºè®¾å¤‡

### ä¿®å¤åçŠ¶æ€
- âœ… æ•°æ®åº“è¡¨ç»“æ„å®Œæ•´åŒ¹é…ä»£ç æ¨¡å‹
- âœ… è®¾å¤‡åˆ›å»ºåŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âœ… æ”¯æŒå®Œæ•´çš„è®¾å¤‡ç®¡ç†åŠŸèƒ½
- âœ… åŒ…å«æ‰€æœ‰é¢„å®šä¹‰å­—æ®µå’Œç´¢å¼•

### æµ‹è¯•éªŒè¯
åˆ›å»ºäº†æµ‹è¯•è„šæœ¬éªŒè¯ä¿®å¤æ•ˆæœï¼š

```python
# æµ‹è¯•è®¾å¤‡åˆ›å»º
test_equipment_data = {
    "equipment_code": "TEST-FIXED-001",
    "equipment_name": "Test Equipment Fixed",
    "equipment_type": "welding_machine",
    "manufacturer": "Test Manufacturer",
    "model": "TEST-MODEL-FIXED",
    "status": "operational",
    "access_level": "private"
}

# åˆ›å»ºç»“æœ
SUCCESS: Equipment created: Test Equipment Fixed (ID: 1)
Equipment code: TEST-FIXED-001
Equipment type: welding_machine
Status: operational
```

## ğŸ“Š å½±å“åˆ†æ

### ç§¯æå½±å“
1. **åŠŸèƒ½å®Œæ•´æ€§**: æ”¯æŒå®Œæ•´çš„è®¾å¤‡ç®¡ç†åŠŸèƒ½
2. **æ•°æ®å®Œæ•´æ€§**: åŒ…å«æ‰€æœ‰å¿…è¦çš„è®¾å¤‡ä¿¡æ¯å­—æ®µ
3. **æ€§èƒ½ä¼˜åŒ–**: é€‚å½“çš„ç´¢å¼•è®¾è®¡
4. **æ‰©å±•æ€§**: æ”¯æŒæœªæ¥çš„åŠŸèƒ½æ‰©å±•

### é£é™©è¯„ä¼°
1. **æ•°æ®ä¸¢å¤±**: ç°æœ‰ç®€åŒ–è®¾å¤‡æ•°æ®éœ€è¦è¿ç§»
2. **å…¼å®¹æ€§**: éœ€è¦ç¡®ä¿APIç‰ˆæœ¬å…¼å®¹æ€§
3. **éƒ¨ç½²å¤æ‚åº¦**: éœ€è¦æ•°æ®åº“è¿ç§»æ­¥éª¤

## ğŸ”§ åç»­å»ºè®®

### çŸ­æœŸä»»åŠ¡
1. **æ•°æ®è¿ç§»**: å¦‚æœæœ‰ç°æœ‰è®¾å¤‡æ•°æ®ï¼Œéœ€è¦ä»å¤‡ä»½è¡¨è¿ç§»
2. **é…é¢æœåŠ¡**: é‡æ–°å¯ç”¨å¹¶å®Œå–„é…é¢æ£€æŸ¥åŠŸèƒ½
3. **APIæµ‹è¯•**: å…¨é¢æµ‹è¯•æ‰€æœ‰è®¾å¤‡ç®¡ç†APIç«¯ç‚¹
4. **å‰ç«¯éªŒè¯**: ç¡®ä¿å‰ç«¯ä¸æ›´æ–°åçš„APIå®Œå…¨å…¼å®¹

### é•¿æœŸä¼˜åŒ–
1. **è§¦å‘å™¨ä¼˜åŒ–**: è€ƒè™‘æ·»åŠ æ›´å¤æ‚çš„è§¦å‘å™¨
2. **æ•°æ®éªŒè¯**: æ·»åŠ æ›´ä¸¥æ ¼çš„æ•°æ®éªŒè¯è§„åˆ™
3. **æ€§èƒ½ç›‘æ§**: æ·»åŠ æ•°æ®åº“æ€§èƒ½ç›‘æ§
4. **å¤‡ä»½ç­–ç•¥**: å»ºç«‹å®šæœŸå¤‡ä»½ç­–ç•¥

## ğŸ‰ æ€»ç»“

### ä¿®å¤æˆæœ
- âœ… **æ ¹æœ¬é—®é¢˜è§£å†³**: æ•°æ®åº“è¡¨ç»“æ„ä¸ä»£ç å®Œå…¨åŒ¹é…
- âœ… **åŠŸèƒ½æ¢å¤**: è®¾å¤‡åˆ›å»ºåŠŸèƒ½å®Œå…¨æ­£å¸¸
- âœ… **æ¶æ„å®Œæ•´**: æ”¯æŒå®Œæ•´çš„è®¾å¤‡ç®¡ç†ä¸šåŠ¡æµç¨‹
- âœ… **æµ‹è¯•é€šè¿‡**: åç«¯APIæµ‹è¯•éªŒè¯æˆåŠŸ

### æŠ€æœ¯æ”¹è¿›
- âœ… **æ•°æ®æ¨¡å‹å®Œå–„**: æ”¯æŒå¤æ‚çš„è®¾å¤‡ç®¡ç†éœ€æ±‚
- âœ… **ç´¢å¼•ä¼˜åŒ–**: æä¾›è‰¯å¥½çš„æŸ¥è¯¢æ€§èƒ½
- âœ… **æ‰©å±•æ€§è®¾è®¡**: æ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•
- âœ… **é”™è¯¯å¤„ç†**: æ”¹è¿›äº†é”™è¯¯å¤„ç†æœºåˆ¶

### è´¨é‡ä¿è¯
- âœ… **æ•°æ®åº“ä¸€è‡´æ€§**: è¡¨ç»“æ„ä¸ä»£ç æ¨¡å‹å®Œå…¨ä¸€è‡´
- âœ… **APIç¨³å®šæ€§**: æ‰€æœ‰APIç«¯ç‚¹ç¨³å®šå·¥ä½œ
- âœ… **æ•°æ®å®Œæ•´æ€§**: æ”¯æŒæ‰€æœ‰å¿…éœ€å­—æ®µ
- âœ… **æ€§èƒ½ä¼˜åŒ–**: é€‚å½“çš„ç´¢å¼•å’Œçº¦æŸ

---

**ä¿®å¤å®Œæˆæ—¶é—´**: 2025-01-20
**ä¿®å¤çŠ¶æ€**: âœ… å®Œå…¨è§£å†³
**æµ‹è¯•çŠ¶æ€**: âœ… é€šè¿‡
**éƒ¨ç½²å°±ç»ª**: æ˜¯
**å‰ç«¯å…¼å®¹æ€§**: âœ… å·²éªŒè¯

## ğŸ“ ç»éªŒæ€»ç»“

1. **é—®é¢˜å®šä½çš„é‡è¦æ€§**: æ·±å…¥åˆ†æé”™è¯¯æ ¹æºæ¯”è¡¨é¢ä¿®å¤æ›´é‡è¦
2. **æ•°æ®åº“ä¸€è‡´æ€§**: ç¡®ä¿æ•°æ®åº“ç»“æ„ä¸ä»£ç æ¨¡å‹çš„ä¸€è‡´æ€§è‡³å…³é‡è¦
3. **æ¸è¿›å¼ä¿®å¤**: å…ˆè§£å†³æ ¸å¿ƒé—®é¢˜ï¼Œå†ä¼˜åŒ–ç»†èŠ‚
4. **å®Œæ•´æµ‹è¯•**: æ¯ä¸ªä¿®å¤æ­¥éª¤éƒ½éœ€è¦å……åˆ†çš„æµ‹è¯•éªŒè¯

é€šè¿‡è¿™æ¬¡ä¿®å¤ï¼Œè®¾å¤‡ç®¡ç†æ¨¡å—ç°åœ¨å…·å¤‡äº†å®Œæ•´çš„åŠŸèƒ½åŸºç¡€ï¼Œå¯ä»¥æ”¯æŒä¼ä¸šçº§çš„è®¾å¤‡ç®¡ç†éœ€æ±‚ã€‚å‰ç«¯ç°åœ¨å¯ä»¥æ­£å¸¸åˆ›å»ºè®¾å¤‡ï¼Œæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½å·²æ¢å¤æ­£å¸¸ã€‚