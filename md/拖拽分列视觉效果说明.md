# 拖拽分列视觉效果说明

## 更新内容

### 问题
1. 之前拖拽时只显示"放置到新行"选项,没有显示左右放置区域
2. 左右放置区太小(50px),难以拖拽到
3. 拖拽预览框太大,遮挡了放置区域
4. 很难添加第三列、第四列

### 解决方案
1. **改用 Flexbox 布局**: 替代 Ant Design 的 Row/Col,使用原生 flex 布局
2. **始终显示放置区域**: 左右放置区域始终可见(灰色虚线边框)
3. **悬停时高亮**: 拖拽悬停时变为蓝色实线边框,更明显
4. **增加宽度**: 左右放置区域增加到 80px 宽度,更容易拖拽到
5. **缩小拖拽预览**: 拖拽时的预览框缩小到 50%,不遮挡放置区域

## 视觉效果

### 未拖拽时
```
┌─────────────────────────────────────────┐
│          基本信息 (全宽)                │
└─────────────────────────────────────────┘
```

### 拖拽时 (从模块库拖拽)
```
┌──────────┬─────────────────────────┬──────────┐
│    ←     │   基本信息 (全宽)       │    →     │
│  左侧    │                         │  右侧    │
│ (灰色)   │                         │ (灰色)   │
│ 80px     │                         │  80px    │
└──────────┴─────────────────────────┴──────────┘

┌───────────────────────────────────────────────┐
│            ↓ 新行 (灰色)                      │
└───────────────────────────────────────────────┘

注: 拖拽的模块预览缩小到 50%,半透明显示
```

### 悬停在左侧放置区
```
┌──────────┬─────────────────────────┬──────────┐
│    ←     │   基本信息 (全宽)       │    →     │
│  左侧    │                         │  右侧    │
│ (蓝色)   │                         │ (灰色)   │
│ 实线边框 │                         │          │
│ 加粗文字 │                         │          │
└──────────┴─────────────────────────┴──────────┘
```

### 悬停在右侧放置区
```
┌──────────┬─────────────────────────┬──────────┐
│    ←     │   基本信息 (全宽)       │    →     │
│  左侧    │                         │  右侧    │
│ (灰色)   │                         │ (蓝色)   │
│          │                         │ 实线边框 │
│          │                         │ 加粗文字 │
└──────────┴─────────────────────────┴──────────┘
```

### 悬停在新行放置区
```
┌─────────────────────────────────────────┐
│          基本信息 (全宽)                │
└─────────────────────────────────────────┘

┌───────────────────────────────────────────┐
│          ↓ 新行 (蓝色高亮)                │
└───────────────────────────────────────────┘
```

## 布局结构

### 使用 Flexbox
```html
<div style="display: flex; gap: 8px">
  <!-- 左侧放置区 (80px 固定宽度) -->
  <div style="width: 80px; flex-shrink: 0">
    <DropZone position="left" />
  </div>

  <!-- 模块本身 (flex: 1 自动填充) -->
  <div style="flex: 1; min-width: 0">
    <SortableModuleInstance />
  </div>

  <!-- 右侧放置区 (80px 固定宽度) -->
  <div style="width: 80px; flex-shrink: 0">
    <DropZone position="right" />
  </div>
</div>
```

### 关键样式

#### DropZone 组件
```typescript
{
  width: '100%',
  height: position === 'center' ? '60px' : '100%',
  minHeight: position === 'center' ? '60px' : '100px',

  // 边框: 未悬停时灰色虚线, 悬停时蓝色实线 (更明显!)
  border: isOver ? '3px solid #1890ff' : '2px dashed #d9d9d9',

  // 背景: 未悬停时浅灰, 悬停时浅蓝
  backgroundColor: isOver ? '#e6f7ff' : '#fafafa',

  // 文字颜色: 未悬停时灰色, 悬停时蓝色
  color: isOver ? '#1890ff' : '#999',

  // 文字粗细: 悬停时加粗
  fontWeight: isOver ? 'bold' : 'normal',

  cursor: 'copy'
}
```

#### 拖拽预览缩小
```typescript
<DragOverlay>
  {activeModule ? (
    <div style={{
      transform: 'scale(0.5)',        // 缩小到 50%
      transformOrigin: 'top left',    // 从左上角缩放
      opacity: 0.8,                   // 半透明
      maxWidth: '300px'               // 限制最大宽度
    }}>
      <ModuleCard module={activeModule} />
    </div>
  ) : null}
</DragOverlay>
```

## 颜色方案

### 未悬停状态
- **边框**: `#d9d9d9` (浅灰色虚线)
- **背景**: `#fafafa` (极浅灰)
- **文字**: `#999` (中灰色)

### 悬停状态
- **边框**: `#1890ff` (Ant Design 主题蓝)
- **背景**: `#e6f7ff` (浅蓝色)
- **文字**: `#1890ff` (主题蓝)

## 文字提示

### 简洁版本
- 左侧: `← 左`
- 右侧: `右 →`
- 新行: `↓ 新行`

### 优势
- 更简洁,不占用太多空间
- 箭头方向清晰指示
- 始终可见,无需悬停

## 交互流程

1. **开始拖拽**: 从模块库拖拽模块
2. **显示放置区**: 所有行的左右两侧显示灰色放置区,底部显示新行放置区
3. **悬停高亮**: 鼠标悬停在哪个放置区,哪个就变蓝色高亮
4. **释放鼠标**: 模块添加到对应位置,自动计算列宽

## 示例场景

### 场景1: 添加到左侧
```
初始状态:
┌─────────────────────────────────────────┐
│          填充材料 (全宽)                │
└─────────────────────────────────────────┘

拖拽"基材信息"到左侧:
┌──────┬─────────────────────────────┬──────┐
│  ←   │      填充材料 (全宽)        │  →   │
│ 左   │                             │ 右   │
│(蓝色)│                             │      │
└──────┴─────────────────────────────┴──────┘

释放后:
┌─────────────────────┬─────────────────────┐
│   基材信息 (1/2)    │   填充材料 (1/2)    │
└─────────────────────┴─────────────────────┘
```

### 场景2: 添加到右侧
```
初始状态:
┌─────────────────────────────────────────┐
│          基材信息 (全宽)                │
└─────────────────────────────────────────┘

拖拽"填充材料"到右侧:
┌──────┬─────────────────────────────┬──────┐
│  ←   │      基材信息 (全宽)        │  →   │
│ 左   │                             │ 右   │
│      │                             │(蓝色)│
└──────┴─────────────────────────────┴──────┘

释放后:
┌─────────────────────┬─────────────────────┐
│   基材信息 (1/2)    │   填充材料 (1/2)    │
└─────────────────────┴─────────────────────┘
```

### 场景3: 添加到新行
```
初始状态:
┌─────────────────────┬─────────────────────┐
│   基材信息 (1/2)    │   填充材料 (1/2)    │
└─────────────────────┴─────────────────────┘

拖拽"焊接参数"到底部:
┌─────────────────────┬─────────────────────┐
│   基材信息 (1/2)    │   填充材料 (1/2)    │
└─────────────────────┴─────────────────────┘
┌───────────────────────────────────────────┐
│          ↓ 新行 (蓝色高亮)                │
└───────────────────────────────────────────┘

释放后:
┌─────────────────────┬─────────────────────┐
│   基材信息 (1/2)    │   填充材料 (1/2)    │
└─────────────────────┴─────────────────────┘
┌─────────────────────────────────────────────┐
│          焊接参数 (全宽)                    │
└─────────────────────────────────────────────┘
```

## 技术要点

### 1. Flexbox 布局
- 使用 `display: flex` 确保左右放置区始终可见
- `flex-shrink: 0` 防止放置区被压缩
- `flex: 1` 让模块自动填充剩余空间

### 2. 固定宽度
- 左右放置区固定 50px 宽度
- 不会因为内容变化而改变大小

### 3. 最小高度
- 左右放置区 `minHeight: 80px`
- 新行放置区 `minHeight: 60px`
- 确保有足够的点击/拖拽目标区域

### 4. 视觉反馈
- 始终显示灰色边框,让用户知道可以放置
- 悬停时变蓝色,明确当前目标
- 平滑过渡动画 `transition: all 0.2s`

## 优势

✅ **始终可见**: 不需要悬停就能看到放置区域  
✅ **清晰明确**: 灰色/蓝色对比明显  
✅ **不会被挤压**: 固定宽度,布局稳定  
✅ **简洁文字**: 箭头+简短文字,一目了然  
✅ **大目标区域**: 50px 宽度,容易拖拽到  

## 用户反馈

- 拖拽时立即看到所有可放置位置
- 蓝色高亮清楚指示当前目标
- 不需要精确对准,50px 宽度容错率高
- 箭头方向直观,无需思考

