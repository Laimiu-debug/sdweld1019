# 焊接接头示意图生成功能 - 快速测试指南

## 🚀 快速开始

### 1. 启动前端开发服务器
```bash
cd frontend
npm run dev
```

### 2. 访问 WPS 模板编辑页面
- 打开浏览器访问: `http://localhost:5173`
- 登录系统
- 进入 WPS 管理 → 模板管理
- 创建新模板或编辑现有模板

### 3. 添加示意图模块
- 从左侧模块库拖拽 "示意图" 模块到模板
- 或在编辑时选择 "示意图" 模块

### 4. 测试功能

#### 测试场景 1: 对接接头 - V型坡口
1. 点击 "接头示意图" 字段
2. 点击 "自动生成接头示意图" 按钮
3. 参数设置：
   - 接头类型: **对接接头**
   - 坡口类型: **V型**
   - 板厚: **10mm**
   - 坡口角度: **60°**
   - 根部间隙: **2mm**
   - 坡口深度: **8mm**
   - 焊缝宽度: **12mm**
   - 焊层数: **3**
   - 每层焊道数: **2**
4. 观察预览图表
5. 点击 "生成图表" 确认

**预期结果：**
- ✅ 显示上下两块灰色板材
- ✅ 显示蓝色 V 型坡口
- ✅ 显示根部间隙
- ✅ 参数信息清晰显示

#### 测试场景 2: 对接接头 - U型坡口
1. 在生成器中修改参数：
   - 坡口类型: **U型**
   - 坡口角度: **45°**
2. 观察预览图表
3. 点击 "生成图表"

**预期结果：**
- ✅ 显示 U 型坡口（曲线）
- ✅ 参数实时更新

#### 测试场景 3: 搭接接头
1. 修改参数：
   - 接头类型: **搭接接头**
   - 坡口类型: **V型**
2. 观察预览图表

**预期结果：**
- ✅ 显示上下两块重叠的板材
- ✅ 显示焊缝区域

#### 测试场景 4: T形接头
1. 修改参数：
   - 接头类型: **T形接头**
   - 坡口类型: **V型**
2. 观察预览图表

**预期结果：**
- ✅ 显示水平板和竖直板
- ✅ 显示焊缝区域

#### 测试场景 5: 角接头
1. 修改参数：
   - 接头类型: **角接头**
   - 坡口类型: **V型**
2. 观察预览图表

**预期结果：**
- ✅ 显示 90° 角接头
- ✅ 显示焊缝区域

#### 测试场景 6: 边接头
1. 修改参数：
   - 接头类型: **边接头**
   - 坡口类型: **V型**
2. 观察预览图表

**预期结果：**
- ✅ 显示两块相邻的板材
- ✅ 显示边缘焊缝

#### 测试场景 7: 参数调整
1. 在生成器中调整参数：
   - 板厚: 从 10mm 改为 15mm
   - 坡口角度: 从 60° 改为 75°
   - 根部间隙: 从 2mm 改为 3mm
2. 观察预览图表实时更新

**预期结果：**
- ✅ 图表实时更新
- ✅ 参数信息实时更新

#### 测试场景 8: 图表下载
1. 点击 "下载" 按钮
2. 检查下载文件

**预期结果：**
- ✅ 下载 PNG 文件
- ✅ 文件名格式: `weld_joint_diagram_[timestamp].png`
- ✅ 图片清晰可见

#### 测试场景 9: 图表生成和保存
1. 点击 "生成图表" 按钮
2. 模态框关闭
3. 检查图片是否显示在字段中

**预期结果：**
- ✅ 模态框关闭
- ✅ 图片显示在字段中
- ✅ 显示成功提示

#### 测试场景 10: 上传图片
1. 点击 "上传图片" 区域
2. 选择本地图片文件
3. 检查图片是否显示

**预期结果：**
- ✅ 图片上传成功
- ✅ 图片显示在字段中

#### 测试场景 11: 图片删除
1. 点击 "删除" 按钮
2. 检查图片是否被删除

**预期结果：**
- ✅ 图片被删除
- ✅ 字段恢复为空状态

#### 测试场景 12: 表单保存
1. 填充所有必需字段
2. 点击 "保存" 按钮
3. 检查是否保存成功

**预期结果：**
- ✅ 表单保存成功
- ✅ 生成的图片被保存
- ✅ 页面返回列表

## 🐛 常见问题排查

### 问题 1: 图表不显示
**症状：** 点击生成后，图表区域为空

**排查步骤：**
1. 打开浏览器开发者工具 (F12)
2. 查看 Console 是否有错误
3. 检查参数是否有效
4. 尝试刷新页面

### 问题 2: 生成失败
**症状：** 点击生成后，显示错误提示

**排查步骤：**
1. 检查所有参数是否填写
2. 检查参数值是否在有效范围内
3. 查看浏览器控制台错误信息
4. 尝试重新加载页面

### 问题 3: 图片无法保存
**症状：** 生成图片后，保存表单失败

**排查步骤：**
1. 检查网络连接
2. 查看浏览器控制台网络请求
3. 检查后端是否正常运行
4. 查看后端日志

### 问题 4: 参数不更新
**症状：** 修改参数后，图表不更新

**排查步骤：**
1. 检查浏览器是否支持 Canvas
2. 尝试刷新页面
3. 查看浏览器控制台是否有错误
4. 尝试使用其他浏览器

## 📊 测试结果记录

| 测试场景 | 预期结果 | 实际结果 | 状态 | 备注 |
|---------|---------|---------|------|------|
| 对接接头-V型 | 显示V型坡口 | | ☐ 通过 ☐ 失败 | |
| 对接接头-U型 | 显示U型坡口 | | ☐ 通过 ☐ 失败 | |
| 对接接头-J型 | 显示J型坡口 | | ☐ 通过 ☐ 失败 | |
| 对接接头-X型 | 显示X型坡口 | | ☐ 通过 ☐ 失败 | |
| 搭接接头 | 显示重叠板材 | | ☐ 通过 ☐ 失败 | |
| T形接头 | 显示T形接头 | | ☐ 通过 ☐ 失败 | |
| 角接头 | 显示角接头 | | ☐ 通过 ☐ 失败 | |
| 边接头 | 显示边接头 | | ☐ 通过 ☐ 失败 | |
| 参数调整 | 实时更新 | | ☐ 通过 ☐ 失败 | |
| 图表下载 | 下载PNG | | ☐ 通过 ☐ 失败 | |
| 图表生成 | 保存成功 | | ☐ 通过 ☐ 失败 | |
| 图片上传 | 上传成功 | | ☐ 通过 ☐ 失败 | |
| 图片删除 | 删除成功 | | ☐ 通过 ☐ 失败 | |
| 表单保存 | 保存成功 | | ☐ 通过 ☐ 失败 | |

## 📝 反馈和改进

如果发现任何问题或有改进建议，请记录以下信息：

**问题描述：**
- 现象
- 重现步骤
- 预期结果
- 实际结果

**改进建议：**
- 功能建议
- UI/UX 改进
- 性能优化

## 🔗 相关文件

- 生成器组件: `frontend/src/components/WPS/WeldJointDiagramGenerator.tsx`
- 字段组件: `frontend/src/components/WPS/WeldJointDiagramField.tsx`
- 改进说明: `WELD_JOINT_DIAGRAM_IMPROVEMENTS.md`
- 使用指南: `frontend/src/components/WPS/WELD_JOINT_DIAGRAM_USAGE.md`

